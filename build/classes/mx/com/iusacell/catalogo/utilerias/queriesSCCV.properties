-- Queries comunes
0
-- Query para obtener todos los puestos
SELECT PC_PUESTOS.PC_CVE_PUESTO PC_CVE_PUESTO, PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO
FROM PC_PUESTOS;
-- Query para obtener todos los vendedores
1
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA-- Queries comunes
0
-- Query para obtener todos los puestos
SELECT PC_PUESTOS.PC_CVE_PUESTO PC_CVE_PUESTO, PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO
FROM PC_PUESTOS;
-- Query para obtener todos los vendedores
1
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD
FROM PC_VENDEDORES
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {0}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)) ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query para generar la tabla de Puntos de Venta
2
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV
FROM PC_PUNTO_VENTAS
WHERE PC_PUNTO_VENTAS.PC_CVE_SUBDIV={0};
-- Query para obtener Regiones
3
SELECT PC_REGION.PC_CVE_REGION PC_CVE_REGION,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION
FROM PC_REGION;
-- Query para obtener los datos de un vendedor
4
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
       PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA,
	   PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND ((PC_VENDEDORES.PC_CVE_VENDEDOR = {0}))
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
); --query modificado  OR PC_VENDEDORES.PC_CVE_EMP_REF=''{0}''
-- Query para obtener los Puntos de Venta por clave y por division
5
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
       PC_PUNTO_VENTAS.PC_CIUDAD PC_CIUDAD,
	   PC_PUNTO_VENTAS.PC_ESTADO PC_ESTADO,
	   PC_PUNTO_VENTAS.PC_STATUS PC_STATUS,
	   PC_PUNTO_VENTAS.PC_DIG_VERIF PC_DIG_VERIF,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_REGION , PC_TIPO_CANAL , PC_CANAL, PC_SUBDIVISION
WHERE ( (PC_REGION.PC_CVE_REGION(+) = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = ''{0}'')
AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {1})
AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {2}));-- OR PC_PUNTO_VENTAS.PC_CVE_REFERENCIA = ''{0}''
-- Query para obtener lista de Vendedores por Puesto
6
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO
FROM PC_VENDEDORES
WHERE ( (PC_VENDEDORES.PC_CVE_PUESTO = {0})
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE (((PC_VENDEDORES.PC_CVE_SUBDIV = {1})OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para obtener los movimientos por activaciones detalle total para un empresario
7
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO
FROM PC_VENDEDORES
WHERE ( (PC_VENDEDORES.PC_CVE_REGION = ''{0}'') );
-- Query para obtener los movimientos por renovaciones para un empresario
8
SELECT PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL
FROM PC_TIPO_CANAL ;
-- Query para obtener los movimientos por residuales para un empresario
9
SELECT PC_CANAL.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL
FROM PC_CANAL , PC_TIPO_CANAL
WHERE ( (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL) AND
(PC_TIPO_CANAL.PC_CVE_TP_CANAL = ''{0}'') )
ORDER BY PC_DESC_CANAL;
-- Query para obtener los movimientos por servicios activaciones para un empresario
10
INSERT INTO PC_VENDEDORES (
			PC_CVE_VENDEDOR, PC_CVE_PUESTO,  PC_CVE_SUPERIOR,
 			PC_NOM_VENDEDOR, PC_APE_PATERNO, PC_APE_MATERNO,
 			PC_FCH_ALTA, 	 PC_DIG_VERIF,   PC_CNTR_TDA,
 			PC_STATUS,       PC_CVE_EMP_REF, PC_CIUDAD,
 			PC_ESTADO,       PC_DIRECCION,   PC_COLONIA,
            PC_CP,           PC_TEL,         PC_FAX,
            PC_COMISIONAR,   PC_CVE_SUP_CAD, PC_CVE_SUBDIV, PC_CVE_EMPRESA)
 VALUES ({0},{1},{2},''{3}'',''{4}'',''{5}'',TO_DATE(''{6}'',''DD/MM/YYYY''),{7},''{8}'',''{9}'',''{10}'',''{11}'',''{12}'',''{13}'',''{14}'',''{15}'',''{16}'',''{17}'',''S'',{18},{19}, {20});
-- Query para insertar en tabla punto de ventas
11
INSERT INTO PC_PUNTO_VENTAS (
            PC_CVE_PTOVENTAS, PC_CVE_REFERENCIA, PC_CVE_CANAL,
            PC_NOM_PTOVENTAS, PC_CNTL_INT,       PC_CVE_DIV,
            PC_CVE_SUBDIV,    PC_DIRECCION,      PC_COLONIA,
            PC_CP,            PC_TEL,            PC_FAX,
            PC_CIUDAD, 		  PC_ESTADO,		 PC_DIG_VERIF,
            PC_STATUS)
VALUES(''{0}'',''{1}'',''{2}'',
		''{3}'',''{4}'',(SELECT PC_CVE_DIV FROM PC_SUBDIVISION WHERE PC_CVE_SUBDIV = {5}),
		''{5}'',''{6}'',''{7}'',
		''{8}'',''{9}'',''{10}'',
		''{11}'', ''{12}'', ''{13}'', ''ALTA'');
-- Query para obtener los puntos de venta dado un canal en especifico
12
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS
FROM PC_PUNTO_VENTAS
WHERE ( (PC_PUNTO_VENTAS.PC_CVE_CANAL = ''{0}'')
AND ( PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {1})
AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {2}));
-- Query para actualizar punto de venta
13
UPDATE PC_PUNTO_VENTAS SET
       PC_CVE_CANAL = ''{1}'',
       PC_CVE_REGION = ''{2}'',
       PC_NOM_PTOVENTAS = ''{3}'',
       PC_CVE_REFERENCIA = ''{4}'',
       PC_CNTL_INT = ''{5}'',
       PC_CVE_SUBDIV = ''{6}'',
       PC_CVE_DIV = ''{6}'',
       PC_DIRECCION = ''{7}'',
       PC_COLONIA = ''{8}'',
       PC_CP = ''{9}'',
       PC_TEL = ''{10}'',
       PC_FAX = ''{11}'',
       PC_CIUDAD = ''{12}'',
       PC_ESTADO = ''{13}''
WHERE (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = ''{0}'');
-- Query para obtener los movimientos por charge back renovaciones para un empresario
14
UPDATE PC_VENDEDORES SET
       PC_CVE_PUESTO = {1},
       PC_CVE_SUPERIOR = {2},
       PC_NOM_VENDEDOR = ''{3}'',
       PC_APE_PATERNO = ''{4}'',
       PC_APE_MATERNO = ''{5}'',
       PC_CNTR_TDA = ''{6}'',
       PC_CVE_EMP_REF = ''{7}'',
       PC_CIUDAD = ''{8}'',
       PC_ESTADO= ''{9}'',
       PC_DIRECCION= ''{10}'',
       PC_COLONIA= ''{11}'',
       PC_CP= ''{12}'',
       PC_TEL= ''{13}'',
       PC_FAX= ''{14}'',
       PC_FCH_ALTA= TO_DATE(''{15}'',''DD/MM/YYYY''),
       PC_CVE_SUP_CAD = {16},
       PC_CVE_SUBDIV = {17}, PC_CVE_EMPRESA={18}
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR = {0});
-- Query para obtener los movimientos por bono por volumen para un empresario
15
INSERT INTO PC_REGION (PC_CVE_REGION, PC_DESC_REGION) VALUES (''{0}'',''{1}'');
-- Query para obtener los movimientos por bono por volumen para un empresario
16
UPDATE PC_REGION SET PC_DESC_REGION=''{1}'' WHERE PC_CVE_REGION=''{0}'';
-- Query para obtener los movimientos por residuales de telefonia publica pospago para un empresario
17
DELETE FROM PC_REGION WHERE PC_CVE_REGION=''{0}'';
-- Query para obtener los movimientos por bajas de telefonia publica pospago para un empresario
18
INSERT INTO PC_PUESTOS (PC_CVE_PUESTO , PC_DESC_PUESTO)  VALUES ({0},''{1}'');
-- Query para obtener los movimientos por activaciones prepago para un empresario
19
UPDATE PC_PUESTOS SET
       PC_DESC_PUESTO =''{1}''
WHERE PC_CVE_PUESTO = {0};
-- Query para obtener los movimientos por activaciones prepago para un empresario
20
DELETE FROM PC_PUESTOS
WHERE PC_CVE_PUESTO = {0};
-- Query para generar la tabla de distribuidores asociando su comisión para un periodo específico
21
SELECT PC_PUESTOS.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO
FROM PC_PUESTOS
ORDER BY PC_DESC_PUESTO;
-- Query para obtener los movimientos por activaciones telefonia publica prepago para un empresario
22
SELECT NVL((MAX(PC_CVE_PUESTO)+1),0) CLAVE FROM PC_PUESTOS;
-- Query para obtener el resumen del bono por cumplimiento de cuota
23
SELECT NVL((MAX(TO_NUMBER(PC_CVE_REGION))+1),0) CLAVE FROM PC_REGION;
-- Testing Catalogo de Puestos
24
SELECT PC_PUESTOS.PC_CVE_PUESTO AS PC_CVE_PUESTO,
       PC_PUESTOS.PC_DESC_PUESTO AS PC_DESC_PUESTO
FROM PC_PUESTOS;
-- Query para obtener la tabla de comisiones para las renovaciones
25
INSERT INTO PC_CANAL (PC_CVE_CANAL, PC_DESC_CANAL, PC_CVE_TP_CANAL)
VALUES (''{0}'',''{1}'',''{2}'');
-- Query para obtener la tabla de comisiones para las renovaciones
26
UPDATE PC_CANAL SET
       PC_DESC_CANAL=''{1}'',
       PC_CVE_TP_CANAL=''{2}''
WHERE PC_CVE_CANAL=''{0}'';
-- Query para obtener la tabla de comisiones para las renovaciones
27
DELETE FROM PC_CANAL WHERE PC_CVE_CANAL=''{0}'';
-- Query para obtener la tabla de comisiones para las renovaciones
28
SELECT NVL((MAX(TO_NUMBER(PC_CVE_CANAL))+1),0) CLAVE FROM PC_CANAL;
-- Query para obtener la tabla de comisiones para las renovaciones
29
INSERT INTO PC_TIPO_CANAL (PC_CVE_TP_CANAL, PC_DESC_TP_CANAL)
VALUES (''{0}'',''{1}'');
-- Query para obtener la tabla de comisiones para las renovaciones
30
UPDATE PC_TIPO_CANAL SET
       PC_DESC_TP_CANAL=''{1}''
WHERE PC_CVE_TP_CANAL=''{0}'';
-- Query para obtener la tabla de comisiones para las renovaciones
31
DELETE FROM PC_TIPO_CANAL
WHERE PC_CVE_TP_CANAL=''{0}'';
-- Query para obtener la tabla de comisiones para las renovaciones
32
SELECT NVL((MAX(TO_NUMBER(PC_CVE_TP_CANAL))+1),0) CLAVE FROM PC_TIPO_CANAL;
-- Query para obtener la nota del bono por cumplimiento de cuota
33
SELECT PC_CANAL.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL
FROM PC_CANAL
<%0!=null , PC_TIPO_CANAL WHERE ( (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL) AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = ''{0}'') ) 0!=null%>
ORDER BY PC_CANAL.PC_DESC_CANAL ASC;
-- Query para obtener Puntos de Venta por Region
34
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
	   PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
	   PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
	   PC_PUNTO_VENTAS.PC_DIRECCION PC_DIRECCION,
	   PC_PUNTO_VENTAS.PC_COLONIA PC_COLONIA,
	   PC_PUNTO_VENTAS.PC_CP PC_CP,
	   PC_PUNTO_VENTAS.PC_TEL PC_TEL,
	   PC_PUNTO_VENTAS.PC_FAX PC_FAX,
	   PC_PUNTO_VENTAS.PC_CIUDAD PC_CIUDAD,
	   PC_PUNTO_VENTAS.PC_ESTADO PC_ESTADO,
	   PC_PUNTO_VENTAS.PC_STATUS PC_STATUS,
	   PC_PUNTO_VENTAS.PC_DIG_VERIF PC_DIG_VERIF,
	   PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
	   PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
	   PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV,
	   NULL PC_JEFE_TIENDA
FROM PC_PUNTO_VENTAS, PC_CANAL, PC_TIPO_CANAL, PC_SUBDIVISION
WHERE( (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
<%0!=null AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {0}) 0!=null%>
<%4!=0 AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {4}) 4!=0%>
<%1!=null AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = ''{1}'') 1!=null%>
<%2!=null AND (PC_PUNTO_VENTAS.PC_CVE_CANAL = ''{2}'') 2!=null%>
<%3!=null AND (UPPER(PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS) like UPPER(''%{3}%'')) 3!=null%>
)
AND PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS NOT IN (
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS
FROM PC_PUNTO_VENTAS, PC_CANAL, PC_TIPO_CANAL, PC_SUBDIVISION, PC_VENDEDORES, PC_INTER_VENDEDORES_PTOVENTAS, PC_PUESTOS
WHERE ((PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS)
AND (NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_PUESTO = '2')
<%0!=null AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {0}) 0!=null%>
<%4!=0 AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {4}) 4!=0%>
<%1!=null AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = ''{1}'') 1!=null%>
<%2!=null AND (PC_PUNTO_VENTAS.PC_CVE_CANAL = ''{2}'') 2!=null%>
<%3!=null AND (UPPER(PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS) like UPPER(''%{3}%'')) 3!=null%>
))
UNION ALL
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
PC_PUNTO_VENTAS.PC_DIRECCION PC_DIRECCION,
PC_PUNTO_VENTAS.PC_COLONIA PC_COLONIA,
PC_PUNTO_VENTAS.PC_CP PC_CP,
PC_PUNTO_VENTAS.PC_TEL PC_TEL,
PC_PUNTO_VENTAS.PC_FAX PC_FAX,
PC_PUNTO_VENTAS.PC_CIUDAD PC_CIUDAD,
PC_PUNTO_VENTAS.PC_ESTADO PC_ESTADO,
PC_PUNTO_VENTAS.PC_STATUS PC_STATUS,
PC_PUNTO_VENTAS.PC_DIG_VERIF PC_DIG_VERIF,
PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV,
PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
PC_VENDEDORES.PC_APE_MATERNO PC_JEFE_TIENDA
FROM PC_PUNTO_VENTAS , PC_CANAL , PC_TIPO_CANAL , PC_SUBDIVISION, PC_VENDEDORES, PC_INTER_VENDEDORES_PTOVENTAS, PC_PUESTOS
WHERE( (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_PUESTO = '2')
<%0!=null AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {0}) 0!=null%>
<%4!=0 AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {4}) 4!=0%>
<%1!=null AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = ''{1}'') 1!=null%>
<%2!=null AND (PC_PUNTO_VENTAS.PC_CVE_CANAL = ''{2}'') 2!=null%>
<%3!=null AND (UPPER(PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS) like UPPER(''%{3}%'')) 3!=null%>
)ORDER BY PC_NOM_PTOVENTAS;
-- Query para obtener la siguiente clave disponible en la Tabla de Puntos de Venta
35
SELECT SEQ_PC_PUNTO_VENTAS.NEXTVAL AS CLAVE FROM DUAL;
-- Query para obtener la siguiente clave disponible en la Tabla de Puntos de Venta
--DELETE FROM PC_PUNTO_VENTAS WHERE (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = ''{0}'');//original
36
UPDATE PC_PUNTO_VENTAS SET PC_STATUS=''BAJA''
WHERE (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = ''{0}'');
-- Query para obtener la siguiente clave disponible en la Tabla de Puntos de Venta
37
DELETE FROM PC_VENDEDORES
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR = {0});
-- Query para obtener la siguiente clave disponible en la Tabla de Puntos de Venta
38
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {3}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para obtener la siguiente clave disponible en la Tabla de Vendedores
39
SELECT NVL((MAX(PC_CVE_VENDEDOR)+1),0) CLAVE FROM PC_VENDEDORES;
-- Query para obtener la siguiente clave disponible en la Tabla de Vendedores
40
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {0}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
));
-- Query para Relaciones entre Vendedores y Puntos de Venta
41
INSERT INTO PC_INTER_VENDEDORES_PTOVENTAS
           (PC_CVE_INTER,     PC_CVE_VENDEDOR,
            PC_CVE_PTOVENTAS, PC_FCH_MOVIMIENTO,
            PC_CVE_USUARIO,   PC_CVE_AUTORIZA, PC_FCH_INICIO, PC_STATUS)
VALUES ({0},{1},''{2}'',TO_DATE(''{3}'',''DD/MM/YYYY''),{4},{5}, TO_DATE(''{6}'',''DD/MM/YYYY HH24:MI:SS''), ''ALTA'');
-- Query para Actualizar Relaciones entre Vendedores y Puntos de Venta
42
UPDATE PC_INTER_VENDEDORES_PTOVENTAS SET
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {1}
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{2}''
WHERE (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER = {0});
-- Query para Eliminar Relaciones entre Vendedores y Puntos de Venta 43 DELETE FROM PC_INTER_VENDEDORES_PTOVENTAS WHERE (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER = {0});
43
UPDATE PC_INTER_VENDEDORES_PTOVENTAS SET
       PC_INTER_VENDEDORES_PTOVENTAS.PC_FCH_FIN =TO_DATE(''{1}'',''DD/MM/YYYY HH24:MI:SS''),
       PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS = ''BAJA'',
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_USUARIO = {2},
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_AUTORIZA = {2}
WHERE (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER = {0});
-- Query para Relaciones entre Vendedores y Puntos de Venta
44
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_PUNTO_VENTAS , PC_CANAL , PC_VENDEDORES
WHERE ( (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
<%0!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {0}) 0!=null%>
<%1!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{1}'') 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {3}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para Relaciones entre Vendedores y Puntos de Venta
45
SELECT NVL((MAX(PC_CVE_INTER)+1),0) CLAVE FROM PC_INTER_VENDEDORES_PTOVENTAS;
-- Query para Relaciones entre Vendedores y Puntos de Venta
46
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_FCH_MOVIMIENTO PC_FCH_MOVIMIENTO,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_USUARIO PC_CVE_USUARIO,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_AUTORIZA PC_CVE_AUTORIZA
FROM PC_INTER_VENDEDORES_PTOVENTAS
WHERE (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {0})OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
));
-- Query para Relaciones entre Vendedores y Puntos de Venta
47
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_VENDEDORES
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{0}'')
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para Relaciones entre Vendedores y Puntos de Venta
48
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_PUNTO_VENTAS , PC_CANAL
WHERE ( (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
 AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
 AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {0})
 AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR IN (
 	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para Relaciones entre Vendedores y Puntos de Venta
49
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_FCH_MOVIMIENTO PC_FCH_MOVIMIENTO,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_VENDEDORES , PC_PUNTO_VENTAS , PC_CANAL
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND ((NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA''))
<%0!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{0}'') 0!=null%>
<%1!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {1}) 1!=null%>
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {3}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para obtener Regiones
50
SELECT PC_DIVISION.PC_CVE_DIV PC_CVE_DIV,
       PC_DIVISION.PC_DESC_DIV PC_DESC_DIV
FROM PC_DIVISION
<%0!=0 WHERE PC_DIVISION.PC_CVE_DIV = {0} 0!=0%>;
-- Query para obtener los movimientos por bono por volumen para un empresario
51
INSERT INTO PC_DIVISION (PC_CVE_DIV, PC_DESC_DIV, PC_CVE_VENDEDOR) VALUES ({0},''{1}'',{0});
-- Query para obtener los movimientos por bono por volumen para un empresario
52
UPDATE PC_DIVISION SET PC_DESC_DIV=''{1}'' WHERE PC_CVE_DIV={0};
-- Query para obtener los movimientos por residuales de telefonia publica pospago para un empresario
53
DELETE FROM PC_DIVISION WHERE PC_CVE_DIV={0};
-- Query para obtener el resumen del bono por cumplimiento de cuota
54
SELECT NVL((MAX(PC_CVE_DIV)+1),0) CLAVE FROM PC_DIVISION;
-- Query para obtener la siguiente clave disponible en la Tabla de Vendedores
55
SELECT NVL((MAX(PC_CVE_VENDEDOR)+1),0) CLAVE FROM PC_VENDEDORES WHERE PC_CVE_VENDEDOR LIKE ''3%'';
-- Query para obtener la siguiente clave disponible en la Tabla de Vendedores
56
SELECT NVL((MAX(PC_CVE_VENDEDOR)+1),0) CLAVE FROM PC_VENDEDORES WHERE PC_CVE_VENDEDOR LIKE ''5%'';
-- Query para obtener la siguiente clave disponible en la Tabla de Vendedores
57
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR ||'' ''||
       PC_VENDEDORES.PC_APE_PATERNO  ||'' ''||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES , PC_PUESTOS , PC_PUESTOS PUESTO
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO(+) = PC_VENDEDORES.PC_CVE_PUESTO)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PUESTO.PC_NIVEL < PC_PUESTOS.PC_NIVEL)
<%0>0 AND (PUESTO.PC_CVE_PUESTO = {0}) 0>0%>
);
-- Query para obtener los movimientos por renovaciones para un empresario
58
SELECT PC_TIPO_CANAL.PC_CVE_TP_CANAL, PC_TIPO_CANAL.PC_DESC_TP_CANAL
FROM PC_TIPO_CANAL , PC_CANAL
WHERE ( (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL) )
GROUP BY PC_TIPO_CANAL.PC_CVE_TP_CANAL , PC_TIPO_CANAL.PC_DESC_TP_CANAL
ORDER BY PC_DESC_TP_CANAL;
-- Query para "eliminar" un vendedor de la tabla
59
UPDATE PC_VENDEDORES SET
       PC_STATUS = ''BAJA'',
       PC_FCH_BAJA = TO_DATE(''{1}'',''DD/MM/YYYY'')
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR = {0});
-- Query cambiar la asignacion de los vendedores con un superior que ha sido eliminado
60
UPDATE PC_VENDEDORES SET
       PC_CVE_SUPERIOR = {1},
       PC_CVE_SUP_CAD = NULL
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR = {0});
-- Query para obtener el organigrama hacia abajo
61
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_PUESTOS.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE(PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO)) PC_DESC_PUESTO
FROM PC_VENDEDORES
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR;
-- Query para obtener el organigrama hacia arriba para vendedores
62
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_PUESTOS.PC_CVE_PUESTO,
   	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE(PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO)) PC_DESC_PUESTO
FROM PC_VENDEDORES
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1})OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR  PC_VENDEDORES.PC_CVE_SUPERIOR = PC_VENDEDORES.PC_CVE_VENDEDOR;
-- Query para obtener el organigrama hacia arriba para vendedores
63
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
	   PC_VENDEDORES.PC_NOM_VENDEDOR ||'' ''||
       PC_VENDEDORES.PC_APE_PATERNO  ||'' ''||
       PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
	   PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
	   PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
	   PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
	   PC_DIVISION.PC_DESC_DIV PC_DESC_DIV
	   PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS, PC_PUESTOS, PC_VENDEDORES, PC_DIVISION, PC_SUBDIVISION, PC_INTER_VENDEDORES_PTOVENTAS
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_DIVISION.PC_CVE_DIV = PC_PUNTO_VENTAS.PC_CVE_DIV)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NULL) AND (PC_SUBDIVISION.PC_CVE_SUBDIV = {0})) ;
-- Query para obtener el organigrama hacia arriba para vendedores
64
SELECT NVL((MAX(PC_CVE_BIT_MOVIMIENTOS)+1),0) CLAVE FROM PC_BIT_MOVIMIENTOS;
-- Query para obtener el organigrama hacia arriba para vendedores
65
INSERT INTO PC_BIT_MOVIMIENTOS(PC_CVE_BIT_MOVIMIENTOS,
                               PC_CVE_VENDEDOR,
                               PC_CVE_SUPERIOR_ORIGEN,
                               PC_CVE_SUPERIOR_DESTINO,
                               PC_CVE_USUARIO,
                               PC_CVE_AUTORIZA,
                               PC_FCH_MOVIMIENTO,
                               PC_FCH_TRANSACCION )
VALUES ({0},{1},{2},{3},{4},{5},TO_DATE(''{6}'',''DD/MM/YYYY''),SYSDATE);
-- Query para dar de "ALTA" a un vendedor de la tabla
310
UPDATE PC_VENDEDORES SET
       PC_STATUS = ''ALTA'',
       PC_FCH_ALTA = TO_DATE(''{1}'',''DD/MM/YYYY''),
       PC_FCH_BAJA = ''''
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR = {0});
--  PC_FCH_ALTA = TO_DATE(''{1}'',''DD/MM/YYYY'')

-- Query para insertar un movimiento de cambio de STATUS
311
INSERT INTO PC_BIT_MOVIMIENTOS(PC_CVE_BIT_MOVIMIENTOS,
                               PC_CVE_VENDEDOR,
                               PC_CVE_STATUS_ORIGEN,
                               PC_CVE_STATUS_DESTINO,
                               PC_FCH_MOVIMIENTO,
                               PC_FCH_TRANSACCION,
                               PC_CVE_USUARIO,
                               PC_CVE_AUTORIZA
                                )
VALUES ({0},{1},''{2}'',''{3}'',TO_DATE(''{4}'',''DD/MM/YYYY''),SYSDATE,''{5}'',''{6}'');
-- Query para obtener el organigrama hacia arriba para vendedores
66
INSERT INTO PC_BIT_MOVIMIENTOS(PC_CVE_BIT_MOVIMIENTOS,
                               PC_CVE_VENDEDOR,
                               PC_CVE_PUESTO_ORIGEN,
                               PC_CVE_PUESTO_DESTINO,
                               PC_CVE_USUARIO,
                               PC_CVE_AUTORIZA,
                               PC_FCH_MOVIMIENTO,
                               PC_FCH_TRANSACCION )
VALUES ({0},{1},{2},{3},{4},{5},TO_DATE(''{6}'',''DD/MM/YYYY''),SYSDATE);
-- Query para obtener el organigrama hacia arriba para vendedores
67
INSERT INTO PC_BIT_MOVIMIENTOS(PC_CVE_BIT_MOVIMIENTOS,
                               PC_CVE_VENDEDOR,
                               PC_CVE_PTOVENTAS_ORIGEN,
                               PC_CVE_PTOVENTAS_DESTINO,
                               PC_CVE_USUARIO,
                               PC_CVE_AUTORIZA,
                               PC_FCH_MOVIMIENTO,
                               PC_FCH_TRANSACCION )
VALUES ({0},{1},''{2}'',''{3}'',{4},{5},TO_DATE(''{6}'',''DD/MM/YYYY''),SYSDATE);
-- Query para obtener el organigrama hacia arriba para vendedores
68
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUP_CAD
FROM PC_VENDEDORES
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = {0})
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para obtener el organigrama hacia arriba para vendedores
69
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS
FROM PC_INTER_VENDEDORES_PTOVENTAS
WHERE ((PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {0})
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para obtener el organigrama hacia arriba para vendedores
70
INSERT INTO PC_BIT_MOVIMIENTOS(PC_CVE_BIT_MOVIMIENTOS,
                               PC_CVE_VENDEDOR,
                               PC_CVE_SUPERIOR_ORIGEN,
                               PC_CVE_SUPERIOR_DESTINO,
                               PC_CVE_PUESTO_ORIGEN,
                               PC_CVE_PUESTO_DESTINO,
                               PC_CVE_USUARIO,
                               PC_CVE_AUTORIZA,
                               PC_FCH_MOVIMIENTO,
                               PC_FCH_TRANSACCION )
VALUES ({0},{1},{2},{3},{4},{5},{6},{7},TO_DATE(''{8}'',''DD/MM/YYYY''),SYSDATE);
-- Query para obtener un puesto en particular
71
SELECT PC_PUESTOS.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO
FROM PC_PUESTOS
WHERE PC_CVE_PUESTO = {0};
-- Query para obtener Puntos de Venta por Region
72
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_CANAL , PC_TIPO_CANAL , PC_REGION, PC_SUBDIVISION
WHERE ( (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_REGION.PC_CVE_REGION = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_PUNTO_VENTAS.PC_CVE_REGION = {0})
AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {1})
AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {2}) );
-- Query para obtener Puntos de Venta por Region
73
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_CANAL , PC_TIPO_CANAL , PC_REGION, PC_SUBDIVISION
WHERE  (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_REGION.PC_CVE_REGION(+) = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {0})
AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {1});
-- Query para Reasignar Superiores en PC_VENDEDORES
74
UPDATE PC_VENDEDORES SET PC_VENDEDORES.PC_CVE_SUPERIOR = (
	   SELECT PC_VENDEDORES.PC_CVE_SUPERIOR
	   FROM PC_VENDEDORES
	   WHERE PC_VENDEDORES.PC_CVE_VENDEDOR= {0})
WHERE PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	  SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	  FROM PC_VENDEDORES
	  WHERE PC_VENDEDORES.PC_CVE_SUPERIOR= {0}
);
-- Query para Reasignar Superiores en PC_VENDEDORES
75
SELECT PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR
FROM PC_BIT_MOVIMIENTOS
WHERE ( (PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR = {0})
AND (PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para Reasignar Superiores en PC_VENDEDORES
76
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES, PC_PUESTOS
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO(+) = PC_VENDEDORES.PC_CVE_PUESTO)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {0})
<%2!=0
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)) 2!=0%>
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {0}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
)))
ORDER BY PC_NOMBRE_VENDEDOR;
-- Query para Reasignar Superiores en PC_VENDEDORES
77
SELECT LEVEL NIVEL,
       PC_PUESTOS_NIVEL.PC_CVE_PUESTO PC_CVE_PUESTO,
       (SELECT PC_PUESTOS.PC_DESC_PUESTO
       FROM PC_PUESTOS
       WHERE PC_PUESTOS.PC_CVE_PUESTO = PC_PUESTOS_NIVEL.PC_CVE_PUESTO)
       PC_DESC_PUESTO
FROM PC_PUESTOS_NIVEL
START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {0}
CONNECT BY PRIOR  PC_PUESTOS_NIVEL.PC_CVE_PUESTO = PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP;
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
78
SELECT PC_CVE_PUESTO CLAVE FROM PC_PUESTOS_NIVEL WHERE PC_CVE_PUESTO_SUP IS NULL;
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
79
INSERT INTO PC_PUESTOS_NIVEL (PC_PUESTOS_NIVEL_ID, PC_CVE_PUESTO, PC_CVE_PUESTO_SUP)
VALUES ({0},{1},{2});
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
80
DELETE FROM PC_PUESTOS_NIVEL
WHERE (PC_CVE_PUESTO = {0}
AND PC_CVE_PUESTO_SUP = {1});
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
81
SELECT PC_PUESTOS_NIVEL_ID,
       PC_CVE_PUESTO,
       PC_CVE_PUESTO_SUP
FROM PC_PUESTOS_NIVEL
WHERE (PC_CVE_PUESTO = {0}
AND PC_CVE_PUESTO_SUP = {1});
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
82
SELECT NVL((MAX(PC_PUESTOS_NIVEL_ID)+1),0) CLAVE FROM PC_PUESTOS_NIVEL;
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
83
SELECT PC_PUESTOS_NIVEL_ID,
       PC_CVE_PUESTO,
       PC_CVE_PUESTO_SUP
FROM PC_PUESTOS_NIVEL
WHERE (PC_CVE_PUESTO = {0});
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
84
UPDATE PC_PUESTOS_NIVEL
SET PC_CVE_PUESTO_SUP = {1}
WHERE (PC_PUESTOS_NIVEL_ID = {0});
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
85
SELECT PC_PUESTOS_NIVEL_ID,
       PC_CVE_PUESTO,
       PC_CVE_PUESTO_SUP
FROM PC_PUESTOS_NIVEL
WHERE (PC_CVE_PUESTO_SUP = {0});
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
86
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES , PC_PUESTOS
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO(+) = PC_VENDEDORES.PC_CVE_PUESTO)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {0})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {0}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%2!=0 AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)) 2!=0%>
)ORDER BY PC_NOMBRE_VENDEDOR;
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
87
INSERT INTO PC_VENDEDORES (PC_CVE_VENDEDOR, PC_CVE_PUESTO, PC_CVE_SUPERIOR, PC_NOM_VENDEDOR, PC_COMISIONAR) VALUES({0},0,NULL,''{1}'',''N'');
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
88
SELECT PC_CVE_VENDEDOR, PC_CVE_DIV , PC_DESC_DIV
FROM PC_DIVISION
WHERE PC_CVE_DIV = {0};
-- Query para Mapeos
89
INSERT INTO PC_MAPEO_VENDEDOR (PC_CVE_VENDEDOR, PC_SISTEMA, PC_CUSTOMER_ID, PC_CVE_REG_VENTA, PC_NOM_USUARIO)
VALUES ({0},''{1}'',{2},''{3}'',''{4}'');
-- Query para Mapeos
90
UPDATE PC_MAPEO_VENDEDOR SET PC_SISTEMA = ''{1}'',
	   					 	 PC_CUSTOMER_ID = {2},
							 PC_CVE_REG_VENTA = ''{3}'',
							 PC_NOM_USUARIO = ''{4}''
WHERE PC_CVE_VENDEDOR = {0}
AND PC_SISTEMA = ''{5}''
AND PC_CVE_REG_VENTA = ''{6}'';
-- Query para Mapeos
91
DELETE FROM PC_MAPEO_VENDEDOR
WHERE PC_CVE_VENDEDOR = {0}
AND PC_SISTEMA = ''{1}''
AND PC_CVE_REG_VENTA = ''{2}'';
-- Query para Mapeos
92
SELECT PC_MAPEO_VENDEDOR.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_MAPEO_VENDEDOR.PC_SISTEMA PC_SISTEMA,
	   PC_MAPEO_VENDEDOR.PC_CUSTOMER_ID PC_CUSTOMER_ID,
	   PC_MAPEO_VENDEDOR.PC_CVE_REG_VENTA PC_CVE_REG_VENTA,
	   PC_MAPEO_VENDEDOR.PC_NOM_USUARIO PC_NOM_USUARIO
FROM PC_MAPEO_VENDEDOR
WHERE ((PC_MAPEO_VENDEDOR.PC_CVE_VENDEDOR = {0})
AND (PC_MAPEO_VENDEDOR.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para añadir tiendas en reporte organigrama
93
SELECT a.REGISTRO, a.NIVEL, a.PC_CVE_VENDEDOR, a.PC_NOMBRE_VENDEDOR,
	   a.PC_FCH_ALTA,
	   a.PC_FCH_BAJA,
	   a.PC_DIG_VERIF,
	   a.PC_CIUDAD,
	   a.PC_ESTADO,		
	   a.PC_DIRECCION,	
	   a.PC_COLONIA,		
	   a.PC_CP,		
	   a.PC_TEL,		
	   a.PC_FAX,
	   a.PC_CVE_SUBDIV,
	   a.PC_CVE_PUESTO,
	   a.PC_DESC_PUESTO,
	   b.PC_CVE_PTOVENTAS,
	   b.PC_NOM_PTOVENTAS,
	   b.PC_CVE_CANAL,
	   b.PC_CVE_REGION,
	   b.PC_DESC_CANAL,
	   b.PC_CVE_TP_CANAL,
	   b.PC_DESC_TP_CANAL,
	   b.PC_DESC_REGION
FROM
(
SELECT LEVEL AS NIVEL, ROWNUM AS REGISTRO, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,
	   PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	   FROM PC_PUESTOS
	   WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO
FROM PC_VENDEDORES
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) a,
(
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
) b
WHERE a.PC_CVE_VENDEDOR = b.PC_CVE_VENDEDOR(+)
ORDER BY REGISTRO;
-- Query para obtener un detalle de relacion
94
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_FCH_MOVIMIENTO PC_FCH_MOVIMIENTO,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_VENDEDORES , PC_PUNTO_VENTAS , PC_CANAL
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER = {0})
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para obtener la lista de movimientos
95
SELECT PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS,
       PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR,
       PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN,
	   PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO,
	   PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN,
	   PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO,
	   PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN,
	   PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO,
	   PC_BIT_MOVIMIENTOS.PC_FCH_MOVIMIENTO,
	   PC_BIT_MOVIMIENTOS.PC_FCH_TRANSACCION,
	   PC_PUNTO_VENTAS_ORIGEN.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_ORIGEN,
	   PC_PUNTO_VENTAS_DESTINO.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_DESTINO,
	   PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO  || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOM_COMP_VENDEDOR,
	   PC_SUPERIOR_ORIGEN.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR_ORIGEN.PC_APE_PATERNO  || '' '' ||
	   PC_SUPERIOR_ORIGEN.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_ORIGEN,
	   PC_SUPERIOR_DESTINO.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR_DESTINO.PC_APE_PATERNO  || '' '' ||
	   PC_SUPERIOR_DESTINO.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_DESTINO,
	   PC_PUESTOS_ORIGEN.PC_DESC_PUESTO PC_DESC_PUESTO_ORIGEN,
	   PC_PUESTOS_DESTINO.PC_DESC_PUESTO PC_DESC_PUESTO_DESTINO
FROM PC_BIT_MOVIMIENTOS , PC_VENDEDORES ,
PC_PUNTO_VENTAS PC_PUNTO_VENTAS_ORIGEN,
PC_PUNTO_VENTAS PC_PUNTO_VENTAS_DESTINO,
PC_VENDEDORES PC_SUPERIOR_ORIGEN,
PC_VENDEDORES PC_SUPERIOR_DESTINO,
PC_PUESTOS PC_PUESTOS_DESTINO,
PC_PUESTOS PC_PUESTOS_ORIGEN
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
AND (PC_PUNTO_VENTAS_ORIGEN.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN)
AND (PC_PUNTO_VENTAS_DESTINO.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO)
AND (PC_SUPERIOR_ORIGEN.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN)
AND (PC_SUPERIOR_DESTINO.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO)
AND (PC_PUESTOS_DESTINO.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO)
AND (PC_PUESTOS_ORIGEN.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN)
AND (ROWNUM < {0}))
ORDER BY PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS DESC;
-- Query para obtener la lista de movimientos por parametros
96
SELECT PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS,
       PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR,
       PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_FCH_MOVIMIENTO,
       PC_BIT_MOVIMIENTOS.PC_FCH_TRANSACCION,
       PC_PUNTO_VENTAS_ORIGEN.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_ORIGEN,
       PC_PUNTO_VENTAS_DESTINO.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_DESTINO,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
       PC_VENDEDORES.PC_APE_PATERNO  || '' '' ||
       PC_VENDEDORES.PC_APE_MATERNO PC_NOM_COMP_VENDEDOR,
       PC_SUPERIOR_ORIGEN.PC_NOM_VENDEDOR || '' '' ||
       PC_SUPERIOR_ORIGEN.PC_APE_PATERNO  || '' '' ||
       PC_SUPERIOR_ORIGEN.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_ORIGEN,
       PC_SUPERIOR_DESTINO.PC_NOM_VENDEDOR || '' '' ||
       PC_SUPERIOR_DESTINO.PC_APE_PATERNO  || '' '' ||
       PC_SUPERIOR_DESTINO.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_DESTINO,
       PC_PUESTOS_ORIGEN.PC_DESC_PUESTO PC_DESC_PUESTO_ORIGEN,
       PC_PUESTOS_DESTINO.PC_DESC_PUESTO PC_DESC_PUESTO_DESTINO
FROM PC_BIT_MOVIMIENTOS , PC_VENDEDORES ,
PC_PUNTO_VENTAS PC_PUNTO_VENTAS_ORIGEN,
PC_PUNTO_VENTAS PC_PUNTO_VENTAS_DESTINO,
PC_VENDEDORES PC_SUPERIOR_ORIGEN,
PC_VENDEDORES PC_SUPERIOR_DESTINO,
PC_PUESTOS PC_PUESTOS_DESTINO,
PC_PUESTOS PC_PUESTOS_ORIGEN
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {3}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {4}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
AND (PC_PUNTO_VENTAS_ORIGEN.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN)
AND (PC_PUNTO_VENTAS_DESTINO.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO)
AND (PC_SUPERIOR_ORIGEN.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN)
AND (PC_SUPERIOR_DESTINO.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO)
AND (PC_PUESTOS_DESTINO.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO)
AND (PC_PUESTOS_ORIGEN.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN)
<%0!=null AND (PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR = {0}) 0!=null%>
<%1!=null AND (PC_BIT_MOVIMIENTOS.PC_FCH_MOVIMIENTO BETWEEN TO_DATE(''{1}'',''DD/MM/YYYY'') AND  TO_DATE(''{2}'',''DD/MM/YYYY'')) 1!=null%>
)ORDER BY PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS DESC;
-- Query para Login
97
SELECT PC_LOGIN.PC_USERID,
       PC_LOGIN.PC_NOMBRE_CUENTA,
	   PC_ROLES_DIV.PC_CVE_DIV,
	   PC_ROLES_DIV.PC_CVE_SUBDIV,
 	   PC_ROLES_DIV.PC_CVE_ROL,
 	   PC_LOGIN.PC_CVE_USUARIO
FROM PC_LOGIN , PC_ROLES_DIV
WHERE ( (PC_LOGIN.PC_USERID = PC_ROLES_DIV.PC_USERID)
AND (PC_ROLES_DIV.PC_STATUS = 1)
AND (PC_LOGIN.PC_USERID = ''{0}'')
AND (PC_ROLES_DIV.PC_CVE_DIV={1})
AND (PC_ROLES_DIV.PC_CVE_SUBDIV={2}));
-- Query para Login
98
SELECT PC_ACCIONES.PC_DESC_ACCION,
	   PC_ACCIONES.PC_URL_ACCION
FROM PC_PERFILES , PC_ACCIONES
WHERE ( (PC_ACCIONES.PC_CVE_ACCION = PC_PERFILES.PC_CVE_ACCION)
AND (PC_PERFILES.PC_CVE_ROL = {0}));
-- Query para Login
99
SELECT PC_ROLES_DIV.PC_CVE_DIV,
 	   PC_SUBDIVISION.PC_DESC_SUBDIV
FROM PC_LOGIN , PC_ROLES_DIV, PC_SUBDIVISION
WHERE ( (PC_LOGIN.PC_USERID = PC_ROLES_DIV.PC_USERID)
AND (PC_ROLES_DIV.PC_CVE_SUBDIV= PC_SUBDIVISION.PC_CVE_SUBDIV)
AND (PC_ROLES_DIV.PC_STATUS = 1)
AND (PC_LOGIN.PC_USERID = ''{0}''));
-- Query para Login
100
SELECT PC_LOGIN.PC_USERID,
       PC_LOGIN.PC_NOMBRE_CUENTA,
       PC_LOGIN.PC_EXPIRATIONDATE
FROM PC_LOGIN
WHERE ( (PC_LOGIN.PC_USERID = ''{0}'')
AND (PC_LOGIN.PC_PASSWORD = ''{1}'') );
-- Query para desasignar Superior Comprobación
101
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD
FROM PC_VENDEDORES
WHERE PC_VENDEDORES.PC_CVE_SUPERIOR= {0};
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
102
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES , PC_PUESTOS
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO(+) = PC_VENDEDORES.PC_CVE_PUESTO)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {0})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {0}
	CONNECT BY PRIOR  PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%2!=0 AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)) 2!=0%>
)ORDER BY PC_NOMBRE_VENDEDOR;
-- Query para desasignar Superior Comprobación
103
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD
FROM PC_VENDEDORES
WHERE PC_VENDEDORES.PC_CVE_SUP_CAD = {0};
-- Query para desasignar Superior Comprobación
104
UPDATE PC_VENDEDORES SET PC_VENDEDORES.PC_CVE_SUP_CAD = (
	   SELECT PC_VENDEDORES.PC_CVE_SUPERIOR
	   FROM PC_VENDEDORES
	   WHERE PC_VENDEDORES.PC_CVE_VENDEDOR= {0})
WHERE PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	  SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	  FROM PC_VENDEDORES
	  WHERE PC_VENDEDORES.PC_CVE_SUP_CAD= {0}
);
-- Query Admin equal 1
105
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD
FROM PC_VENDEDORES
ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query Admin equal 2
106
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV
FROM PC_PUNTO_VENTAS;
-- Query Admin equal 4
107
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO  || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
       PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO  || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD, pc_subdivision.pc_desc_subdiv pc_subdivision,
	   PC_VENDEDORES.PC_CVE_EMPRESA
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR, PC_VENDEDORES PC_SUP_CAD, pc_subdivision
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
and (pc_vendedores.PC_CVE_SUBDIV = pc_subdivision.PC_CVE_SUBDIV)
AND ((PC_VENDEDORES.PC_CVE_VENDEDOR = {0}))); --query modificado  OR PC_VENDEDORES.PC_CVE_EMP_REF=''{0}''
-- Query Admin equal 5
108
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUNTO_VENTAS.PC_DIRECCION PC_DIRECCION,
	   PC_PUNTO_VENTAS.PC_COLONIA PC_COLONIA,
	   PC_PUNTO_VENTAS.PC_CP PC_CP,
	   PC_PUNTO_VENTAS.PC_TEL PC_TEL,
	   PC_PUNTO_VENTAS.PC_FAX PC_FAX,
       PC_PUNTO_VENTAS.PC_CIUDAD PC_CIUDAD,
	   PC_PUNTO_VENTAS.PC_ESTADO PC_ESTADO,
	   PC_PUNTO_VENTAS.PC_STATUS PC_STATUS,
	   PC_PUNTO_VENTAS.PC_DIG_VERIF PC_DIG_VERIF,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_DIVISION.PC_DESC_DIV PC_DESC_DIV,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_REGION , PC_TIPO_CANAL , PC_CANAL, PC_DIVISION, PC_SUBDIVISION
WHERE ( (PC_REGION.PC_CVE_REGION(+) = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_DIVISION.PC_CVE_DIV = PC_PUNTO_VENTAS.PC_CVE_DIV)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = ''{0}''));-- OR PC_PUNTO_VENTAS.PC_CVE_REFERENCIA = ''{0}''));
-- Query Adimin equal 6
109
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO
FROM PC_VENDEDORES
WHERE ( (PC_VENDEDORES.PC_CVE_PUESTO = {0}) );
-- Query Adimin equal 12
110
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS
FROM PC_PUNTO_VENTAS
WHERE ( (PC_PUNTO_VENTAS.PC_CVE_CANAL = ''{0}'') );
-- Query Adimin equal 38
111
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD, PC_DESC_SUBDIV PC_SUBDIVISION,
	   PC_VENDEDORES.PC_CVE_EMPRESA
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
);
-- Query Admin equal 40
112
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES;
-- Query Admin equal 44
113
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_PUNTO_VENTAS , PC_CANAL , PC_VENDEDORES
WHERE ( (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
<%0!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {0}) 0!=null%>
<%1!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{1}'') 1!=null%> );
-- Query Admin equal 46
114
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_FCH_MOVIMIENTO PC_FCH_MOVIMIENTO,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_USUARIO PC_CVE_USUARIO,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_AUTORIZA PC_CVE_AUTORIZA
FROM PC_INTER_VENDEDORES_PTOVENTAS;
-- Query Admin equal 47
115
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_VENDEDORES
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND ((NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA''))
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{0}'') );
-- Query Admin equal 48
116
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_PUNTO_VENTAS , PC_CANAL
WHERE ( (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {0}));
-- Query Admin equal 49
117
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_FCH_MOVIMIENTO PC_FCH_MOVIMIENTO,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_VENDEDORES , PC_PUNTO_VENTAS , PC_CANAL
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND ((NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA''))
<%0!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{0}'') 0!=null%>
<%1!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {1}) 1!=null%>);
-- Query Admin equal 50
118
SELECT PC_DIVISION.PC_CVE_DIV PC_CVE_DIV,
       PC_DIVISION.PC_DESC_DIV PC_DESC_DIV
FROM PC_DIVISION;
-- Query Admin equal 61
119
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO
FROM PC_VENDEDORES
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR;
-- Query Admin equal 62
120
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO
FROM PC_VENDEDORES
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR  PC_VENDEDORES.PC_CVE_SUPERIOR = PC_VENDEDORES.PC_CVE_VENDEDOR;
-- Query Admin equal 68
121
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUP_CAD
FROM PC_VENDEDORES
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = {0}));
-- Query Admin equal 69
122
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS
FROM PC_INTER_VENDEDORES_PTOVENTAS
WHERE(PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {0});
-- Query Admin equal 72
123
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_DIVISION.PC_DESC_DIV PC_DESC_DIV,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_CANAL , PC_TIPO_CANAL , PC_REGION, PC_DIVISION, PC_SUBDIVISION
WHERE (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_REGION.PC_CVE_REGION = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_DIVISION.PC_CVE_DIV = PC_PUNTO_VENTAS.PC_CVE_DIV)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_PUNTO_VENTAS.PC_CVE_REGION = {0}) ;
-- Query Admin equal 75
124
SELECT PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR
FROM PC_BIT_MOVIMIENTOS
WHERE ( (PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR = {0}) );
-- Query Admin equal 86
125
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES , PC_PUESTOS
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO(+) = PC_VENDEDORES.PC_CVE_PUESTO)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {0})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {0}
	CONNECT BY PRIOR  PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
)))
ORDER BY PC_NOMBRE_VENDEDOR;
-- Query Admin equal 92
126
SELECT PC_MAPEO_VENDEDOR.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_MAPEO_VENDEDOR.PC_SISTEMA PC_SISTEMA,
	   PC_MAPEO_VENDEDOR.PC_CUSTOMER_ID PC_CUSTOMER_ID,
	   PC_MAPEO_VENDEDOR.PC_CVE_REG_VENTA PC_CVE_REG_VENTA,
	   PC_MAPEO_VENDEDOR.PC_NOM_USUARIO PC_NOM_USUARIO, pc_subdivision.pc_desc_subdiv pc_subdivision
FROM PC_MAPEO_VENDEDOR, pc_subdivision, pc_vendedores
WHERE pc_mapeo_vendedor.PC_CVE_VENDEDOR = pc_vendedores.PC_CVE_VENDEDOR
and pc_vendedores.PC_CVE_SUBDIV = pc_subdivision.PC_CVE_SUBDIV
and PC_MAPEO_VENDEDOR.PC_CVE_VENDEDOR = {0};
-- Query Admin equal 93
127
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,
	   PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
	   PC_PUESTOS.PC_CVE_PUESTO,
	   PC_PUESTOS.PC_DESC_PUESTO,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_VENDEDORES, PC_PUESTOS, PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
AND PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR(+)
AND PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR;
-- Query Admin equal 94
128
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_FCH_MOVIMIENTO PC_FCH_MOVIMIENTO,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_VENDEDORES , PC_PUNTO_VENTAS , PC_CANAL
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER = {0}) );
-- Query Admin equal 95
129
SELECT PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS,
       PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR,
       PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_FCH_MOVIMIENTO,
       PC_BIT_MOVIMIENTOS.PC_FCH_TRANSACCION,
       PC_PUNTO_VENTAS_ORIGEN.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_ORIGEN,
       PC_PUNTO_VENTAS_DESTINO.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_DESTINO,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
       PC_VENDEDORES.PC_APE_PATERNO  || '' '' ||
       PC_VENDEDORES.PC_APE_MATERNO PC_NOM_COMP_VENDEDOR,
       PC_SUPERIOR_ORIGEN.PC_NOM_VENDEDOR || '' '' ||
       PC_SUPERIOR_ORIGEN.PC_APE_PATERNO  || '' '' ||
       PC_SUPERIOR_ORIGEN.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_ORIGEN,
       PC_SUPERIOR_DESTINO.PC_NOM_VENDEDOR || '' '' ||
       PC_SUPERIOR_DESTINO.PC_APE_PATERNO  || '' '' ||
       PC_SUPERIOR_DESTINO.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_DESTINO,
       PC_PUESTOS_ORIGEN.PC_DESC_PUESTO PC_DESC_PUESTO_ORIGEN,
       PC_PUESTOS_DESTINO.PC_DESC_PUESTO PC_DESC_PUESTO_DESTINO
FROM PC_BIT_MOVIMIENTOS , PC_VENDEDORES ,
	 PC_PUNTO_VENTAS PC_PUNTO_VENTAS_ORIGEN,
	 PC_PUNTO_VENTAS PC_PUNTO_VENTAS_DESTINO,
	 PC_VENDEDORES PC_SUPERIOR_ORIGEN,
	 PC_VENDEDORES PC_SUPERIOR_DESTINO,
	 PC_PUESTOS PC_PUESTOS_DESTINO,
	 PC_PUESTOS PC_PUESTOS_ORIGEN
WHERE ((PC_VENDEDORES.PC_CVE_VENDEDOR = PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR)
AND (PC_PUNTO_VENTAS_ORIGEN.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN)
AND (PC_PUNTO_VENTAS_DESTINO.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO)
AND (PC_SUPERIOR_ORIGEN.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN)
AND (PC_SUPERIOR_DESTINO.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO)
AND (PC_PUESTOS_DESTINO.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO)
AND (PC_PUESTOS_ORIGEN.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN)
AND (ROWNUM < {0}))
ORDER BY PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS DESC;
-- Query Admin equal 96
130
SELECT PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS,
       PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR,
       PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_FCH_MOVIMIENTO,
       PC_BIT_MOVIMIENTOS.PC_FCH_TRANSACCION,
       PC_PUNTO_VENTAS_ORIGEN.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_ORIGEN,
       PC_PUNTO_VENTAS_DESTINO.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_DESTINO,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
       PC_VENDEDORES.PC_APE_PATERNO  || '' '' ||
       PC_VENDEDORES.PC_APE_MATERNO PC_NOM_COMP_VENDEDOR,
       PC_SUPERIOR_ORIGEN.PC_NOM_VENDEDOR || '' '' ||
       PC_SUPERIOR_ORIGEN.PC_APE_PATERNO  || '' '' ||
       PC_SUPERIOR_ORIGEN.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_ORIGEN,
       PC_SUPERIOR_DESTINO.PC_NOM_VENDEDOR || '' '' ||
       PC_SUPERIOR_DESTINO.PC_APE_PATERNO  || '' '' ||
       PC_SUPERIOR_DESTINO.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_DESTINO,
       PC_PUESTOS_ORIGEN.PC_DESC_PUESTO PC_DESC_PUESTO_ORIGEN,
       PC_PUESTOS_DESTINO.PC_DESC_PUESTO PC_DESC_PUESTO_DESTINO
FROM PC_BIT_MOVIMIENTOS , PC_VENDEDORES ,
	 PC_PUNTO_VENTAS PC_PUNTO_VENTAS_ORIGEN,
	 PC_PUNTO_VENTAS PC_PUNTO_VENTAS_DESTINO,
	 PC_VENDEDORES PC_SUPERIOR_ORIGEN,
	 PC_VENDEDORES PC_SUPERIOR_DESTINO,
	 PC_PUESTOS PC_PUESTOS_DESTINO,
	 PC_PUESTOS PC_PUESTOS_ORIGEN
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR)
AND (PC_PUNTO_VENTAS_ORIGEN.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN)
AND (PC_PUNTO_VENTAS_DESTINO.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO)
AND (PC_SUPERIOR_ORIGEN.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN)
AND (PC_SUPERIOR_DESTINO.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO)
AND (PC_PUESTOS_DESTINO.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO)
AND (PC_PUESTOS_ORIGEN.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN)
<%0!=null AND (PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR = {0}) 0!=null%>
<%1!=null AND (PC_BIT_MOVIMIENTOS.PC_FCH_MOVIMIENTO BETWEEN TO_DATE(''{1}'',''DD/MM/YYYY'') AND  TO_DATE(''{2}'',''DD/MM/YYYY'')) 1!=null%>
)ORDER BY PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS DESC;
-- Query Admin equal 102
131
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES , PC_PUESTOS
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO(+) = PC_VENDEDORES.PC_CVE_PUESTO)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {0})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {0}
	CONNECT BY PRIOR  PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
)))
ORDER BY PC_NOMBRE_VENDEDOR;
-- Query Login ROL ID
132
SELECT DISTINCT PC_LOGIN.PC_USERID,
       PC_LOGIN.PC_NOMBRE_CUENTA,
 	   PC_ROLES_DIV.PC_CVE_ROL,
 	   PC_LOGIN.PC_CVE_USUARIO
FROM PC_LOGIN , PC_ROLES_DIV
WHERE ( (PC_LOGIN.PC_USERID = PC_ROLES_DIV.PC_USERID)
AND (PC_ROLES_DIV.PC_STATUS = 1)
AND (PC_LOGIN.PC_USERID = ''{0}''));
-- Query para obtener el organigrama hacia abajo
133
SELECT a.NIVEL,
       a.PC_CVE_VENDEDOR,
       a.PC_NOMBRE_VENDEDOR,
	   a.PC_FCH_ALTA,
	   a.PC_FCH_BAJA,
	   a.PC_DIG_VERIF,
	   a.PC_CIUDAD,
	   a.PC_ESTADO,
	   a.PC_DIRECCION,
	   a.PC_COLONIA,
	   a.PC_CP,
	   a.PC_TEL,
	   a.PC_FAX,
	   a.PC_CVE_SUBDIV,
	   a.PC_CVE_PUESTO,
	   a.PC_DESC_PUESTO,
	   a.PC_CVE_SUPERIOR,
	   a.PC_NOMBRE_SUPERIOR,
	   a.PC_DESC_PUESTO_SUP,
	   a.PC_DESC_DIV,
	   a.PC_CVE_EMP_REF
FROM
(SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,
	   PC_VENDEDORES.PC_DIRECCION,
	   PC_VENDEDORES.PC_COLONIA,
	   PC_VENDEDORES.PC_CP,
	   PC_VENDEDORES.PC_TEL,
	   PC_VENDEDORES.PC_FAX,
	   PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   PC_VENDEDORES.PC_CVE_EMP_REF,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
	   PC_VENDEDORES.PC_CVE_SUPERIOR,
	   (SELECT superior.PC_APE_PATERNO || '' '' ||
	           superior.PC_APE_MATERNO || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	   (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = {2}) PC_DESC_DIV
FROM PC_VENDEDORES
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)a,
(SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
FROM PC_VENDEDORES
WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) b
WHERE  a.PC_CVE_VENDEDOR=b.PC_CVE_VENDEDOR
order by a.nivel, a.pc_cve_superior, a.pc_cve_puesto, a.PC_NOMBRE_VENDEDOR;
-- Query para añadir tiendas en reporte organigrama
134
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR,
	   PC_VENDEDORES.PC_CVE_SUPERIOR,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_VENDEDORES, PC_PUESTOS, PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
AND PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR(+)
AND PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND (NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
ORDER BY PC_VENDEDORES.PC_CVE_VENDEDOR;
-- Query para reporte sin division
135
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO  || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   PC_VENDEDORES.PC_CVE_EMP_REF,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
   	   PC_VENDEDORES.PC_CVE_SUPERIOR,
       (SELECT superior.PC_APE_PATERNO || '' '' ||
	           superior.PC_APE_MATERNO || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
		(SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	    (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = {0}) PC_DESC_DIV
FROM PC_VENDEDORES
WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
order by nivel, pc_vendedores.pc_cve_superior, pc_vendedores.pc_cve_puesto, pc_vendedores.PC_APE_PATERNO;
-- Query para añadir tiendas en reporte organigrama
136
SELECT a.PC_CVE_VENDEDOR,
	   b.PC_CVE_PTOVENTAS,
	   b.PC_NOM_PTOVENTAS,
	   b.PC_CVE_CANAL,
	   b.PC_CVE_REGION,
	   b.PC_CVE_REFERENCIA,
	   b.PC_DESC_CANAL,
	   b.PC_CVE_TP_CANAL,
	   b.PC_DESC_TP_CANAL,
	   b.PC_DESC_REGION
FROM
(
SELECT LEVEL AS NIVEL, ROWNUM AS REGISTRO, PC_VENDEDORES.PC_CVE_VENDEDOR
FROM PC_VENDEDORES
WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) a,
(
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
AND (NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
) b
WHERE a.PC_CVE_VENDEDOR = b.PC_CVE_VENDEDOR(+)
ORDER BY PC_CVE_VENDEDOR;
-- Query Personal Parametros Perdido
137
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       CASE PC_VENDEDORES.PC_CVE_SUPERIOR
	   WHEN {2} THEN NULL
	   ELSE PC_VENDEDORES.PC_CVE_SUPERIOR END
	   PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA,
	   PC_SUBDIVISION.PC_DESC_SUBDIV pc_subdivision
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {3}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)))
UNION
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
      PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA,
       PC_SUBDIVISION.PC_DESC_SUBDIV pc_subdivision	
	FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
	WHERE ((PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
	--AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NULL)
	AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
	AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
	AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
	<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
	<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>)
	ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query para busqueda de String completo REF 111
138
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA,   PC_SUBDIVISION.PC_DESC_SUBDIV pc_subdivision
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND (UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%'')) 1!=null%>
);
-- Query Personal Parametro Perdido verificando sobre el nombre completo
139
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       CASE PC_VENDEDORES.PC_CVE_SUPERIOR
	   WHEN {2} THEN NULL
	   ELSE PC_VENDEDORES.PC_CVE_SUPERIOR END
	   PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA,   PC_SUBDIVISION.PC_DESC_SUBDIV pc_subdivision
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {3}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)))
UNION
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA,
	   PC_SUBDIVISION.PC_DESC_SUBDIV pc_subdivision	
	FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
	WHERE ((PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
	--AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NULL)
	AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
	AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
	AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
	<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
	<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>)
	ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query para Verificar Nombres antes de darlos de alta un Div
140
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       CASE PC_VENDEDORES.PC_CVE_SUPERIOR
	   WHEN {3} THEN NULL
	   ELSE PC_VENDEDORES.PC_CVE_SUPERIOR END
	   PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	    PC_DIVISION.PC_DESC_DIV PC_SUBDIVISION	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, pc_division
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_DIVISION.PC_CVE_DIV)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{0}%''))
  OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%''))
  OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{2}%'')))
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {3}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {4}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))) ;
-- Query para Verificar Nombres antes de darlos de alta
141
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_DIVISION.PC_DESC_DIV PC_SUBDIVISION	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_DIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_DIVISION.PC_CVE_DIV)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{0}%''))
  OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%''))
  OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{2}%'')))
);
-- Query para obtener la siguiente clave disponible en la Tabla de Puntos de Venta
142
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       CASE PC_VENDEDORES.PC_CVE_SUPERIOR
	   WHEN {2} THEN NULL
	   ELSE PC_VENDEDORES.PC_CVE_SUPERIOR END
	   PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {3})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {3}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {4}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)))
UNION
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ((PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {3})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {3}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>)
ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query para busqueda de String completo REF 111
143
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA,
       PC_SUBDIVISION.PC_DESC_SUBDIV pc_subdivision	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {2})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {2}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND (UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%'')) 1!=null%>
);
-- Query para obtener la siguiente clave disponible en la Tabla de Puntos de Venta
144
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       CASE PC_VENDEDORES.PC_CVE_SUPERIOR
	   WHEN {2} THEN NULL
	   ELSE PC_VENDEDORES.PC_CVE_SUPERIOR END
	   PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {3})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {3}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {4}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)))
UNION
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ((PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {3})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {3}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>)
ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query Adimin equal 38
145
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {2})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {2}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
);
-- Testing Stored Procedures
146
{ call ? := sp_get_stocks(?) };
-- Query Adimin equal 111 con filtro de bajas
147
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD, PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
);
-- Query para busqueda de String completo REF 138 con filtro de bajas
148
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
	   PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD, PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND (UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%'')) 1!=null%>;
-- Query Personal Parametros Perdido 137
149
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       CASE PC_VENDEDORES.PC_CVE_SUPERIOR
	   WHEN {2} THEN NULL
	   ELSE PC_VENDEDORES.PC_CVE_SUPERIOR END
	   PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD, PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {3}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)))
UNION
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ((NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>)
ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query Personal Parametro Perdido verificando sobre el nombre completo 139
150
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       CASE PC_VENDEDORES.PC_CVE_SUPERIOR
	   WHEN {2} THEN NULL
	   ELSE PC_VENDEDORES.PC_CVE_SUPERIOR END
	   PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {3}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)))
UNION
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>)
ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query Cuentas de Acceso
151
select distinct a.pc_userid, a.pc_nombre_cuenta, b.pc_desc_rol, a.pc_isblocked, a.pc_logindate, a.pc_expirationdate, a.pc_cambia_password
from CATVEN.pc_login a, CATVEN.pc_roles b, CATVEN.pc_roles_div c
where a.pc_userid = c.pc_userid(+)
and c.pc_cve_rol = b.pc_cve_rol(+)
order by 1;
-- Query Acciones Aplicacion
152
SELECT PC_CVE_ACCION,
	   PC_DESC_ACCION,
	   PC_URL_ACCION
FROM PC_ACCIONES;
-- Query Roles Aplicacion
153
SELECT PC_CVE_ROL,
	   PC_DESC_ROL
FROM CATVEN.PC_ROLES;
-- Query Perfiles Aplicacion
154
SELECT PC_CVE_PERFIL,
       PC_CVE_ROL,
	   (SELECT PC_DESC_ROL
	   FROM PC_ROLES
	   WHERE PC_ROLES.PC_CVE_ROL=PC_PERFILES.PC_CVE_ROL) PC_DESC_ROL,
	   PC_CVE_ACCION,
	   (SELECT PC_DESC_ACCION
	    FROM PC_ACCIONES
		WHERE PC_ACCIONES.PC_CVE_ACCION = PC_PERFILES.PC_CVE_ACCION) PC_DESC_ACCION
FROM CATVEN.PC_PERFILES
<%0!=null WHERE PC_CVE_ROL={0} 0!=null%>;
-- Insertar Cuenta de Acceso
155
INSERT INTO CATVEN.PC_LOGIN (PC_USERID, PC_PASSWORD, PC_NOMBRE_CUENTA, PC_CVE_USUARIO, PC_ISBLOCKED, PC_LOGINDATE, PC_EXPIRATIONDATE)
               VALUES(''{0}'',''{1}'',''{2}'',(SELECT (MAX(PC_CVE_USUARIO)+1) FROM PC_LOGIN), 0, SYSDATE, TO_DATE(''{3}'',''DD/MM/YYYY''));
-- Eliminar Cuenta de Acceso
156
DELETE FROM CATVEN.PC_LOGIN WHERE PC_USERID = ''{0}'';
-- Actualizar Cuenta de Acceso
157
UPDATE CATVEN.PC_LOGIN SET PC_NOMBRE_CUENTA = ''{2}'', PC_PASSWORD=''{1}'', PC_ISBLOCKED='0',
	   PC_LOGINDATE=SYSDATE, PC_EXPIRATIONDATE = TO_DATE(''{3}'',''DD/MM/YYYY''), PC_CAMBIA_PASSWORD='1'
WHERE PC_USERID= ''{0}'';
-- Cambiar Contraseña
158
UPDATE CATVEN.PC_LOGIN SET PC_PASSWORD = {0}
WHERE PC_CVE_USUARIO = {1};
-- Insertar un Perfil
159
INSERT INTO CATVEN.PC_PERFILES (PC_CVE_PERFIL, PC_CVE_ROL, PC_CVE_ACCION)
                 VALUES ((SELECT (MAX(PC_CVE_PERFIL)+1) FROM PC PERFILES),{0},{1});
-- Eliminar un Perfil
160
DELETE FROM CATVEN.PC_PERFILES WHERE PC_CVE_PERFIL = {0};
-- Insertar Rol Division
161
INSERT INTO CATVEN.PC_ROLES_DIV (PC_CVE_ROL_DIV, PC_USERID, PC_CVE_ROL, PC_CVE_DIV, PC_STATUS, PC_CVE_SUBDIV)
VALUES((SELECT (MAX(PC_CVE_ROL_DIV)+1) FROM PC_ROLES_DIV), ''{0}'', {1},{2},1,{2});
-- Seleccionar Permisos para despliegue de tabla
162
SELECT PC_ROLES_DIV.PC_CVE_ROL_DIV,
	   PC_ROLES_DIV.PC_USERID,
	   PC_ROLES_DIV.PC_CVE_ROL,
	   PC_ROLES_DIV.PC_CVE_SUBDIV PC_CVE_DIV,
	   PC_ROLES_DIV.PC_STATUS,
	   PC_SUBDIVISION.PC_DESC_SUBDIV,
	   PC_ROLES.PC_DESC_ROL,
	   CASE PC_ROLES_DIV.PC_STATUS
	   WHEN 1 THEN ''ACTIVO''
	   ELSE ''BLOQUEADO'' END PC_DESC_STATUS
FROM CATVEN.PC_ROLES_DIV , PC_SUBDIVISION, CATVEN.PC_ROLES
WHERE PC_ROLES_DIV.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV
AND PC_ROLES_DIV.PC_CVE_ROL =  PC_ROLES.PC_CVE_ROL
ORDER BY PC_USERID;
-- Eliminar una relacion en Division y Rol
163
DELETE FROM PC_ROLES_DIV WHERE PC_ROLES_DIV.PC_CVE_ROL_DIV = {0};
-- Seleccionar todas las Divisiones
164
SELECT PC_DIVISION.PC_CVE_DIV PC_CVE_DIV,
       PC_DIVISION.PC_DESC_DIV PC_DESC_DIV
FROM PC_DIVISION;
-- Desativar Rol Division
165
UPDATE CATVEN.PC_ROLES_DIV SET PC_STATUS={1} WHERE PC_ROLES_DIV.PC_CVE_ROL_DIV = {0};
-- Access Log
166
INSERT INTO CATVEN.PC_LOG_ACCESO (PC_USERID, PC_DIR_IP, PC_TRANSACCION) VALUES (''{0}'', ''{1}'', ''{2}'');
-- Obtener Subordinados sin Division
167
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA PC_CVE_EMPRESA
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR = {0})
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
);
-- Obtener Subordinados con division
168
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA PC_CVE_EMPRESA	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR = {0})
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para Login
169
SELECT DISTINCT PC_ROLES_DIV.PC_CVE_DIV,
	   PC_SUBDIVISION.PC_CVE_SUBDIV,
   	   PC_SUBDIVISION.PC_DESC_SUBDIV
FROM CATVEN.PC_LOGIN, CATVEN.PC_ROLES_DIV, PC_SUBDIVISION
WHERE ( (PC_LOGIN.PC_USERID = PC_ROLES_DIV.PC_USERID)
AND (PC_ROLES_DIV.PC_CVE_DIV= PC_SUBDIVISION.PC_CVE_DIV)
AND (PC_ROLES_DIV.PC_STATUS = 1)
AND (PC_LOGIN.PC_USERID = ''{0}''));
-- Query para insertar la relacion del Personal con la Division basado en su superior
170
INSERT INTO PC_INTER_SUBDIVISION
	(SELECT PC_INTER_SUBDIVISION.PC_CVE_SUBDIV, {0} PC_CVE_VENDEDOR
	 FROM PC_INTER_SUBDIVISION
	 WHERE (PC_INTER_SUBDIVISION.PC_CVE_VENDEDOR={1}));
-- Query para traer todas las subdivisiones
171
SELECT PC_SUBDIVISION.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV,
        PC_SUBDIVISION.PC_CVE_DIV PC_CVE_DIV
FROM PC_SUBDIVISION
WHERE PC_CVE_SUBDIV <>0
<%0!=0 AND PC_SUBDIVISION.PC_CVE_SUBDIV = {0} 0!=0%>;
-- Query para insertar en PC_SUBDIVISION
172
INSERT INTO PC_SUBDIVISION (PC_CVE_SUBDIV, PC_DESC_SUBDIV, PC_CVE_DIV) VALUES ({0},''{1}'',{2});
-- Query para actualizar en PC_SUBDIVISION
173
UPDATE PC_SUBDIVISION SET PC_DESC_SUBDIV=''{1}'' WHERE PC_CVE_SUBDIV={0};
-- Query para eliminar en PC_SUBDIVISION
174
DELETE FROM PC_SUBDIVISION WHERE PC_CVE_SUBDIV={0};
-- Query para obtener la clave de PC_SUBDIVISION
175
SELECT NVL((MAX(PC_CVE_SUBDIV)+1),0) CLAVE FROM PC_SUBDIVISION;
-- Query para obtener los movimientos por residuales para un empresario
176
SELECT PC_SUBDIVISION.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV,
       PC_SUBDIVISION.PC_CVE_DIV PC_CVE_DIV
FROM PC_SUBDIVISION , PC_DIVISION
WHERE ( (PC_DIVISION.PC_CVE_DIV = PC_SUBDIVISION.PC_CVE_DIV)
AND (PC_DIVISION.PC_CVE_DIV = {0}) )
ORDER BY PC_DESC_SUBDIV;
-- Query para obtener Puntos de Venta por Subdivision
-- Query para obtener Puntos de Venta por Subdivision restringido Admin
177
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_CANAL , PC_TIPO_CANAL , PC_REGION, PC_SUBDIVISION
WHERE  (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_REGION.PC_CVE_REGION(+) = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {0})
AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {1});
-- Query para desasignar Superior Comprobación
178
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD
FROM PC_VENDEDORES
WHERE PC_VENDEDORES.PC_CVE_SUPERIOR= {0}
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'');
-- Query especial para verificar que no existan relaciones en Pc_Inter_Vendedores_Ptoventas
179
SELECT DISTINCT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_VENDEDORES , PC_PUNTO_VENTAS , PC_CANAL
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND ((NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA''))
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{0}'')
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {1}));
--QUERY PARA DIVISIONES
180
SELECT DISTINCT PC_ROLES_DIV.PC_CVE_DIV,
	   PC_SUBDIVISION.PC_CVE_SUBDIV,
   	   PC_SUBDIVISION.PC_DESC_SUBDIV
FROM PC_LOGIN, PC_ROLES_DIV, PC_SUBDIVISION
WHERE ( (PC_LOGIN.PC_USERID = PC_ROLES_DIV.PC_USERID)
AND (PC_ROLES_DIV.PC_CVE_DIV= PC_SUBDIVISION.PC_CVE_DIV)
AND (PC_ROLES_DIV.PC_STATUS = 1)
AND PC_SUBDIVISION.PC_CVE_SUBDIV <>0
AND (PC_LOGIN.PC_USERID = ''{0}''));
---------------------------
-- Query para reporte sin division
300
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   PC_VENDEDORES.PC_CVE_EMP_REF,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
   	   PC_VENDEDORES.PC_CVE_SUPERIOR,
       (SELECT superior.PC_APE_PATERNO || '' '' ||
	           superior.PC_APE_MATERNO  || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
		(SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	    (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = {0}) PC_DESC_DIV
FROM PC_VENDEDORES
WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
order by nivel,  PC_VENDEDORES.PC_CVE_PUESTO, pc_vendedores.PC_APE_PATERNO;

-- Query para añadir tiendas en reporte organigrama
301
SELECT a.PC_CVE_VENDEDOR,
	   b.PC_CVE_PTOVENTAS,
	   b.PC_NOM_PTOVENTAS,
	   b.PC_CVE_CANAL,
	   b.PC_CVE_REGION,
	   b.PC_CVE_REFERENCIA,
	   b.PC_DESC_CANAL,
	   b.PC_CVE_TP_CANAL,
	   b.PC_DESC_TP_CANAL,
	   b.PC_DESC_REGION
FROM
(
SELECT LEVEL AS NIVEL, ROWNUM AS REGISTRO, PC_VENDEDORES.PC_CVE_VENDEDOR
FROM PC_VENDEDORES
WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) a,
(
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND (NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
) b
WHERE a.PC_CVE_VENDEDOR = b.PC_CVE_VENDEDOR(+)
ORDER BY PC_CVE_VENDEDOR;
------------------------
-- Query para obtener el organigrama hacia abajo
302
SELECT a.NIVEL,
       a.PC_CVE_VENDEDOR,
       a.PC_NOMBRE_VENDEDOR,
	   a.PC_FCH_ALTA,
	   a.PC_FCH_BAJA,
	   a.PC_DIG_VERIF,
	   a.PC_CIUDAD,
	   a.PC_ESTADO,
	   a.PC_DIRECCION,
	   a.PC_COLONIA,
	   a.PC_CP,
	   a.PC_TEL,
	   a.PC_FAX,
	   a.PC_CVE_SUBDIV,
	   a.PC_CVE_PUESTO,
	   a.PC_DESC_PUESTO,
	   a.PC_CVE_SUPERIOR,
	   a.PC_NOMBRE_SUPERIOR,
	   a.PC_DESC_PUESTO_SUP,
	   a.PC_DESC_DIV
FROM
(SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,
	   PC_VENDEDORES.PC_DIRECCION,
	   PC_VENDEDORES.PC_COLONIA,
	   PC_VENDEDORES.PC_CP,
	   PC_VENDEDORES.PC_TEL,
	   PC_VENDEDORES.PC_FAX,
	   PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
	   PC_VENDEDORES.PC_CVE_SUPERIOR,
	   (SELECT superior.PC_APE_PATERNO  || '' '' ||
	           superior.PC_APE_MATERNO  || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	   (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = {2}) PC_DESC_DIV
FROM PC_VENDEDORES
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)a,
(SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
FROM PC_VENDEDORES
WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) b
WHERE  a.PC_CVE_VENDEDOR=b.PC_CVE_VENDEDOR
order by a.nivel;
-- Query para añadir tiendas en reporte organigrama
303
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR,
	   PC_VENDEDORES.PC_CVE_SUPERIOR,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_VENDEDORES, PC_PUESTOS, PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
AND PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR(+)
AND PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
ORDER BY PC_VENDEDORES.PC_CVE_VENDEDOR;
--query para una division con 2 subdivisiones
304
SELECT a.NIVEL,
       a.PC_CVE_VENDEDOR,
       a.PC_NOMBRE_VENDEDOR,
	   a.PC_FCH_ALTA,
	   a.PC_FCH_BAJA,
	   a.PC_DIG_VERIF,
	   a.PC_CIUDAD,
	   a.PC_ESTADO,
	   a.PC_DIRECCION,
	   a.PC_COLONIA,
	   a.PC_CP,
	   a.PC_TEL,
	   a.PC_FAX,
	   a.PC_CVE_SUBDIV,
	   a.PC_CVE_PUESTO,
	   a.PC_DESC_PUESTO,
	   a.PC_CVE_SUPERIOR,
	   a.PC_NOMBRE_SUPERIOR,
	   a.PC_DESC_PUESTO_SUP,
	   a.PC_DESC_DIV
FROM
(SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,
	   PC_VENDEDORES.PC_DIRECCION,
	   PC_VENDEDORES.PC_COLONIA,
	   PC_VENDEDORES.PC_CP,
	   PC_VENDEDORES.PC_TEL,
	   PC_VENDEDORES.PC_FAX,
	   PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
	   PC_VENDEDORES.PC_CVE_SUPERIOR,
	   (SELECT superior.PC_APE_PATERNO || '' '' ||
	           superior.PC_APE_MATERNO || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	   (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = {2}) PC_DESC_DIV
FROM PC_VENDEDORES
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)a,
(SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
FROM PC_VENDEDORES
WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0)
OR ((PC_VENDEDORES.PC_CVE_SUBDIV = {3})))
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) b
WHERE  a.PC_CVE_VENDEDOR=b.PC_CVE_VENDEDOR
order by a.nivel;
-- Query para añadir tiendas en reporte organigrama
305
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR,
	   PC_VENDEDORES.PC_CVE_SUPERIOR,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_VENDEDORES, PC_PUESTOS, PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
AND PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR(+)
AND PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0)
	OR (PC_VENDEDORES.PC_CVE_SUBDIV = {3}))
	AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
ORDER BY PC_VENDEDORES.PC_CVE_VENDEDOR;
---query para obtener las subdivisiones
306
SELECT PC_CVE_SUBDIV, PC_DESC_SUBDIV
FROM PC_SUBDIVISION
WHERE PC_CVE_SUBDIV <> 0
AND PC_CVE_DIV = {0};
---query para traerme todas las empresas
307
select pc_cve_empresa, pc_desc_empresa, pc_tipo_empresa, pc_nro_compania
from pc_empresas;
---QUERY PARA INSERTAR EMPRESA
308
insert into pc_empresas(pc_cve_empresa, pc_desc_empresa, pc_tipo_empresa, pc_nro_compania)
values((SELECT NVL((MAX(PC_CVE_EMPRESA)+1),0) FROM PC_EMPRESAS), ''{0}'', ''{1}'', 1);
--QUERY PARA BORRAR EMPRESA
309
DELETE FROM PC_EMPRESAS WHERE PC_CVE_EMPRESA={0};
--QUERY PARA ACTUALIZAR EMPRESA
340
UPDATE PC_EMPRESAS SET PC_DESC_EMPRESA=''{1}'',
PC_TIPO_EMPRESA=''{2}''
WHERE PC_CVE_EMPRESA = {0};
-- Query que obtiene todos los datos del personal dada la cve DIVISIONES
312
SELECT PC_VENDEDORES.PC_NOM_VENDEDOR || '' ''||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_COMPLETO,
	   PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' ''||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
       PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD, PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND ((PC_VENDEDORES.PC_CVE_VENDEDOR = (select pc_cve_vendedor from pc_vendedores where pc_cve_emp_ref=''{0}'')))
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR))
    );
-- Query para busqueda de vendedores
313
SELECT PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_COMPLETO,
	   PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO  || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
       PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO  || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD, PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR, PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND ((PC_VENDEDORES.PC_CVE_VENDEDOR = (select pc_cve_vendedor from pc_vendedores where pc_cve_emp_ref= ''{0}''))));

--Query RECUPERA LOS DATOS PARA LA PARTE DE REPORTE DE MOVIMIENTOS
--HACE UN JOIN CON LA TABLA DE BIT_MOVIMIENTOS
314
	SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR,
		   PC_VENDEDORES.PC_CVE_PUESTO,
		   PC_VENDEDORES.PC_CVE_SUPERIOR,
		   PC_VENDEDORES.PC_NOM_VENDEDOR,
	       PC_VENDEDORES.PC_APE_PATERNO,
	       PC_VENDEDORES.PC_APE_MATERNO,
	       PC_VENDEDORES.PC_FCH_ALTA,
	       PC_VENDEDORES.PC_FCH_BAJA,
	       PC_VENDEDORES.PC_DIG_VERIF,
		   PC_VENDEDORES.PC_CNTR_TDA,
		   PC_VENDEDORES.PC_STATUS,
		   PC_VENDEDORES.PC_CVE_EMP_REF,
		   PC_VENDEDORES.PC_CIUDAD,
		   PC_VENDEDORES.PC_ESTADO,
		   PC_VENDEDORES.PC_DIRECCION,
		   PC_VENDEDORES.PC_COLONIA,PC_VENDEDORES.PC_CP,
		   PC_VENDEDORES.PC_TEL,
		   PC_VENDEDORES.PC_FAX,
		   PC_VENDEDORES.PC_CVE_SUP_CAD,
		   PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
		   PC_VENDEDORES.PC_APE_PATERNO  || '' '' ||
		   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_COMPLETO,	
		   PC_PUESTOS.PC_DESC_PUESTO
	FROM   PC_VENDEDORES, PC_BIT_MOVIMIENTOS,PC_PUESTOS
	WHERE  PC_VENDEDORES.PC_CVE_VENDEDOR = PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR
	AND    PC_VENDEDORES.PC_CVE_EMP_REF = ''{0}''
	AND    PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO;
-- QUERY PARA DAR DE ALTA AL VENDEDOR EN LA TABLA DE PC_VENDEDORES_HIS
315	
INSERT INTO PC_VENDEDORES_HIS (PC_CVE_ID,
			PC_CVE_VENDEDOR, PC_CVE_PUESTO,
		    PC_CVE_SUPERIOR, PC_FCH_INICIO,
			PC_FCH_FIN, PC_TP_MOV,
			PC_FCH_TRANSACCION, PC_CVE_USUARIO)
VALUES (SEQ_PC_VENDEDORES_HIS.nextval, {0},{1},{2},TO_DATE(''{3}'',''DD/MM/YYYY HH24:MI:SS''),'''',{4},SYSDATE, {5});	
-- QUERY PARA SABER SI EL USUARIO TIENE MOVIMIENTOS
316
SELECT PC_CVE_ID CLAVE, PC_TP_MOV FROM PC_VENDEDORES_HIS
WHERE  PC_FCH_FIN IS NULL
AND PC_CVE_VENDEDOR = {0}
ORDER BY PC_CVE_ID DESC;
-- QUERY PARA ACTUALIZAR LA FECHA DE BAJA PC_VENDEDORES_HIS
317
UPDATE PC_VENDEDORES_HIS SET PC_FCH_FIN = TO_DATE(''{2}'',''DD/MM/YYYY HH24:MI:SS''),
PC_FCH_TRANSACCION = SYSDATE, PC_CVE_USUARIO = {3}
<%4!=null  ,PC_TP_MOV={4} 4!=null%>
WHERE PC_CVE_ID = {0}
AND PC_CVE_VENDEDOR = {1};
-- QUERY PARA REACTIVAR EL STATUS DEL VENDEDOR
318
UPDATE PC_VENDEDORES_HIS SET PC_FCH_INICIO = TO_DATE(''{1}'',''DD/MM/YYYY HH24:MI:SS''),
PC_FCH_FIN = '''',
PC_TP_MOV=1, PC_FCH_TRANSACCION = SYSDATE, PC_CVE_USUARIO = {2}
WHERE PC_CVE_VENDEDOR = {0};
-- QUERY PARA TRAERME EL ULTIMO MOVIMIENTO DEL VENDEDOR
319
SELECT PC_CVE_ID CLAVE FROM PC_VENDEDORES_HIS
WHERE PC_FCH_FIN IS NULL
AND PC_CVE_VENDEDOR = {0}
AND ((PC_TP_MOV = {1}) OR (PC_TP_MOV=6));
-- QUERY PARA LOS MOVIMIENTOS CUANDO SEA AMBAS(SUPERIOR Y PUESTO)
320
SELECT PC_CVE_ID CLAVE FROM PC_VENDEDORES_HIS
WHERE PC_FCH_FIN IS NULL
AND PC_CVE_VENDEDOR = {0}
AND ((PC_TP_MOV = 3) OR  (PC_TP_MOV = 4)
OR (PC_TP_MOV = 6));
-- QUERY PARA ACTUALIZAR LA FECHA FIN DE VENEDORES HIS
321
UPDATE PC_VENDEDORES_HIS SET PC_FCH_FIN = TO_DATE(''{2}'',''DD/MM/YYYY HH24:MI:SS''),
PC_FCH_TRANSACCION = SYSDATE, PC_CVE_USUARIO = {3}
WHERE PC_CVE_ID = {0}
AND PC_CVE_VENDEDOR = {1};
--QUERY PARA TRAERSE LOS PUNTOS DE VENTA
322
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CP PC_CP,
       PC_PUNTO_VENTAS.PC_TEL PC_TEL,
       PC_PUNTO_VENTAS.PC_FAX PC_FAX,
       PC_PUNTO_VENTAS.PC_DIRECCION PC_DIRECCION,
       PC_PUNTO_VENTAS.PC_COLONIA PC_COLONIA,
       PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
       PC_PUNTO_VENTAS.PC_CIUDAD PC_CIUDAD,
	   PC_PUNTO_VENTAS.PC_ESTADO PC_ESTADO,
	   PC_PUNTO_VENTAS.PC_STATUS PC_STATUS,
	   PC_PUNTO_VENTAS.PC_DIG_VERIF PC_DIG_VERIF,	
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
 FROM PC_PUNTO_VENTAS , PC_CANAL , PC_TIPO_CANAL , PC_SUBDIVISION
 WHERE( (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
 AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
 AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
 <%0!=null AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {0}) 0!=null%>
 <%4!=0 AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {4}) 4!=0%>
 <%1!=null AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = ''{1}'') 1!=null%>
 <%2!=null AND (PC_PUNTO_VENTAS.PC_CVE_CANAL = ''{2}'') 2!=null%>
 <%3!=null AND (UPPER(PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS) like UPPER(''%{3}%'')) 3!=null%>
 )ORDER BY PC_NOM_PTOVENTAS;
 --RECUPERA LOS DATOS DEL PERSONAL DE UNA DIVISION DADOS UNA CLAVE DEL VENDEDOR O SUBDIVISION
330
SELECT a.NIVEL,
       a.PC_CVE_VENDEDOR,
       a.PC_NOMBRE_VENDEDOR,
	   a.PC_FCH_ALTA,
	   a.PC_FCH_BAJA,
	   a.PC_DIG_VERIF,
	   a.PC_CIUDAD,
	   a.PC_ESTADO,
	   a.PC_DIRECCION,
	   a.PC_COLONIA,
	   a.PC_CP,
	   a.PC_TEL,
	   a.PC_FAX,
	   a.PC_CVE_SUBDIV,
	   a.PC_CVE_PUESTO,
	   a.PC_DESC_PUESTO,
	   a.PC_CVE_SUPERIOR,
	   a.PC_NOMBRE_SUPERIOR,
	   a.PC_DESC_PUESTO_SUP,
	   a.PC_DESC_DIV
FROM
(SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,
	   PC_VENDEDORES.PC_DIRECCION,
	   PC_VENDEDORES.PC_COLONIA,
	   PC_VENDEDORES.PC_CP,
	   PC_VENDEDORES.PC_TEL,
	   PC_VENDEDORES.PC_FAX,
	   PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
	    PC_VENDEDORES.PC_CVE_SUPERIOR,
	   (SELECT superior.PC_APE_PATERNO || '' '' ||
	           superior.PC_APE_MATERNO || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	   (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = 0) PC_DESC_DIV
FROM PC_VENDEDORES,PC_VENDEDORES_HIS
WHERE  PC_VENDEDORES_HIS.PC_FCH_FIN IS NULL
AND    PC_VENDEDORES_HIS.PC_FCH_INICIO <= TO_DATE({2})
AND    PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES_HIS.PC_CVE_VENDEDOR
START WITH PC_VENDEDORES_HIS.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR )a,
(SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
FROM PC_VENDEDORES
WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
--AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) b
WHERE  a.PC_CVE_VENDEDOR=b.PC_CVE_VENDEDOR
order by a.nivel;
--RECUPERA EL NOMBRE DEL PUNTO DE VENTA Y LA INFORMACION DEL PERSONAL DADA UNA FECHA ASIGNADA
331
SELECT a.NIVEL,
       a.PC_CVE_VENDEDOR,	
	   a.PC_CVE_SUPERIOR,
	   a.PC_NOM_VENDEDOR,
	   a.PC_FCH_ALTA,	
	   a.PC_DESC_PUESTO,   		   	
       b.PC_CVE_PTOVENTAS,
	   b.PC_NOM_PTOVENTAS,
	   b.PC_CVE_CANAL,
	   b.PC_CVE_REGION,
	   b.PC_CVE_REFERENCIA,
	   b.PC_DESC_CANAL,
	   b.PC_CVE_TP_CANAL,
	   b.PC_DESC_TP_CANAL,
	   b.PC_DESC_REGION 	
FROM  (SELECT DISTINCT LEVEL NIVEL,
	   ROWNUM AS REGISTRO,
	   PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO   PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO  PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO  PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA     PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA     PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF    PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA     PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS       PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF  PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD       PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO       PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION    PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA      PC_COLONIA,
       PC_VENDEDORES.PC_CP           PC_CP,
       PC_VENDEDORES.PC_TEL 		 PC_TEL,
       PC_VENDEDORES.PC_FAX 		 PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV   PC_CVE_SUBDIV,
       PC_VENDEDORES.PC_CVE_SUP_CAD  PC_CVE_SUP_CAD,
	   PC_PUESTOS.PC_DESC_PUESTO
FROM   PC_VENDEDORES_HIS,PC_VENDEDORES,PC_PUESTOS	
WHERE  PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES_HIS.PC_CVE_VENDEDOR
AND    PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
AND    PC_VENDEDORES_HIS.PC_FCH_FIN IS NULL
AND    PC_VENDEDORES_HIS.PC_FCH_INICIO <= TO_DATE({2})
AND    PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	   								  	  SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
										  FROM PC_VENDEDORES
										  WHERE (PC_VENDEDORES.PC_CVE_SUBDIV = {1}))										
START  WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PC_VENDEDORES_HIS.PC_CVE_SUPERIOR = PRIOR PC_VENDEDORES_HIS.PC_CVE_VENDEDOR ) a,
	  	( SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR,
				          PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
						  PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
						  PC_PUNTO_VENTAS.PC_CVE_CANAL,
						  PC_PUNTO_VENTAS.PC_CVE_REGION,
						  PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
						  PC_CANAL.PC_DESC_CANAL,
						  PC_CANAL.PC_CVE_TP_CANAL,
						  PC_TIPO_CANAL.PC_DESC_TP_CANAL,
						  PC_REGION.PC_DESC_REGION						
				    FROM  PC_INTER_VENDEDORES_PTOVENTAS,
				          PC_PUNTO_VENTAS,
						  PC_CANAL,
						  PC_REGION,
						  PC_TIPO_CANAL,
						  pc_vendedores_his				
				    WHERE PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
				    AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
				    AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
				    AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)					
				    and pc_vendedores_his.PC_CVE_VENDEDOR = pc_inter_vendedores_ptoventas.PC_CVE_VENDEDOR(+) ) b
WHERE a.PC_CVE_VENDEDOR = b.PC_CVE_VENDEDOR(+) 	
order by a.nivel;
--RECUPERA LA JERARQUIA DE UN VENDEDOR
332
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
   	   PC_VENDEDORES.PC_CVE_SUPERIOR,
       (SELECT superior.PC_APE_PATERNO || '' '' ||
	           superior.PC_APE_MATERNO || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
		(SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	    (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = 0) PC_DESC_DIV
FROM PC_VENDEDORES,PC_VENDEDORES_HIS
WHERE  PC_VENDEDORES_HIS.PC_FCH_FIN IS NULL
AND    PC_VENDEDORES_HIS.PC_FCH_INICIO <= TO_DATE({1})
<%2!=null AND (PC_VENDEDORES.PC_CVE_SUBDIV = {2}) 2!=null%>
AND    PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES_HIS.PC_CVE_VENDEDOR
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
order by nivel;
--RECUPERA LA JERARQUIA EN UN PUNTO DE VENTA DADO  UN VENDEDOR
333
SELECT a.PC_CVE_VENDEDOR,
	   b.PC_CVE_PTOVENTAS,
	   b.PC_NOM_PTOVENTAS,
	   b.PC_CVE_CANAL,
	   b.PC_CVE_REGION,
	   b.PC_CVE_REFERENCIA,
	   b.PC_DESC_CANAL,
	   b.PC_CVE_TP_CANAL,
	   b.PC_DESC_TP_CANAL,
	   b.PC_DESC_REGION
FROM
(	SELECT LEVEL AS NIVEL, ROWNUM AS REGISTRO, PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM   PC_VENDEDORES,PC_VENDEDORES_HIS 	
	WHERE  PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES_HIS.PC_CVE_VENDEDOR
	AND    PC_VENDEDORES_HIS.PC_FCH_FIN IS NULL
    AND    PC_VENDEDORES_HIS.PC_FCH_INICIO <= TO_DATE({1})
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) a,
(
 	SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR,
		   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
		   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
		   PC_PUNTO_VENTAS.PC_CVE_CANAL,
		   PC_PUNTO_VENTAS.PC_CVE_REGION,
		   PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
		   PC_CANAL.PC_DESC_CANAL,
		   PC_CANAL.PC_CVE_TP_CANAL,
		   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
		   PC_REGION.PC_DESC_REGION
	FROM   PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL,pc_vendedores_his
	WHERE  PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
	AND    PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
	AND    PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
	AND    PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
	and    pc_vendedores_his.PC_CVE_VENDEDOR = pc_inter_vendedores_ptoventas.PC_CVE_VENDEDOR(+) ) b
	WHERE  a.PC_CVE_VENDEDOR = b.PC_CVE_VENDEDOR(+)
ORDER BY  PC_CVE_VENDEDOR;
---QUERY PARA SABER SI EL PUNTO DE VENTA EXISTE EN PVS
334
SELECT CDG_CSI PC_CVE_PTOVENTAS FROM CAT_CSI
WHERE CDG_CSI = ''{0}'';
---QUERY PARA CAMBIAR DE DIVISION A UN VENDEDOR
335
UPDATE PC_VENDEDORES SET
PC_CVE_SUPERIOR = ''{1}'',
PC_CVE_SUBDIV = ''{1}''
WHERE PC_CVE_VENDEDOR = ''{0}'';
--Query para TRAER PUNTOS DE VENTA POR NUMERO ECONOMICO ADMINISTRADOR
336
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUNTO_VENTAS.PC_DIRECCION PC_DIRECCION,
	   PC_PUNTO_VENTAS.PC_COLONIA PC_COLONIA,
	   PC_PUNTO_VENTAS.PC_CP PC_CP,
	   PC_PUNTO_VENTAS.PC_TEL PC_TEL,
	   PC_PUNTO_VENTAS.PC_FAX PC_FAX,
       PC_PUNTO_VENTAS.PC_CIUDAD PC_CIUDAD,
	   PC_PUNTO_VENTAS.PC_ESTADO PC_ESTADO,
	   PC_PUNTO_VENTAS.PC_STATUS PC_STATUS,
	   PC_PUNTO_VENTAS.PC_DIG_VERIF PC_DIG_VERIF,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_DIVISION.PC_DESC_DIV PC_DESC_DIV,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_REGION , PC_TIPO_CANAL , PC_CANAL, PC_DIVISION, PC_SUBDIVISION
WHERE ( (PC_REGION.PC_CVE_REGION(+) = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_DIVISION.PC_CVE_DIV = PC_PUNTO_VENTAS.PC_CVE_DIV)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_PUNTO_VENTAS.PC_CVE_REFERENCIA = ''{0}''));
--Query para TRAER PUNTOS DE VENTA POR NUMERO ECONOMICO DIVISIONAL
337
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
       PC_PUNTO_VENTAS.PC_CIUDAD PC_CIUDAD,
	   PC_PUNTO_VENTAS.PC_ESTADO PC_ESTADO,
	   PC_PUNTO_VENTAS.PC_STATUS PC_STATUS,
	   PC_PUNTO_VENTAS.PC_DIG_VERIF PC_DIG_VERIF,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_REGION , PC_TIPO_CANAL , PC_CANAL, PC_SUBDIVISION
WHERE ( (PC_REGION.PC_CVE_REGION(+) = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_PUNTO_VENTAS.PC_CVE_REFERENCIA = ''{0}'')
AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {1})
AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {2}));-- OR PC_PUNTO_VENTAS.PC_CVE_REFERENCIA = ''{0}''
--QUERY PARA TRAERME LOS SUBORDINADOS DE UN JEFE DE TIENDA
338
SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO,PC_PUESTOS.PC_DESC_PUESTO
FROM PC_PUESTOS_NIVEL, PC_PUESTOS
WHERE PC_PUESTOS_NIVEL.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
AND PC_PUESTOS.PC_CVE_PUESTO <> 2
START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = 2
CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO = PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP
ORDER BY 1;
--QUERY PARA TRAERME EL JEFE DE TIENDA EN CASO DE EXISTIR
339
SELECT a.PC_CVE_PTOVENTAS, a.PC_NOM_PTOVENTAS, c.PC_NOM_VENDEDOR || '' '' || c.PC_APE_PATERNO
	   || '' '' || c.PC_APE_MATERNO PC_NOMBRE_VENDEDOR, d.PC_DESC_PUESTO,
	   c.PC_CVE_VENDEDOR
FROM PC_PUNTO_VENTAS a, PC_INTER_VENDEDORES_PTOVENTAS b, PC_VENDEDORES c, PC_PUESTOS d
WHERE a.PC_CVE_PTOVENTAS = b.PC_CVE_PTOVENTAS
and b.PC_CVE_VENDEDOR = c.PC_CVE_VENDEDOR
and c.PC_CVE_PUESTO = d.PC_CVE_PUESTO
and d.PC_CVE_PUESTO = 2
AND (NVL(b.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (NVL(c.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (NVL(a.PC_STATUS,''ALTA'') <> ''BAJA'')
and a.pc_cve_ptoventas = ''{0}'';
--QUERY PARA TRAERME TODAS LAS TIENDAS QUE TIENEN VENDEDORES
341
select DISTINCT pc_punto_ventas.PC_CVE_PTOVENTAS, PC_CVE_REFERENCIA, pc_punto_ventas.PC_CVE_CANAL, PC_CVE_REGION,
			    PC_NOM_PTOVENTAS, PC_CNTL_INT, PC_CIUDAD, PC_ESTADO, PC_CP, PC_TEL, PC_FAX,
			    PC_DIRECCION, PC_COLONIA, PC_CVE_DIV, PC_CVE_SUBDIV, PC_DIG_VERIF, PC_PUNTO_VENTAS.PC_STATUS
			    ,PC_CANAL.PC_DESC_CANAL, PC_TIPO_CANAL.PC_DESC_TP_CANAL
FROM PC_PUNTO_VENTAS, PC_INTER_VENDEDORES_PTOVENTAS, PC_CANAL, PC_TIPO_CANAL
where (NVL(PC_PUNTO_VENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
and (PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL)
and (PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL)
AND (NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
<%0!=null AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {0}) 0!=null%>
<%1!=null AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {1}) 1!=null%>
<%2!=null AND ( PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {2}) 2!=null%>
ORDER BY PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS;
-- Query para generar reporte Punto de Venta
342
SELECT a.PC_CVE_VENDEDOR,
	   b.PC_CVE_PTOVENTAS,
	   b.PC_NOM_PTOVENTAS,
	   b.PC_CVE_CANAL,
	   b.PC_CVE_REGION,
	   b.PC_CVE_REFERENCIA,
	   b.PC_DESC_CANAL,
	   b.PC_CVE_TP_CANAL,
	   b.PC_DESC_TP_CANAL,
	   b.PC_DESC_REGION
FROM
(
SELECT LEVEL AS NIVEL, ROWNUM AS REGISTRO, PC_VENDEDORES.PC_CVE_VENDEDOR
FROM PC_VENDEDORES
WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) a,
(
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND (NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
) b
WHERE a.PC_CVE_VENDEDOR = b.PC_CVE_VENDEDOR(+)
ORDER BY b.PC_CVE_VENDEDOR;
--Query para traerme los datos del Punto de Venta que existe en PVS
343
SELECT CDG_CSI	PC_CVE_PTOVENTAS, CDG_REGION PC_CVE_REGION, DESC_CSI PC_NOM_PTOVENTAS,
				CIUDAD_CSI PC_CIUDAD, ESTADO_CSI PC_ESTADO, CP_CSI PC_CP, TELEFONO_CSI PC_TEL,
				FAX_CSI	PC_FAX, CALLE_CSI PC_DIRECCION, COLONIA_CSI	PC_COLONIA
FROM CAT_CSI
WHERE CDG_CSI = ''{0}'';
--QUERY PARA TRAERME UN PUESTO QUE PUEDE SER REPETIDO EN UNA TIENDA
344
SELECT PC_CVE_PUESTO
FROM PC_VENDEDORES, PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS
WHERE PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR
AND PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS
AND ((NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA''))
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND PC_VENDEDORES.PC_CVE_VENDEDOR =  {0}
AND PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL, PC_PUESTOS
	WHERE PC_PUESTOS_NIVEL.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	AND PC_PUESTOS.PC_CVE_PUESTO <> 28
	and PC_PUESTOS.PC_CVE_PUESTO <> 52
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = 2
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO = PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP);
---------Query para traerme vendedores ordenados por nivel, pc_cve_superior, pc_cve_puesto
345
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   PC_VENDEDORES.PC_CVE_EMP_REF,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
   	   PC_VENDEDORES.PC_CVE_SUPERIOR,
       (SELECT superior.PC_APE_PATERNO || '' '' ||
	           superior.PC_APE_MATERNO  || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
		(SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	    (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = {0}) PC_DESC_DIV
FROM PC_VENDEDORES
WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
order by nivel, pc_vendedores.pc_cve_superior, pc_vendedores.pc_cve_puesto;
---query para modificar el rol de un usuario
346
UPDATE CATVEN.PC_ROLES_DIV SET PC_CVE_ROL={2}, PC_CVE_DIV={3}, PC_CVE_SUBDIV={3}  WHERE PC_ROLES_DIV.PC_CVE_ROL_DIV = {0};
---QUERY PARA TRAERME LOS ROLES DEL USUARIO SIN IMPORTAR SI ESTAN BLOQUEDOS O NO
347
SELECT DISTINCT PC_LOGIN.PC_USERID,
       PC_LOGIN.PC_NOMBRE_CUENTA,
 	   PC_ROLES_DIV.PC_CVE_ROL,
 	   PC_LOGIN.PC_CVE_USUARIO
FROM CATVEN.PC_LOGIN , CATVEN.PC_ROLES_DIV
WHERE ( (PC_LOGIN.PC_USERID = PC_ROLES_DIV.PC_USERID)
AND (PC_LOGIN.PC_USERID = ''{0}''));
---QUERY PARA TRAERME LOS ROLES DEL USUARIO SIN IMPORTAR SI ESTAN BLOQUEDOS O NO
349
INSERT INTO PC_BIT_USUARIO(PC_USERID, PC_FCH_TRANSACCION, PC_TRANSACCION)
VALUES(''{0}'',SYSDATE,''{1}'');

351
select max(PC_FCH_acceso)as fecha from CATVEN.pc_log_acceso
where PC_USERID = ''{0}'';


352
Update CATVEN.PC_LOGIN set PC_ISBLOCKED = '1'  where PC_USERID = ''{0}'';



353
select count(*)as clave from CATVEN.pc_login where pc_cambia_password = '1' and PC_USERID = ''{0}'';


354
UPDATE CATVEN.PC_LOGIN set PC_PASSWORD = ''{1}'' where PC_USERID = ''{0}'';


355
UPDATE CATVEN.PC_LOGIN set PC_CAMBIA_PASSWORD = '0' where PC_USERID = ''{0}'';

356
select count(*)as clave from CATVEN.PC_LOGIN where PC_ISBLOCKED = '1' and PC_USERID = ''{0}'';

357
SELECT count(*) as clave FROM CATVEN.PC_LOGIN WHERE (TRUNC(PC_EXPIRATIONDATE)) <=TRUNC(SYSDATE) and  PC_USERID = ''{0}'';
,
	   PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD
FROM PC_VENDEDORES
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {0}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)) ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query para generar la tabla de Puntos de Venta
2
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV
FROM PC_PUNTO_VENTAS
WHERE PC_PUNTO_VENTAS.PC_CVE_SUBDIV={0};
-- Query para obtener Regiones
3
SELECT PC_REGION.PC_CVE_REGION PC_CVE_REGION,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION
FROM PC_REGION;
-- Query para obtener los datos de un vendedor
4
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
       PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA,
	   PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND ((PC_VENDEDORES.PC_CVE_VENDEDOR = {0}))
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
); --query modificado  OR PC_VENDEDORES.PC_CVE_EMP_REF=''{0}''
-- Query para obtener los Puntos de Venta por clave y por division
5
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
       PC_PUNTO_VENTAS.PC_CIUDAD PC_CIUDAD,
	   PC_PUNTO_VENTAS.PC_ESTADO PC_ESTADO,
	   PC_PUNTO_VENTAS.PC_STATUS PC_STATUS,
	   PC_PUNTO_VENTAS.PC_DIG_VERIF PC_DIG_VERIF,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_REGION , PC_TIPO_CANAL , PC_CANAL, PC_SUBDIVISION
WHERE ( (PC_REGION.PC_CVE_REGION(+) = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = ''{0}'')
AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {1})
AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {2}));-- OR PC_PUNTO_VENTAS.PC_CVE_REFERENCIA = ''{0}''
-- Query para obtener lista de Vendedores por Puesto
6
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO
FROM PC_VENDEDORES
WHERE ( (PC_VENDEDORES.PC_CVE_PUESTO = {0})
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE (((PC_VENDEDORES.PC_CVE_SUBDIV = {1})OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para obtener los movimientos por activaciones detalle total para un empresario
7
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO
FROM PC_VENDEDORES
WHERE ( (PC_VENDEDORES.PC_CVE_REGION = ''{0}'') );
-- Query para obtener los movimientos por renovaciones para un empresario
8
SELECT PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL
FROM PC_TIPO_CANAL ;
-- Query para obtener los movimientos por residuales para un empresario
9
SELECT PC_CANAL.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL
FROM PC_CANAL , PC_TIPO_CANAL
WHERE ( (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL) AND
(PC_TIPO_CANAL.PC_CVE_TP_CANAL = ''{0}'') )
ORDER BY PC_DESC_CANAL;
-- Query para obtener los movimientos por servicios activaciones para un empresario
10
INSERT INTO PC_VENDEDORES (
			PC_CVE_VENDEDOR, PC_CVE_PUESTO,  PC_CVE_SUPERIOR,
 			PC_NOM_VENDEDOR, PC_APE_PATERNO, PC_APE_MATERNO,
 			PC_FCH_ALTA, 	 PC_DIG_VERIF,   PC_CNTR_TDA,
 			PC_STATUS,       PC_CVE_EMP_REF, PC_CIUDAD,
 			PC_ESTADO,       PC_DIRECCION,   PC_COLONIA,
            PC_CP,           PC_TEL,         PC_FAX,
            PC_COMISIONAR,   PC_CVE_SUP_CAD, PC_CVE_SUBDIV, PC_CVE_EMPRESA)
 VALUES ({0},{1},{2},''{3}'',''{4}'',''{5}'',TO_DATE(''{6}'',''DD/MM/YYYY''),{7},''{8}'',''{9}'',''{10}'',''{11}'',''{12}'',''{13}'',''{14}'',''{15}'',''{16}'',''{17}'',''S'',{18},{19}, {20});
-- Query para insertar en tabla punto de ventas
11
INSERT INTO PC_PUNTO_VENTAS (
            PC_CVE_PTOVENTAS, PC_CVE_REFERENCIA, PC_CVE_CANAL,
            PC_NOM_PTOVENTAS, PC_CNTL_INT,       PC_CVE_DIV,
            PC_CVE_SUBDIV,    PC_DIRECCION,      PC_COLONIA,
            PC_CP,            PC_TEL,            PC_FAX,
            PC_CIUDAD, 		  PC_ESTADO,		 PC_DIG_VERIF,
            PC_STATUS)
VALUES(''{0}'',''{1}'',''{2}'',
		''{3}'',''{4}'',(SELECT PC_CVE_DIV FROM PC_SUBDIVISION WHERE PC_CVE_SUBDIV = {5}),
		''{5}'',''{6}'',''{7}'',
		''{8}'',''{9}'',''{10}'',
		''{11}'', ''{12}'', ''{13}'', ''ALTA'');
-- Query para obtener los puntos de venta dado un canal en especifico
12
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS
FROM PC_PUNTO_VENTAS
WHERE ( (PC_PUNTO_VENTAS.PC_CVE_CANAL = ''{0}'')
AND ( PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {1})
AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {2}));
-- Query para actualizar punto de venta
13
UPDATE PC_PUNTO_VENTAS SET
       PC_CVE_CANAL = ''{1}'',
       PC_CVE_REGION = ''{2}'',
       PC_NOM_PTOVENTAS = ''{3}'',
       PC_CVE_REFERENCIA = ''{4}'',
       PC_CNTL_INT = ''{5}'',
       PC_CVE_SUBDIV = ''{6}'',
       PC_CVE_DIV = ''{6}'',
       PC_DIRECCION = ''{7}'',
       PC_COLONIA = ''{8}'',
       PC_CP = ''{9}'',
       PC_TEL = ''{10}'',
       PC_FAX = ''{11}'',
       PC_CIUDAD = ''{12}'',
       PC_ESTADO = ''{13}''
WHERE (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = ''{0}'');
-- Query para obtener los movimientos por charge back renovaciones para un empresario
14
UPDATE PC_VENDEDORES SET
       PC_CVE_PUESTO = {1},
       PC_CVE_SUPERIOR = {2},
       PC_NOM_VENDEDOR = ''{3}'',
       PC_APE_PATERNO = ''{4}'',
       PC_APE_MATERNO = ''{5}'',
       PC_CNTR_TDA = ''{6}'',
       PC_CVE_EMP_REF = ''{7}'',
       PC_CIUDAD = ''{8}'',
       PC_ESTADO= ''{9}'',
       PC_DIRECCION= ''{10}'',
       PC_COLONIA= ''{11}'',
       PC_CP= ''{12}'',
       PC_TEL= ''{13}'',
       PC_FAX= ''{14}'',
       PC_FCH_ALTA= TO_DATE(''{15}'',''DD/MM/YYYY''),
       PC_CVE_SUP_CAD = {16},
       PC_CVE_SUBDIV = {17}, PC_CVE_EMPRESA={18}
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR = {0});
-- Query para obtener los movimientos por bono por volumen para un empresario
15
INSERT INTO PC_REGION (PC_CVE_REGION, PC_DESC_REGION) VALUES (''{0}'',''{1}'');
-- Query para obtener los movimientos por bono por volumen para un empresario
16
UPDATE PC_REGION SET PC_DESC_REGION=''{1}'' WHERE PC_CVE_REGION=''{0}'';
-- Query para obtener los movimientos por residuales de telefonia publica pospago para un empresario
17
DELETE FROM PC_REGION WHERE PC_CVE_REGION=''{0}'';
-- Query para obtener los movimientos por bajas de telefonia publica pospago para un empresario
18
INSERT INTO PC_PUESTOS (PC_CVE_PUESTO , PC_DESC_PUESTO)  VALUES ({0},''{1}'');
-- Query para obtener los movimientos por activaciones prepago para un empresario
19
UPDATE PC_PUESTOS SET
       PC_DESC_PUESTO =''{1}''
WHERE PC_CVE_PUESTO = {0};
-- Query para obtener los movimientos por activaciones prepago para un empresario
20
DELETE FROM PC_PUESTOS
WHERE PC_CVE_PUESTO = {0};
-- Query para generar la tabla de distribuidores asociando su comisión para un periodo específico
21
SELECT PC_PUESTOS.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO
FROM PC_PUESTOS
ORDER BY PC_DESC_PUESTO;
-- Query para obtener los movimientos por activaciones telefonia publica prepago para un empresario
22
SELECT NVL((MAX(PC_CVE_PUESTO)+1),0) CLAVE FROM PC_PUESTOS;
-- Query para obtener el resumen del bono por cumplimiento de cuota
23
SELECT NVL((MAX(TO_NUMBER(PC_CVE_REGION))+1),0) CLAVE FROM PC_REGION;
-- Testing Catalogo de Puestos
24
SELECT PC_PUESTOS.PC_CVE_PUESTO AS PC_CVE_PUESTO,
       PC_PUESTOS.PC_DESC_PUESTO AS PC_DESC_PUESTO
FROM PC_PUESTOS;
-- Query para obtener la tabla de comisiones para las renovaciones
25
INSERT INTO PC_CANAL (PC_CVE_CANAL, PC_DESC_CANAL, PC_CVE_TP_CANAL)
VALUES (''{0}'',''{1}'',''{2}'');
-- Query para obtener la tabla de comisiones para las renovaciones
26
UPDATE PC_CANAL SET
       PC_DESC_CANAL=''{1}'',
       PC_CVE_TP_CANAL=''{2}''
WHERE PC_CVE_CANAL=''{0}'';
-- Query para obtener la tabla de comisiones para las renovaciones
27
DELETE FROM PC_CANAL WHERE PC_CVE_CANAL=''{0}'';
-- Query para obtener la tabla de comisiones para las renovaciones
28
SELECT NVL((MAX(TO_NUMBER(PC_CVE_CANAL))+1),0) CLAVE FROM PC_CANAL;
-- Query para obtener la tabla de comisiones para las renovaciones
29
INSERT INTO PC_TIPO_CANAL (PC_CVE_TP_CANAL, PC_DESC_TP_CANAL)
VALUES (''{0}'',''{1}'');
-- Query para obtener la tabla de comisiones para las renovaciones
30
UPDATE PC_TIPO_CANAL SET
       PC_DESC_TP_CANAL=''{1}''
WHERE PC_CVE_TP_CANAL=''{0}'';
-- Query para obtener la tabla de comisiones para las renovaciones
31
DELETE FROM PC_TIPO_CANAL
WHERE PC_CVE_TP_CANAL=''{0}'';
-- Query para obtener la tabla de comisiones para las renovaciones
32
SELECT NVL((MAX(TO_NUMBER(PC_CVE_TP_CANAL))+1),0) CLAVE FROM PC_TIPO_CANAL;
-- Query para obtener la nota del bono por cumplimiento de cuota
33
SELECT PC_CANAL.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL
FROM PC_CANAL
<%0!=null , PC_TIPO_CANAL WHERE ( (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL) AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = ''{0}'') ) 0!=null%>
ORDER BY PC_CANAL.PC_DESC_CANAL ASC;
-- Query para obtener Puntos de Venta por Region
34
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
	   PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
	   PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
	   PC_PUNTO_VENTAS.PC_DIRECCION PC_DIRECCION,
	   PC_PUNTO_VENTAS.PC_COLONIA PC_COLONIA,
	   PC_PUNTO_VENTAS.PC_CP PC_CP,
	   PC_PUNTO_VENTAS.PC_TEL PC_TEL,
	   PC_PUNTO_VENTAS.PC_FAX PC_FAX,
	   PC_PUNTO_VENTAS.PC_CIUDAD PC_CIUDAD,
	   PC_PUNTO_VENTAS.PC_ESTADO PC_ESTADO,
	   PC_PUNTO_VENTAS.PC_STATUS PC_STATUS,
	   PC_PUNTO_VENTAS.PC_DIG_VERIF PC_DIG_VERIF,
	   PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
	   PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
	   PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV,
	   NULL PC_JEFE_TIENDA
FROM PC_PUNTO_VENTAS, PC_CANAL, PC_TIPO_CANAL, PC_SUBDIVISION
WHERE( (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
<%0!=null AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {0}) 0!=null%>
<%4!=0 AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {4}) 4!=0%>
<%1!=null AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = ''{1}'') 1!=null%>
<%2!=null AND (PC_PUNTO_VENTAS.PC_CVE_CANAL = ''{2}'') 2!=null%>
<%3!=null AND (UPPER(PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS) like UPPER(''%{3}%'')) 3!=null%>
)
AND PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS NOT IN (
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS
FROM PC_PUNTO_VENTAS, PC_CANAL, PC_TIPO_CANAL, PC_SUBDIVISION, PC_VENDEDORES, PC_INTER_VENDEDORES_PTOVENTAS, PC_PUESTOS
WHERE ((PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS)
AND (NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_PUESTO = '2')
<%0!=null AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {0}) 0!=null%>
<%4!=0 AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {4}) 4!=0%>
<%1!=null AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = ''{1}'') 1!=null%>
<%2!=null AND (PC_PUNTO_VENTAS.PC_CVE_CANAL = ''{2}'') 2!=null%>
<%3!=null AND (UPPER(PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS) like UPPER(''%{3}%'')) 3!=null%>
))
UNION ALL
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
PC_PUNTO_VENTAS.PC_DIRECCION PC_DIRECCION,
PC_PUNTO_VENTAS.PC_COLONIA PC_COLONIA,
PC_PUNTO_VENTAS.PC_CP PC_CP,
PC_PUNTO_VENTAS.PC_TEL PC_TEL,
PC_PUNTO_VENTAS.PC_FAX PC_FAX,
PC_PUNTO_VENTAS.PC_CIUDAD PC_CIUDAD,
PC_PUNTO_VENTAS.PC_ESTADO PC_ESTADO,
PC_PUNTO_VENTAS.PC_STATUS PC_STATUS,
PC_PUNTO_VENTAS.PC_DIG_VERIF PC_DIG_VERIF,
PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV,
PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
PC_VENDEDORES.PC_APE_MATERNO PC_JEFE_TIENDA
FROM PC_PUNTO_VENTAS , PC_CANAL , PC_TIPO_CANAL , PC_SUBDIVISION, PC_VENDEDORES, PC_INTER_VENDEDORES_PTOVENTAS, PC_PUESTOS
WHERE( (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_PUESTO = '2')
<%0!=null AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {0}) 0!=null%>
<%4!=0 AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {4}) 4!=0%>
<%1!=null AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = ''{1}'') 1!=null%>
<%2!=null AND (PC_PUNTO_VENTAS.PC_CVE_CANAL = ''{2}'') 2!=null%>
<%3!=null AND (UPPER(PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS) like UPPER(''%{3}%'')) 3!=null%>
)ORDER BY PC_NOM_PTOVENTAS;
-- Query para obtener la siguiente clave disponible en la Tabla de Puntos de Venta
35
SELECT SEQ_PC_PUNTO_VENTAS.NEXTVAL AS CLAVE FROM DUAL;
-- Query para obtener la siguiente clave disponible en la Tabla de Puntos de Venta
--DELETE FROM PC_PUNTO_VENTAS WHERE (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = ''{0}'');//original
36
UPDATE PC_PUNTO_VENTAS SET PC_STATUS=''BAJA''
WHERE (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = ''{0}'');
-- Query para obtener la siguiente clave disponible en la Tabla de Puntos de Venta
37
DELETE FROM PC_VENDEDORES
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR = {0});
-- Query para obtener la siguiente clave disponible en la Tabla de Puntos de Venta
38
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {3}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para obtener la siguiente clave disponible en la Tabla de Vendedores
39
SELECT NVL((MAX(PC_CVE_VENDEDOR)+1),0) CLAVE FROM PC_VENDEDORES;
-- Query para obtener la siguiente clave disponible en la Tabla de Vendedores
40
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {0}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
));
-- Query para Relaciones entre Vendedores y Puntos de Venta
41
INSERT INTO PC_INTER_VENDEDORES_PTOVENTAS
           (PC_CVE_INTER,     PC_CVE_VENDEDOR,
            PC_CVE_PTOVENTAS, PC_FCH_MOVIMIENTO,
            PC_CVE_USUARIO,   PC_CVE_AUTORIZA, PC_FCH_INICIO, PC_STATUS)
VALUES ({0},{1},''{2}'',TO_DATE(''{3}'',''DD/MM/YYYY''),{4},{5}, TO_DATE(''{6}'',''DD/MM/YYYY HH24:MI:SS''), ''ALTA'');
-- Query para Actualizar Relaciones entre Vendedores y Puntos de Venta
42
UPDATE PC_INTER_VENDEDORES_PTOVENTAS SET
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {1}
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{2}''
WHERE (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER = {0});
-- Query para Eliminar Relaciones entre Vendedores y Puntos de Venta 43 DELETE FROM PC_INTER_VENDEDORES_PTOVENTAS WHERE (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER = {0});
43
UPDATE PC_INTER_VENDEDORES_PTOVENTAS SET
       PC_INTER_VENDEDORES_PTOVENTAS.PC_FCH_FIN =TO_DATE(''{1}'',''DD/MM/YYYY HH24:MI:SS''),
       PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS = ''BAJA'',
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_USUARIO = {2},
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_AUTORIZA = {2}
WHERE (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER = {0});
-- Query para Relaciones entre Vendedores y Puntos de Venta
44
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_PUNTO_VENTAS , PC_CANAL , PC_VENDEDORES
WHERE ( (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
<%0!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {0}) 0!=null%>
<%1!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{1}'') 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {3}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para Relaciones entre Vendedores y Puntos de Venta
45
SELECT NVL((MAX(PC_CVE_INTER)+1),0) CLAVE FROM PC_INTER_VENDEDORES_PTOVENTAS;
-- Query para Relaciones entre Vendedores y Puntos de Venta
46
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_FCH_MOVIMIENTO PC_FCH_MOVIMIENTO,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_USUARIO PC_CVE_USUARIO,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_AUTORIZA PC_CVE_AUTORIZA
FROM PC_INTER_VENDEDORES_PTOVENTAS
WHERE (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {0})OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
));
-- Query para Relaciones entre Vendedores y Puntos de Venta
47
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_VENDEDORES
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{0}'')
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para Relaciones entre Vendedores y Puntos de Venta
48
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_PUNTO_VENTAS , PC_CANAL
WHERE ( (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
 AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
 AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {0})
 AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR IN (
 	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para Relaciones entre Vendedores y Puntos de Venta
49
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_FCH_MOVIMIENTO PC_FCH_MOVIMIENTO,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_VENDEDORES , PC_PUNTO_VENTAS , PC_CANAL
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND ((NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA''))
<%0!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{0}'') 0!=null%>
<%1!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {1}) 1!=null%>
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {3}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para obtener Regiones
50
SELECT PC_DIVISION.PC_CVE_DIV PC_CVE_DIV,
       PC_DIVISION.PC_DESC_DIV PC_DESC_DIV
FROM PC_DIVISION
<%0!=0 WHERE PC_DIVISION.PC_CVE_DIV = {0} 0!=0%>;
-- Query para obtener los movimientos por bono por volumen para un empresario
51
INSERT INTO PC_DIVISION (PC_CVE_DIV, PC_DESC_DIV, PC_CVE_VENDEDOR) VALUES ({0},''{1}'',{0});
-- Query para obtener los movimientos por bono por volumen para un empresario
52
UPDATE PC_DIVISION SET PC_DESC_DIV=''{1}'' WHERE PC_CVE_DIV={0};
-- Query para obtener los movimientos por residuales de telefonia publica pospago para un empresario
53
DELETE FROM PC_DIVISION WHERE PC_CVE_DIV={0};
-- Query para obtener el resumen del bono por cumplimiento de cuota
54
SELECT NVL((MAX(PC_CVE_DIV)+1),0) CLAVE FROM PC_DIVISION;
-- Query para obtener la siguiente clave disponible en la Tabla de Vendedores
55
SELECT NVL((MAX(PC_CVE_VENDEDOR)+1),0) CLAVE FROM PC_VENDEDORES WHERE PC_CVE_VENDEDOR LIKE ''3%'';
-- Query para obtener la siguiente clave disponible en la Tabla de Vendedores
56
SELECT NVL((MAX(PC_CVE_VENDEDOR)+1),0) CLAVE FROM PC_VENDEDORES WHERE PC_CVE_VENDEDOR LIKE ''5%'';
-- Query para obtener la siguiente clave disponible en la Tabla de Vendedores
57
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR ||'' ''||
       PC_VENDEDORES.PC_APE_PATERNO  ||'' ''||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES , PC_PUESTOS , PC_PUESTOS PUESTO
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO(+) = PC_VENDEDORES.PC_CVE_PUESTO)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PUESTO.PC_NIVEL < PC_PUESTOS.PC_NIVEL)
<%0>0 AND (PUESTO.PC_CVE_PUESTO = {0}) 0>0%>
);
-- Query para obtener los movimientos por renovaciones para un empresario
58
SELECT PC_TIPO_CANAL.PC_CVE_TP_CANAL, PC_TIPO_CANAL.PC_DESC_TP_CANAL
FROM PC_TIPO_CANAL , PC_CANAL
WHERE ( (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL) )
GROUP BY PC_TIPO_CANAL.PC_CVE_TP_CANAL , PC_TIPO_CANAL.PC_DESC_TP_CANAL
ORDER BY PC_DESC_TP_CANAL;
-- Query para "eliminar" un vendedor de la tabla
59
UPDATE PC_VENDEDORES SET
       PC_STATUS = ''BAJA'',
       PC_FCH_BAJA = TO_DATE(''{1}'',''DD/MM/YYYY'')
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR = {0});
-- Query cambiar la asignacion de los vendedores con un superior que ha sido eliminado
60
UPDATE PC_VENDEDORES SET
       PC_CVE_SUPERIOR = {1},
       PC_CVE_SUP_CAD = NULL
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR = {0});
-- Query para obtener el organigrama hacia abajo
61
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_PUESTOS.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE(PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO)) PC_DESC_PUESTO
FROM PC_VENDEDORES
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR;
-- Query para obtener el organigrama hacia arriba para vendedores
62
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_PUESTOS.PC_CVE_PUESTO,
   	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE(PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO)) PC_DESC_PUESTO
FROM PC_VENDEDORES
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1})OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR  PC_VENDEDORES.PC_CVE_SUPERIOR = PC_VENDEDORES.PC_CVE_VENDEDOR;
-- Query para obtener el organigrama hacia arriba para vendedores
63
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
	   PC_VENDEDORES.PC_NOM_VENDEDOR ||'' ''||
       PC_VENDEDORES.PC_APE_PATERNO  ||'' ''||
       PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
	   PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
	   PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
	   PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
	   PC_DIVISION.PC_DESC_DIV PC_DESC_DIV
	   PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS, PC_PUESTOS, PC_VENDEDORES, PC_DIVISION, PC_SUBDIVISION, PC_INTER_VENDEDORES_PTOVENTAS
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_DIVISION.PC_CVE_DIV = PC_PUNTO_VENTAS.PC_CVE_DIV)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NULL) AND (PC_SUBDIVISION.PC_CVE_SUBDIV = {0})) ;
-- Query para obtener el organigrama hacia arriba para vendedores
64
SELECT NVL((MAX(PC_CVE_BIT_MOVIMIENTOS)+1),0) CLAVE FROM PC_BIT_MOVIMIENTOS;
-- Query para obtener el organigrama hacia arriba para vendedores
65
INSERT INTO PC_BIT_MOVIMIENTOS(PC_CVE_BIT_MOVIMIENTOS,
                               PC_CVE_VENDEDOR,
                               PC_CVE_SUPERIOR_ORIGEN,
                               PC_CVE_SUPERIOR_DESTINO,
                               PC_CVE_USUARIO,
                               PC_CVE_AUTORIZA,
                               PC_FCH_MOVIMIENTO,
                               PC_FCH_TRANSACCION )
VALUES ({0},{1},{2},{3},{4},{5},TO_DATE(''{6}'',''DD/MM/YYYY''),SYSDATE);
-- Query para dar de "ALTA" a un vendedor de la tabla
310
UPDATE PC_VENDEDORES SET
       PC_STATUS = ''ALTA'',
       PC_FCH_ALTA = TO_DATE(''{1}'',''DD/MM/YYYY''),
       PC_FCH_BAJA = ''''
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR = {0});
--  PC_FCH_ALTA = TO_DATE(''{1}'',''DD/MM/YYYY'')

-- Query para insertar un movimiento de cambio de STATUS
311
INSERT INTO PC_BIT_MOVIMIENTOS(PC_CVE_BIT_MOVIMIENTOS,
                               PC_CVE_VENDEDOR,
                               PC_CVE_STATUS_ORIGEN,
                               PC_CVE_STATUS_DESTINO,
                               PC_FCH_MOVIMIENTO,
                               PC_FCH_TRANSACCION,
                               PC_CVE_USUARIO,
                               PC_CVE_AUTORIZA
                                )
VALUES ({0},{1},''{2}'',''{3}'',TO_DATE(''{4}'',''DD/MM/YYYY''),SYSDATE,''{5}'',''{6}'');
-- Query para obtener el organigrama hacia arriba para vendedores
66
INSERT INTO PC_BIT_MOVIMIENTOS(PC_CVE_BIT_MOVIMIENTOS,
                               PC_CVE_VENDEDOR,
                               PC_CVE_PUESTO_ORIGEN,
                               PC_CVE_PUESTO_DESTINO,
                               PC_CVE_USUARIO,
                               PC_CVE_AUTORIZA,
                               PC_FCH_MOVIMIENTO,
                               PC_FCH_TRANSACCION )
VALUES ({0},{1},{2},{3},{4},{5},TO_DATE(''{6}'',''DD/MM/YYYY''),SYSDATE);
-- Query para obtener el organigrama hacia arriba para vendedores
67
INSERT INTO PC_BIT_MOVIMIENTOS(PC_CVE_BIT_MOVIMIENTOS,
                               PC_CVE_VENDEDOR,
                               PC_CVE_PTOVENTAS_ORIGEN,
                               PC_CVE_PTOVENTAS_DESTINO,
                               PC_CVE_USUARIO,
                               PC_CVE_AUTORIZA,
                               PC_FCH_MOVIMIENTO,
                               PC_FCH_TRANSACCION )
VALUES ({0},{1},''{2}'',''{3}'',{4},{5},TO_DATE(''{6}'',''DD/MM/YYYY''),SYSDATE);
-- Query para obtener el organigrama hacia arriba para vendedores
68
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUP_CAD
FROM PC_VENDEDORES
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = {0})
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para obtener el organigrama hacia arriba para vendedores
69
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS
FROM PC_INTER_VENDEDORES_PTOVENTAS
WHERE ((PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {0})
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para obtener el organigrama hacia arriba para vendedores
70
INSERT INTO PC_BIT_MOVIMIENTOS(PC_CVE_BIT_MOVIMIENTOS,
                               PC_CVE_VENDEDOR,
                               PC_CVE_SUPERIOR_ORIGEN,
                               PC_CVE_SUPERIOR_DESTINO,
                               PC_CVE_PUESTO_ORIGEN,
                               PC_CVE_PUESTO_DESTINO,
                               PC_CVE_USUARIO,
                               PC_CVE_AUTORIZA,
                               PC_FCH_MOVIMIENTO,
                               PC_FCH_TRANSACCION )
VALUES ({0},{1},{2},{3},{4},{5},{6},{7},TO_DATE(''{8}'',''DD/MM/YYYY''),SYSDATE);
-- Query para obtener un puesto en particular
71
SELECT PC_PUESTOS.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO
FROM PC_PUESTOS
WHERE PC_CVE_PUESTO = {0};
-- Query para obtener Puntos de Venta por Region
72
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_CANAL , PC_TIPO_CANAL , PC_REGION, PC_SUBDIVISION
WHERE ( (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_REGION.PC_CVE_REGION = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_PUNTO_VENTAS.PC_CVE_REGION = {0})
AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {1})
AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {2}) );
-- Query para obtener Puntos de Venta por Region
73
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_CANAL , PC_TIPO_CANAL , PC_REGION, PC_SUBDIVISION
WHERE  (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_REGION.PC_CVE_REGION(+) = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {0})
AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {1});
-- Query para Reasignar Superiores en PC_VENDEDORES
74
UPDATE PC_VENDEDORES SET PC_VENDEDORES.PC_CVE_SUPERIOR = (
	   SELECT PC_VENDEDORES.PC_CVE_SUPERIOR
	   FROM PC_VENDEDORES
	   WHERE PC_VENDEDORES.PC_CVE_VENDEDOR= {0})
WHERE PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	  SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	  FROM PC_VENDEDORES
	  WHERE PC_VENDEDORES.PC_CVE_SUPERIOR= {0}
);
-- Query para Reasignar Superiores en PC_VENDEDORES
75
SELECT PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR
FROM PC_BIT_MOVIMIENTOS
WHERE ( (PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR = {0})
AND (PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para Reasignar Superiores en PC_VENDEDORES
76
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES, PC_PUESTOS
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO(+) = PC_VENDEDORES.PC_CVE_PUESTO)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {0})
<%2!=0
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)) 2!=0%>
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {0}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
)))
ORDER BY PC_NOMBRE_VENDEDOR;
-- Query para Reasignar Superiores en PC_VENDEDORES
77
SELECT LEVEL NIVEL,
       PC_PUESTOS_NIVEL.PC_CVE_PUESTO PC_CVE_PUESTO,
       (SELECT PC_PUESTOS.PC_DESC_PUESTO
       FROM PC_PUESTOS
       WHERE PC_PUESTOS.PC_CVE_PUESTO = PC_PUESTOS_NIVEL.PC_CVE_PUESTO)
       PC_DESC_PUESTO
FROM PC_PUESTOS_NIVEL
START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {0}
CONNECT BY PRIOR  PC_PUESTOS_NIVEL.PC_CVE_PUESTO = PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP;
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
78
SELECT PC_CVE_PUESTO CLAVE FROM PC_PUESTOS_NIVEL WHERE PC_CVE_PUESTO_SUP IS NULL;
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
79
INSERT INTO PC_PUESTOS_NIVEL (PC_PUESTOS_NIVEL_ID, PC_CVE_PUESTO, PC_CVE_PUESTO_SUP)
VALUES ({0},{1},{2});
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
80
DELETE FROM PC_PUESTOS_NIVEL
WHERE (PC_CVE_PUESTO = {0}
AND PC_CVE_PUESTO_SUP = {1});
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
81
SELECT PC_PUESTOS_NIVEL_ID,
       PC_CVE_PUESTO,
       PC_CVE_PUESTO_SUP
FROM PC_PUESTOS_NIVEL
WHERE (PC_CVE_PUESTO = {0}
AND PC_CVE_PUESTO_SUP = {1});
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
82
SELECT NVL((MAX(PC_PUESTOS_NIVEL_ID)+1),0) CLAVE FROM PC_PUESTOS_NIVEL;
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
83
SELECT PC_PUESTOS_NIVEL_ID,
       PC_CVE_PUESTO,
       PC_CVE_PUESTO_SUP
FROM PC_PUESTOS_NIVEL
WHERE (PC_CVE_PUESTO = {0});
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
84
UPDATE PC_PUESTOS_NIVEL
SET PC_CVE_PUESTO_SUP = {1}
WHERE (PC_PUESTOS_NIVEL_ID = {0});
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
85
SELECT PC_PUESTOS_NIVEL_ID,
       PC_CVE_PUESTO,
       PC_CVE_PUESTO_SUP
FROM PC_PUESTOS_NIVEL
WHERE (PC_CVE_PUESTO_SUP = {0});
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
86
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES , PC_PUESTOS
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO(+) = PC_VENDEDORES.PC_CVE_PUESTO)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {0})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {0}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%2!=0 AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)) 2!=0%>
)ORDER BY PC_NOMBRE_VENDEDOR;
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
87
INSERT INTO PC_VENDEDORES (PC_CVE_VENDEDOR, PC_CVE_PUESTO, PC_CVE_SUPERIOR, PC_NOM_VENDEDOR, PC_COMISIONAR) VALUES({0},0,NULL,''{1}'',''N'');
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
88
SELECT PC_CVE_VENDEDOR, PC_CVE_DIV , PC_DESC_DIV
FROM PC_DIVISION
WHERE PC_CVE_DIV = {0};
-- Query para Mapeos
89
INSERT INTO PC_MAPEO_VENDEDOR (PC_CVE_VENDEDOR, PC_SISTEMA, PC_CUSTOMER_ID, PC_CVE_REG_VENTA, PC_NOM_USUARIO)
VALUES ({0},''{1}'',{2},''{3}'',''{4}'');
-- Query para Mapeos
90
UPDATE PC_MAPEO_VENDEDOR SET PC_SISTEMA = ''{1}'',
	   					 	 PC_CUSTOMER_ID = {2},
							 PC_CVE_REG_VENTA = ''{3}'',
							 PC_NOM_USUARIO = ''{4}''
WHERE PC_CVE_VENDEDOR = {0}
AND PC_SISTEMA = ''{5}''
AND PC_CVE_REG_VENTA = ''{6}'';
-- Query para Mapeos
91
DELETE FROM PC_MAPEO_VENDEDOR
WHERE PC_CVE_VENDEDOR = {0}
AND PC_SISTEMA = ''{1}''
AND PC_CVE_REG_VENTA = ''{2}'';
-- Query para Mapeos
92
SELECT PC_MAPEO_VENDEDOR.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_MAPEO_VENDEDOR.PC_SISTEMA PC_SISTEMA,
	   PC_MAPEO_VENDEDOR.PC_CUSTOMER_ID PC_CUSTOMER_ID,
	   PC_MAPEO_VENDEDOR.PC_CVE_REG_VENTA PC_CVE_REG_VENTA,
	   PC_MAPEO_VENDEDOR.PC_NOM_USUARIO PC_NOM_USUARIO
FROM PC_MAPEO_VENDEDOR
WHERE ((PC_MAPEO_VENDEDOR.PC_CVE_VENDEDOR = {0})
AND (PC_MAPEO_VENDEDOR.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para añadir tiendas en reporte organigrama
93
SELECT a.REGISTRO, a.NIVEL, a.PC_CVE_VENDEDOR, a.PC_NOMBRE_VENDEDOR,
	   a.PC_FCH_ALTA,
	   a.PC_FCH_BAJA,
	   a.PC_DIG_VERIF,
	   a.PC_CIUDAD,
	   a.PC_ESTADO,		
	   a.PC_DIRECCION,	
	   a.PC_COLONIA,		
	   a.PC_CP,		
	   a.PC_TEL,		
	   a.PC_FAX,
	   a.PC_CVE_SUBDIV,
	   a.PC_CVE_PUESTO,
	   a.PC_DESC_PUESTO,
	   b.PC_CVE_PTOVENTAS,
	   b.PC_NOM_PTOVENTAS,
	   b.PC_CVE_CANAL,
	   b.PC_CVE_REGION,
	   b.PC_DESC_CANAL,
	   b.PC_CVE_TP_CANAL,
	   b.PC_DESC_TP_CANAL,
	   b.PC_DESC_REGION
FROM
(
SELECT LEVEL AS NIVEL, ROWNUM AS REGISTRO, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,
	   PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	   FROM PC_PUESTOS
	   WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO
FROM PC_VENDEDORES
WHERE (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) a,
(
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
) b
WHERE a.PC_CVE_VENDEDOR = b.PC_CVE_VENDEDOR(+)
ORDER BY REGISTRO;
-- Query para obtener un detalle de relacion
94
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_FCH_MOVIMIENTO PC_FCH_MOVIMIENTO,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_VENDEDORES , PC_PUNTO_VENTAS , PC_CANAL
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER = {0})
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para obtener la lista de movimientos
95
SELECT PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS,
       PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR,
       PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN,
	   PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO,
	   PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN,
	   PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO,
	   PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN,
	   PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO,
	   PC_BIT_MOVIMIENTOS.PC_FCH_MOVIMIENTO,
	   PC_BIT_MOVIMIENTOS.PC_FCH_TRANSACCION,
	   PC_PUNTO_VENTAS_ORIGEN.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_ORIGEN,
	   PC_PUNTO_VENTAS_DESTINO.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_DESTINO,
	   PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO  || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOM_COMP_VENDEDOR,
	   PC_SUPERIOR_ORIGEN.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR_ORIGEN.PC_APE_PATERNO  || '' '' ||
	   PC_SUPERIOR_ORIGEN.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_ORIGEN,
	   PC_SUPERIOR_DESTINO.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR_DESTINO.PC_APE_PATERNO  || '' '' ||
	   PC_SUPERIOR_DESTINO.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_DESTINO,
	   PC_PUESTOS_ORIGEN.PC_DESC_PUESTO PC_DESC_PUESTO_ORIGEN,
	   PC_PUESTOS_DESTINO.PC_DESC_PUESTO PC_DESC_PUESTO_DESTINO
FROM PC_BIT_MOVIMIENTOS , PC_VENDEDORES ,
PC_PUNTO_VENTAS PC_PUNTO_VENTAS_ORIGEN,
PC_PUNTO_VENTAS PC_PUNTO_VENTAS_DESTINO,
PC_VENDEDORES PC_SUPERIOR_ORIGEN,
PC_VENDEDORES PC_SUPERIOR_DESTINO,
PC_PUESTOS PC_PUESTOS_DESTINO,
PC_PUESTOS PC_PUESTOS_ORIGEN
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
AND (PC_PUNTO_VENTAS_ORIGEN.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN)
AND (PC_PUNTO_VENTAS_DESTINO.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO)
AND (PC_SUPERIOR_ORIGEN.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN)
AND (PC_SUPERIOR_DESTINO.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO)
AND (PC_PUESTOS_DESTINO.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO)
AND (PC_PUESTOS_ORIGEN.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN)
AND (ROWNUM < {0}))
ORDER BY PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS DESC;
-- Query para obtener la lista de movimientos por parametros
96
SELECT PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS,
       PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR,
       PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_FCH_MOVIMIENTO,
       PC_BIT_MOVIMIENTOS.PC_FCH_TRANSACCION,
       PC_PUNTO_VENTAS_ORIGEN.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_ORIGEN,
       PC_PUNTO_VENTAS_DESTINO.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_DESTINO,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
       PC_VENDEDORES.PC_APE_PATERNO  || '' '' ||
       PC_VENDEDORES.PC_APE_MATERNO PC_NOM_COMP_VENDEDOR,
       PC_SUPERIOR_ORIGEN.PC_NOM_VENDEDOR || '' '' ||
       PC_SUPERIOR_ORIGEN.PC_APE_PATERNO  || '' '' ||
       PC_SUPERIOR_ORIGEN.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_ORIGEN,
       PC_SUPERIOR_DESTINO.PC_NOM_VENDEDOR || '' '' ||
       PC_SUPERIOR_DESTINO.PC_APE_PATERNO  || '' '' ||
       PC_SUPERIOR_DESTINO.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_DESTINO,
       PC_PUESTOS_ORIGEN.PC_DESC_PUESTO PC_DESC_PUESTO_ORIGEN,
       PC_PUESTOS_DESTINO.PC_DESC_PUESTO PC_DESC_PUESTO_DESTINO
FROM PC_BIT_MOVIMIENTOS , PC_VENDEDORES ,
PC_PUNTO_VENTAS PC_PUNTO_VENTAS_ORIGEN,
PC_PUNTO_VENTAS PC_PUNTO_VENTAS_DESTINO,
PC_VENDEDORES PC_SUPERIOR_ORIGEN,
PC_VENDEDORES PC_SUPERIOR_DESTINO,
PC_PUESTOS PC_PUESTOS_DESTINO,
PC_PUESTOS PC_PUESTOS_ORIGEN
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {3}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {4}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
AND (PC_PUNTO_VENTAS_ORIGEN.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN)
AND (PC_PUNTO_VENTAS_DESTINO.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO)
AND (PC_SUPERIOR_ORIGEN.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN)
AND (PC_SUPERIOR_DESTINO.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO)
AND (PC_PUESTOS_DESTINO.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO)
AND (PC_PUESTOS_ORIGEN.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN)
<%0!=null AND (PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR = {0}) 0!=null%>
<%1!=null AND (PC_BIT_MOVIMIENTOS.PC_FCH_MOVIMIENTO BETWEEN TO_DATE(''{1}'',''DD/MM/YYYY'') AND  TO_DATE(''{2}'',''DD/MM/YYYY'')) 1!=null%>
)ORDER BY PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS DESC;
-- Query para Login
97
SELECT PC_LOGIN.PC_USERID,
       PC_LOGIN.PC_NOMBRE_CUENTA,
	   PC_ROLES_DIV.PC_CVE_DIV,
	   PC_ROLES_DIV.PC_CVE_SUBDIV,
 	   PC_ROLES_DIV.PC_CVE_ROL,
 	   PC_LOGIN.PC_CVE_USUARIO
FROM CATVEN.PC_LOGIN , CATVEN.PC_ROLES_DIV
WHERE ( (PC_LOGIN.PC_USERID = PC_ROLES_DIV.PC_USERID)
AND (PC_ROLES_DIV.PC_STATUS = 1)
AND (PC_LOGIN.PC_USERID = ''{0}'')
AND (PC_ROLES_DIV.PC_CVE_DIV={1})
AND (PC_ROLES_DIV.PC_CVE_SUBDIV={2}));
-- Query para Login
98
SELECT PC_ACCIONES.PC_DESC_ACCION,
	   PC_ACCIONES.PC_URL_ACCION
FROM PC_PERFILES , PC_ACCIONES
WHERE ( (PC_ACCIONES.PC_CVE_ACCION = PC_PERFILES.PC_CVE_ACCION)
AND (PC_PERFILES.PC_CVE_ROL = {0}));
-- Query para Login
99
SELECT PC_ROLES_DIV.PC_CVE_DIV,
 	   PC_SUBDIVISION.PC_DESC_SUBDIV
FROM CATVEN.PC_LOGIN , CATVEN.PC_ROLES_DIV, PC_SUBDIVISION
WHERE ( (PC_LOGIN.PC_USERID = PC_ROLES_DIV.PC_USERID)
AND (PC_ROLES_DIV.PC_CVE_SUBDIV= PC_SUBDIVISION.PC_CVE_SUBDIV)
AND (PC_ROLES_DIV.PC_STATUS = 1)
AND (PC_LOGIN.PC_USERID = ''{0}''));
-- Query para Login
100
SELECT PC_LOGIN.PC_USERID,
       PC_LOGIN.PC_NOMBRE_CUENTA,
       PC_LOGIN.PC_EXPIRATIONDATE
FROM CATVEN.PC_LOGIN
WHERE ( (PC_LOGIN.PC_USERID = ''{0}'')
AND (PC_LOGIN.PC_PASSWORD = ''{1}'') );
-- Query para desasignar Superior Comprobación
101
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD
FROM PC_VENDEDORES
WHERE PC_VENDEDORES.PC_CVE_SUPERIOR= {0};
-- Query para Obtener el puesto con nivel superior en PC_PUESTOS_NIVEL
102
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES , PC_PUESTOS
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO(+) = PC_VENDEDORES.PC_CVE_PUESTO)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {0})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {0}
	CONNECT BY PRIOR  PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%2!=0 AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)) 2!=0%>
)ORDER BY PC_NOMBRE_VENDEDOR;
-- Query para desasignar Superior Comprobación
103
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD
FROM PC_VENDEDORES
WHERE PC_VENDEDORES.PC_CVE_SUP_CAD = {0};
-- Query para desasignar Superior Comprobación
104
UPDATE PC_VENDEDORES SET PC_VENDEDORES.PC_CVE_SUP_CAD = (
	   SELECT PC_VENDEDORES.PC_CVE_SUPERIOR
	   FROM PC_VENDEDORES
	   WHERE PC_VENDEDORES.PC_CVE_VENDEDOR= {0})
WHERE PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	  SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	  FROM PC_VENDEDORES
	  WHERE PC_VENDEDORES.PC_CVE_SUP_CAD= {0}
);
-- Query Admin equal 1
105
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD
FROM PC_VENDEDORES
ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query Admin equal 2
106
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV
FROM PC_PUNTO_VENTAS;
-- Query Admin equal 4
107
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO  || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
       PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO  || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD, pc_subdivision.pc_desc_subdiv pc_subdivision,
	   PC_VENDEDORES.PC_CVE_EMPRESA
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR, PC_VENDEDORES PC_SUP_CAD, pc_subdivision
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
and (pc_vendedores.PC_CVE_SUBDIV = pc_subdivision.PC_CVE_SUBDIV)
AND ((PC_VENDEDORES.PC_CVE_VENDEDOR = {0}))); --query modificado  OR PC_VENDEDORES.PC_CVE_EMP_REF=''{0}''
-- Query Admin equal 5
108
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUNTO_VENTAS.PC_DIRECCION PC_DIRECCION,
	   PC_PUNTO_VENTAS.PC_COLONIA PC_COLONIA,
	   PC_PUNTO_VENTAS.PC_CP PC_CP,
	   PC_PUNTO_VENTAS.PC_TEL PC_TEL,
	   PC_PUNTO_VENTAS.PC_FAX PC_FAX,
       PC_PUNTO_VENTAS.PC_CIUDAD PC_CIUDAD,
	   PC_PUNTO_VENTAS.PC_ESTADO PC_ESTADO,
	   PC_PUNTO_VENTAS.PC_STATUS PC_STATUS,
	   PC_PUNTO_VENTAS.PC_DIG_VERIF PC_DIG_VERIF,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_DIVISION.PC_DESC_DIV PC_DESC_DIV,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_REGION , PC_TIPO_CANAL , PC_CANAL, PC_DIVISION, PC_SUBDIVISION
WHERE ( (PC_REGION.PC_CVE_REGION(+) = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_DIVISION.PC_CVE_DIV = PC_PUNTO_VENTAS.PC_CVE_DIV)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = ''{0}''));-- OR PC_PUNTO_VENTAS.PC_CVE_REFERENCIA = ''{0}''));
-- Query Adimin equal 6
109
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO
FROM PC_VENDEDORES
WHERE ( (PC_VENDEDORES.PC_CVE_PUESTO = {0}) );
-- Query Adimin equal 12
110
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS
FROM PC_PUNTO_VENTAS
WHERE ( (PC_PUNTO_VENTAS.PC_CVE_CANAL = ''{0}'') );
-- Query Adimin equal 38
111
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD, PC_DESC_SUBDIV PC_SUBDIVISION,
	   PC_VENDEDORES.PC_CVE_EMPRESA
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
);
-- Query Admin equal 40
112
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES;
-- Query Admin equal 44
113
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_PUNTO_VENTAS , PC_CANAL , PC_VENDEDORES
WHERE ( (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
<%0!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {0}) 0!=null%>
<%1!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{1}'') 1!=null%> );
-- Query Admin equal 46
114
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_FCH_MOVIMIENTO PC_FCH_MOVIMIENTO,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_USUARIO PC_CVE_USUARIO,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_AUTORIZA PC_CVE_AUTORIZA
FROM PC_INTER_VENDEDORES_PTOVENTAS;
-- Query Admin equal 47
115
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_VENDEDORES
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND ((NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA''))
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{0}'') );
-- Query Admin equal 48
116
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_PUNTO_VENTAS , PC_CANAL
WHERE ( (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {0}));
-- Query Admin equal 49
117
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_FCH_MOVIMIENTO PC_FCH_MOVIMIENTO,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_VENDEDORES , PC_PUNTO_VENTAS , PC_CANAL
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND ((NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA''))
<%0!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{0}'') 0!=null%>
<%1!=null AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {1}) 1!=null%>);
-- Query Admin equal 50
118
SELECT PC_DIVISION.PC_CVE_DIV PC_CVE_DIV,
       PC_DIVISION.PC_DESC_DIV PC_DESC_DIV
FROM PC_DIVISION;
-- Query Admin equal 61
119
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO
FROM PC_VENDEDORES
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR;
-- Query Admin equal 62
120
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO
FROM PC_VENDEDORES
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR  PC_VENDEDORES.PC_CVE_SUPERIOR = PC_VENDEDORES.PC_CVE_VENDEDOR;
-- Query Admin equal 68
121
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUP_CAD
FROM PC_VENDEDORES
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = {0}));
-- Query Admin equal 69
122
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS
FROM PC_INTER_VENDEDORES_PTOVENTAS
WHERE(PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {0});
-- Query Admin equal 72
123
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_DIVISION.PC_DESC_DIV PC_DESC_DIV,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_CANAL , PC_TIPO_CANAL , PC_REGION, PC_DIVISION, PC_SUBDIVISION
WHERE (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_REGION.PC_CVE_REGION = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_DIVISION.PC_CVE_DIV = PC_PUNTO_VENTAS.PC_CVE_DIV)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_PUNTO_VENTAS.PC_CVE_REGION = {0}) ;
-- Query Admin equal 75
124
SELECT PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR
FROM PC_BIT_MOVIMIENTOS
WHERE ( (PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR = {0}) );
-- Query Admin equal 86
125
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES , PC_PUESTOS
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO(+) = PC_VENDEDORES.PC_CVE_PUESTO)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {0})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {0}
	CONNECT BY PRIOR  PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
)))
ORDER BY PC_NOMBRE_VENDEDOR;
-- Query Admin equal 92
126
SELECT PC_MAPEO_VENDEDOR.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_MAPEO_VENDEDOR.PC_SISTEMA PC_SISTEMA,
	   PC_MAPEO_VENDEDOR.PC_CUSTOMER_ID PC_CUSTOMER_ID,
	   PC_MAPEO_VENDEDOR.PC_CVE_REG_VENTA PC_CVE_REG_VENTA,
	   PC_MAPEO_VENDEDOR.PC_NOM_USUARIO PC_NOM_USUARIO, pc_subdivision.pc_desc_subdiv pc_subdivision
FROM PC_MAPEO_VENDEDOR, pc_subdivision, pc_vendedores
WHERE pc_mapeo_vendedor.PC_CVE_VENDEDOR = pc_vendedores.PC_CVE_VENDEDOR
and pc_vendedores.PC_CVE_SUBDIV = pc_subdivision.PC_CVE_SUBDIV
and PC_MAPEO_VENDEDOR.PC_CVE_VENDEDOR = {0};
-- Query Admin equal 93
127
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,
	   PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
	   PC_PUESTOS.PC_CVE_PUESTO,
	   PC_PUESTOS.PC_DESC_PUESTO,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_VENDEDORES, PC_PUESTOS, PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
AND PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR(+)
AND PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR;
-- Query Admin equal 94
128
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER PC_CVE_INTER,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_FCH_MOVIMIENTO PC_FCH_MOVIMIENTO,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_VENDEDORES , PC_PUNTO_VENTAS , PC_CANAL
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_INTER = {0}) );
-- Query Admin equal 95
129
SELECT PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS,
       PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR,
       PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_FCH_MOVIMIENTO,
       PC_BIT_MOVIMIENTOS.PC_FCH_TRANSACCION,
       PC_PUNTO_VENTAS_ORIGEN.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_ORIGEN,
       PC_PUNTO_VENTAS_DESTINO.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_DESTINO,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
       PC_VENDEDORES.PC_APE_PATERNO  || '' '' ||
       PC_VENDEDORES.PC_APE_MATERNO PC_NOM_COMP_VENDEDOR,
       PC_SUPERIOR_ORIGEN.PC_NOM_VENDEDOR || '' '' ||
       PC_SUPERIOR_ORIGEN.PC_APE_PATERNO  || '' '' ||
       PC_SUPERIOR_ORIGEN.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_ORIGEN,
       PC_SUPERIOR_DESTINO.PC_NOM_VENDEDOR || '' '' ||
       PC_SUPERIOR_DESTINO.PC_APE_PATERNO  || '' '' ||
       PC_SUPERIOR_DESTINO.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_DESTINO,
       PC_PUESTOS_ORIGEN.PC_DESC_PUESTO PC_DESC_PUESTO_ORIGEN,
       PC_PUESTOS_DESTINO.PC_DESC_PUESTO PC_DESC_PUESTO_DESTINO
FROM PC_BIT_MOVIMIENTOS , PC_VENDEDORES ,
	 PC_PUNTO_VENTAS PC_PUNTO_VENTAS_ORIGEN,
	 PC_PUNTO_VENTAS PC_PUNTO_VENTAS_DESTINO,
	 PC_VENDEDORES PC_SUPERIOR_ORIGEN,
	 PC_VENDEDORES PC_SUPERIOR_DESTINO,
	 PC_PUESTOS PC_PUESTOS_DESTINO,
	 PC_PUESTOS PC_PUESTOS_ORIGEN
WHERE ((PC_VENDEDORES.PC_CVE_VENDEDOR = PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR)
AND (PC_PUNTO_VENTAS_ORIGEN.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN)
AND (PC_PUNTO_VENTAS_DESTINO.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO)
AND (PC_SUPERIOR_ORIGEN.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN)
AND (PC_SUPERIOR_DESTINO.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO)
AND (PC_PUESTOS_DESTINO.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO)
AND (PC_PUESTOS_ORIGEN.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN)
AND (ROWNUM < {0}))
ORDER BY PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS DESC;
-- Query Admin equal 96
130
SELECT PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS,
       PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR,
       PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN,
       PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO,
       PC_BIT_MOVIMIENTOS.PC_FCH_MOVIMIENTO,
       PC_BIT_MOVIMIENTOS.PC_FCH_TRANSACCION,
       PC_PUNTO_VENTAS_ORIGEN.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_ORIGEN,
       PC_PUNTO_VENTAS_DESTINO.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS_DESTINO,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
       PC_VENDEDORES.PC_APE_PATERNO  || '' '' ||
       PC_VENDEDORES.PC_APE_MATERNO PC_NOM_COMP_VENDEDOR,
       PC_SUPERIOR_ORIGEN.PC_NOM_VENDEDOR || '' '' ||
       PC_SUPERIOR_ORIGEN.PC_APE_PATERNO  || '' '' ||
       PC_SUPERIOR_ORIGEN.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_ORIGEN,
       PC_SUPERIOR_DESTINO.PC_NOM_VENDEDOR || '' '' ||
       PC_SUPERIOR_DESTINO.PC_APE_PATERNO  || '' '' ||
       PC_SUPERIOR_DESTINO.PC_APE_MATERNO PC_NOM_COMP_SUPERIOR_DESTINO,
       PC_PUESTOS_ORIGEN.PC_DESC_PUESTO PC_DESC_PUESTO_ORIGEN,
       PC_PUESTOS_DESTINO.PC_DESC_PUESTO PC_DESC_PUESTO_DESTINO
FROM PC_BIT_MOVIMIENTOS , PC_VENDEDORES ,
	 PC_PUNTO_VENTAS PC_PUNTO_VENTAS_ORIGEN,
	 PC_PUNTO_VENTAS PC_PUNTO_VENTAS_DESTINO,
	 PC_VENDEDORES PC_SUPERIOR_ORIGEN,
	 PC_VENDEDORES PC_SUPERIOR_DESTINO,
	 PC_PUESTOS PC_PUESTOS_DESTINO,
	 PC_PUESTOS PC_PUESTOS_ORIGEN
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR)
AND (PC_PUNTO_VENTAS_ORIGEN.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_ORIGEN)
AND (PC_PUNTO_VENTAS_DESTINO.PC_CVE_PTOVENTAS(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PTOVENTAS_DESTINO)
AND (PC_SUPERIOR_ORIGEN.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_ORIGEN)
AND (PC_SUPERIOR_DESTINO.PC_CVE_VENDEDOR(+) = PC_BIT_MOVIMIENTOS.PC_CVE_SUPERIOR_DESTINO)
AND (PC_PUESTOS_DESTINO.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_DESTINO)
AND (PC_PUESTOS_ORIGEN.PC_CVE_PUESTO(+) = PC_BIT_MOVIMIENTOS.PC_CVE_PUESTO_ORIGEN)
<%0!=null AND (PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR = {0}) 0!=null%>
<%1!=null AND (PC_BIT_MOVIMIENTOS.PC_FCH_MOVIMIENTO BETWEEN TO_DATE(''{1}'',''DD/MM/YYYY'') AND  TO_DATE(''{2}'',''DD/MM/YYYY'')) 1!=null%>
)ORDER BY PC_BIT_MOVIMIENTOS.PC_CVE_BIT_MOVIMIENTOS DESC;
-- Query Admin equal 102
131
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_VENDEDOR
FROM PC_VENDEDORES , PC_PUESTOS
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO(+) = PC_VENDEDORES.PC_CVE_PUESTO)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {0})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {0}
	CONNECT BY PRIOR  PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
)))
ORDER BY PC_NOMBRE_VENDEDOR;
-- Query Login ROL ID
132
SELECT DISTINCT PC_LOGIN.PC_USERID,
       PC_LOGIN.PC_NOMBRE_CUENTA,
 	   PC_ROLES_DIV.PC_CVE_ROL,
 	   PC_LOGIN.PC_CVE_USUARIO
FROM CATVEN.PC_LOGIN , CATVEN.PC_ROLES_DIV
WHERE ( (PC_LOGIN.PC_USERID = PC_ROLES_DIV.PC_USERID)
AND (PC_ROLES_DIV.PC_STATUS = 1)
AND (PC_LOGIN.PC_USERID = ''{0}''));
-- Query para obtener el organigrama hacia abajo
133
SELECT a.NIVEL,
       a.PC_CVE_VENDEDOR,
       a.PC_NOMBRE_VENDEDOR,
	   a.PC_FCH_ALTA,
	   a.PC_FCH_BAJA,
	   a.PC_DIG_VERIF,
	   a.PC_CIUDAD,
	   a.PC_ESTADO,
	   a.PC_DIRECCION,
	   a.PC_COLONIA,
	   a.PC_CP,
	   a.PC_TEL,
	   a.PC_FAX,
	   a.PC_CVE_SUBDIV,
	   a.PC_CVE_PUESTO,
	   a.PC_DESC_PUESTO,
	   a.PC_CVE_SUPERIOR,
	   a.PC_NOMBRE_SUPERIOR,
	   a.PC_DESC_PUESTO_SUP,
	   a.PC_DESC_DIV,
	   a.PC_CVE_EMP_REF
FROM
(SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,
	   PC_VENDEDORES.PC_DIRECCION,
	   PC_VENDEDORES.PC_COLONIA,
	   PC_VENDEDORES.PC_CP,
	   PC_VENDEDORES.PC_TEL,
	   PC_VENDEDORES.PC_FAX,
	   PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   PC_VENDEDORES.PC_CVE_EMP_REF,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
	   PC_VENDEDORES.PC_CVE_SUPERIOR,
	   (SELECT superior.PC_APE_PATERNO || '' '' ||
	           superior.PC_APE_MATERNO || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	   (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = {2}) PC_DESC_DIV
FROM PC_VENDEDORES
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)a,
(SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
FROM PC_VENDEDORES
WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) b
WHERE  a.PC_CVE_VENDEDOR=b.PC_CVE_VENDEDOR
order by a.nivel, a.pc_cve_superior, a.pc_cve_puesto, a.PC_NOMBRE_VENDEDOR;
-- Query para añadir tiendas en reporte organigrama
134
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR,
	   PC_VENDEDORES.PC_CVE_SUPERIOR,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_VENDEDORES, PC_PUESTOS, PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
AND PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR(+)
AND PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND (NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
ORDER BY PC_VENDEDORES.PC_CVE_VENDEDOR;
-- Query para reporte sin division
135
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO  || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   PC_VENDEDORES.PC_CVE_EMP_REF,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
   	   PC_VENDEDORES.PC_CVE_SUPERIOR,
       (SELECT superior.PC_APE_PATERNO || '' '' ||
	           superior.PC_APE_MATERNO || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
		(SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	    (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = {0}) PC_DESC_DIV
FROM PC_VENDEDORES
WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
order by nivel, pc_vendedores.pc_cve_superior, pc_vendedores.pc_cve_puesto, pc_vendedores.PC_APE_PATERNO;
-- Query para añadir tiendas en reporte organigrama
136
SELECT a.PC_CVE_VENDEDOR,
	   b.PC_CVE_PTOVENTAS,
	   b.PC_NOM_PTOVENTAS,
	   b.PC_CVE_CANAL,
	   b.PC_CVE_REGION,
	   b.PC_CVE_REFERENCIA,
	   b.PC_DESC_CANAL,
	   b.PC_CVE_TP_CANAL,
	   b.PC_DESC_TP_CANAL,
	   b.PC_DESC_REGION
FROM
(
SELECT LEVEL AS NIVEL, ROWNUM AS REGISTRO, PC_VENDEDORES.PC_CVE_VENDEDOR
FROM PC_VENDEDORES
WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) a,
(
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
AND (NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
) b
WHERE a.PC_CVE_VENDEDOR = b.PC_CVE_VENDEDOR(+)
ORDER BY PC_CVE_VENDEDOR;
-- Query Personal Parametros Perdido
137
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       CASE PC_VENDEDORES.PC_CVE_SUPERIOR
	   WHEN {2} THEN NULL
	   ELSE PC_VENDEDORES.PC_CVE_SUPERIOR END
	   PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA,
	   PC_SUBDIVISION.PC_DESC_SUBDIV pc_subdivision
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {3}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)))
UNION
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
      PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA,
       PC_SUBDIVISION.PC_DESC_SUBDIV pc_subdivision	
	FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
	WHERE ((PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
	--AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NULL)
	AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
	AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
	AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
	<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
	<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>)
	ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query para busqueda de String completo REF 111
138
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA,   PC_SUBDIVISION.PC_DESC_SUBDIV pc_subdivision
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND (UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%'')) 1!=null%>
);
-- Query Personal Parametro Perdido verificando sobre el nombre completo
139
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       CASE PC_VENDEDORES.PC_CVE_SUPERIOR
	   WHEN {2} THEN NULL
	   ELSE PC_VENDEDORES.PC_CVE_SUPERIOR END
	   PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA,   PC_SUBDIVISION.PC_DESC_SUBDIV pc_subdivision
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {3}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)))
UNION
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA,
	   PC_SUBDIVISION.PC_DESC_SUBDIV pc_subdivision	
	FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
	WHERE ((PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
	--AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NULL)
	AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
	AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
	AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
	<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
	<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>)
	ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query para Verificar Nombres antes de darlos de alta un Div
140
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       CASE PC_VENDEDORES.PC_CVE_SUPERIOR
	   WHEN {3} THEN NULL
	   ELSE PC_VENDEDORES.PC_CVE_SUPERIOR END
	   PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	    PC_DIVISION.PC_DESC_DIV PC_SUBDIVISION	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, pc_division
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_DIVISION.PC_CVE_DIV)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{0}%''))
  OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%''))
  OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{2}%'')))
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {3}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {4}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))) ;
-- Query para Verificar Nombres antes de darlos de alta
141
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_DIVISION.PC_DESC_DIV PC_SUBDIVISION	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_DIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_DIVISION.PC_CVE_DIV)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{0}%''))
  OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%''))
  OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{2}%'')))
);
-- Query para obtener la siguiente clave disponible en la Tabla de Puntos de Venta
142
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       CASE PC_VENDEDORES.PC_CVE_SUPERIOR
	   WHEN {2} THEN NULL
	   ELSE PC_VENDEDORES.PC_CVE_SUPERIOR END
	   PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {3})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {3}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {4}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)))
UNION
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ((PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {3})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {3}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>)
ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query para busqueda de String completo REF 111
143
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA,
       PC_SUBDIVISION.PC_DESC_SUBDIV pc_subdivision	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {2})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {2}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND (UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%'')) 1!=null%>
);
-- Query para obtener la siguiente clave disponible en la Tabla de Puntos de Venta
144
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       CASE PC_VENDEDORES.PC_CVE_SUPERIOR
	   WHEN {2} THEN NULL
	   ELSE PC_VENDEDORES.PC_CVE_SUPERIOR END
	   PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {3})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {3}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {4}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)))
UNION
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ((PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {3})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {3}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>)
ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query Adimin equal 38
145
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_PUESTO <> {2})
AND (PC_VENDEDORES.PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = {2}
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP = PC_PUESTOS_NIVEL.PC_CVE_PUESTO
))
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
);
-- Testing Stored Procedures
146
{ call ? := sp_get_stocks(?) };
-- Query Adimin equal 111 con filtro de bajas
147
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD, PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
);
-- Query para busqueda de String completo REF 138 con filtro de bajas
148
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
	   PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD, PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND (UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%'')) 1!=null%>;
-- Query Personal Parametros Perdido 137
149
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       CASE PC_VENDEDORES.PC_CVE_SUPERIOR
	   WHEN {2} THEN NULL
	   ELSE PC_VENDEDORES.PC_CVE_SUPERIOR END
	   PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD, PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {3}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)))
UNION
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ((NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_PATERNO) like UPPER(''%{1}%'')) OR (UPPER(PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>)
ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query Personal Parametro Perdido verificando sobre el nombre completo 139
150
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       CASE PC_VENDEDORES.PC_CVE_SUPERIOR
	   WHEN {2} THEN NULL
	   ELSE PC_VENDEDORES.PC_CVE_SUPERIOR END
	   PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NOT NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {2}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {3}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)))
UNION
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR IS NULL)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
<%0!=null AND (PC_VENDEDORES.PC_CVE_PUESTO = {0}) 0!=null%>
<%1!=null AND ((UPPER(PC_VENDEDORES.PC_NOM_VENDEDOR||'' ''||PC_VENDEDORES.PC_APE_PATERNO||'' ''||PC_VENDEDORES.PC_APE_MATERNO) like UPPER(''%{1}%''))) 1!=null%>)
ORDER BY PC_APE_PATERNO,PC_APE_MATERNO,PC_NOM_VENDEDOR;
-- Query Cuentas de Acceso
151
select distinct a.pc_userid, a.pc_nombre_cuenta, b.pc_desc_rol, a.pc_isblocked, a.pc_logindate, a.pc_expirationdate, a.pc_cambia_password
from pc_login a, pc_roles b, CATVEN.PC_ROLES_DIV c
where a.pc_userid = c.pc_userid(+)
and c.pc_cve_rol = b.pc_cve_rol(+)
order by 1;
-- Query Acciones Aplicacion
152
SELECT PC_CVE_ACCION,
	   PC_DESC_ACCION,
	   PC_URL_ACCION
FROM PC_ACCIONES;
-- Query Roles Aplicacion
153
SELECT PC_CVE_ROL,
	   PC_DESC_ROL
FROM PC_ROLES;
-- Query Perfiles Aplicacion
154
SELECT PC_CVE_PERFIL,
       PC_CVE_ROL,
	   (SELECT PC_DESC_ROL
	   FROM PC_ROLES
	   WHERE PC_ROLES.PC_CVE_ROL=PC_PERFILES.PC_CVE_ROL) PC_DESC_ROL,
	   PC_CVE_ACCION,
	   (SELECT PC_DESC_ACCION
	    FROM PC_ACCIONES
		WHERE PC_ACCIONES.PC_CVE_ACCION = PC_PERFILES.PC_CVE_ACCION) PC_DESC_ACCION
FROM PC_PERFILES
<%0!=null WHERE PC_CVE_ROL={0} 0!=null%>;
-- Insertar Cuenta de Acceso
155
INSERT INTO CATVEN.PC_LOGIN (PC_USERID, PC_PASSWORD, PC_NOMBRE_CUENTA, PC_CVE_USUARIO, PC_ISBLOCKED, PC_LOGINDATE, PC_EXPIRATIONDATE)
               VALUES(''{0}'',''{1}'',''{2}'',(SELECT (MAX(PC_CVE_USUARIO)+1) FROM CATVEN.PC_LOGIN), 0, SYSDATE, TO_DATE(''{3}'',''DD/MM/YYYY''));
-- Eliminar Cuenta de Acceso
156
DELETE FROM CATVEN.PC_LOGIN WHERE PC_USERID = ''{0}'';
-- Actualizar Cuenta de Acceso
157
UPDATE CATVEN.PC_LOGIN SET PC_NOMBRE_CUENTA = ''{2}'', PC_PASSWORD=''{1}'', PC_ISBLOCKED='0',
	   PC_LOGINDATE=SYSDATE, PC_EXPIRATIONDATE = TO_DATE(''{3}'',''DD/MM/YYYY''), PC_CAMBIA_PASSWORD='1'
WHERE PC_USERID= ''{0}'';
-- Cambiar Contraseña
158
UPDATE CATVEN.PC_LOGIN SET PC_PASSWORD = {0}
WHERE PC_CVE_USUARIO = {1};
-- Insertar un Perfil
159
INSERT INTO PC_PERFILES (PC_CVE_PERFIL, PC_CVE_ROL, PC_CVE_ACCION)
                 VALUES ((SELECT (MAX(PC_CVE_PERFIL)+1) FROM PC PERFILES),{0},{1});
-- Eliminar un Perfil
160
DELETE FROM PC_PERFILES WHERE PC_CVE_PERFIL = {0};
-- Insertar Rol Division
161
INSERT INTO CATVEN.PC_ROLES_DIV (PC_CVE_ROL_DIV, PC_USERID, PC_CVE_ROL, PC_CVE_DIV, PC_STATUS, PC_CVE_SUBDIV)
VALUES((SELECT (MAX(PC_CVE_ROL_DIV)+1) FROM CATVEN.PC_ROLES_DIV), ''{0}'', {1},{2},1,{2});
-- Seleccionar Permisos para despliegue de tabla
162
SELECT PC_ROLES_DIV.PC_CVE_ROL_DIV,
	   PC_ROLES_DIV.PC_USERID,
	   PC_ROLES_DIV.PC_CVE_ROL,
	   PC_ROLES_DIV.PC_CVE_SUBDIV PC_CVE_DIV,
	   PC_ROLES_DIV.PC_STATUS,
	   PC_SUBDIVISION.PC_DESC_SUBDIV,
	   PC_ROLES.PC_DESC_ROL,
	   CASE PC_ROLES_DIV.PC_STATUS
	   WHEN 1 THEN ''ACTIVO''
	   ELSE ''BLOQUEADO'' END PC_DESC_STATUS
FROM CATVEN.PC_ROLES_DIV , PC_SUBDIVISION, PC_ROLES
WHERE PC_ROLES_DIV.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV
AND PC_ROLES_DIV.PC_CVE_ROL =  PC_ROLES.PC_CVE_ROL
ORDER BY PC_USERID;
-- Eliminar una relacion en Division y Rol
163
DELETE FROM PC_ROLES_DIV WHERE PC_ROLES_DIV.PC_CVE_ROL_DIV = {0};
-- Seleccionar todas las Divisiones
164
SELECT PC_DIVISION.PC_CVE_DIV PC_CVE_DIV,
       PC_DIVISION.PC_DESC_DIV PC_DESC_DIV
FROM PC_DIVISION;
-- Desativar Rol Division
165
UPDATE CATVEN.PC_ROLES_DIV SET PC_STATUS={1} WHERE PC_ROLES_DIV.PC_CVE_ROL_DIV = {0};
-- Access Log
166
INSERT INTO CATVEN.PC_LOG_ACCESO (PC_USERID, PC_DIR_IP, PC_TRANSACCION) VALUES (''{0}'', ''{1}'', ''{2}'');
-- Obtener Subordinados sin Division
167
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA PC_CVE_EMPRESA
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR = {0})
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
);
-- Obtener Subordinados con division
168
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
	   PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD,
	   PC_VENDEDORES.PC_CVE_EMPRESA PC_CVE_EMPRESA	
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_VENDEDORES.PC_CVE_SUPERIOR = {0})
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (PC_VENDEDORES.PC_CVE_PUESTO <> 0)
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)));
-- Query para Login
169
SELECT DISTINCT PC_ROLES_DIV.PC_CVE_DIV,
	   PC_SUBDIVISION.PC_CVE_SUBDIV,
   	   PC_SUBDIVISION.PC_DESC_SUBDIV
FROM CATVEN.PC_LOGIN, CATVEN.PC_ROLES_DIV, PC_SUBDIVISION
WHERE ( (PC_LOGIN.PC_USERID = PC_ROLES_DIV.PC_USERID)
AND (PC_ROLES_DIV.PC_CVE_DIV= PC_SUBDIVISION.PC_CVE_DIV)
AND (PC_ROLES_DIV.PC_STATUS = 1)
AND (PC_LOGIN.PC_USERID = ''{0}''));
-- Query para insertar la relacion del Personal con la Division basado en su superior
170
INSERT INTO PC_INTER_SUBDIVISION
	(SELECT PC_INTER_SUBDIVISION.PC_CVE_SUBDIV, {0} PC_CVE_VENDEDOR
	 FROM PC_INTER_SUBDIVISION
	 WHERE (PC_INTER_SUBDIVISION.PC_CVE_VENDEDOR={1}));
-- Query para traer todas las subdivisiones
171
SELECT PC_SUBDIVISION.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV,
        PC_SUBDIVISION.PC_CVE_DIV PC_CVE_DIV
FROM PC_SUBDIVISION
WHERE PC_CVE_SUBDIV <>0
<%0!=0 AND PC_SUBDIVISION.PC_CVE_SUBDIV = {0} 0!=0%>;
-- Query para insertar en PC_SUBDIVISION
172
INSERT INTO PC_SUBDIVISION (PC_CVE_SUBDIV, PC_DESC_SUBDIV, PC_CVE_DIV) VALUES ({0},''{1}'',{2});
-- Query para actualizar en PC_SUBDIVISION
173
UPDATE PC_SUBDIVISION SET PC_DESC_SUBDIV=''{1}'' WHERE PC_CVE_SUBDIV={0};
-- Query para eliminar en PC_SUBDIVISION
174
DELETE FROM PC_SUBDIVISION WHERE PC_CVE_SUBDIV={0};
-- Query para obtener la clave de PC_SUBDIVISION
175
SELECT NVL((MAX(PC_CVE_SUBDIV)+1),0) CLAVE FROM PC_SUBDIVISION;
-- Query para obtener los movimientos por residuales para un empresario
176
SELECT PC_SUBDIVISION.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV,
       PC_SUBDIVISION.PC_CVE_DIV PC_CVE_DIV
FROM PC_SUBDIVISION , PC_DIVISION
WHERE ( (PC_DIVISION.PC_CVE_DIV = PC_SUBDIVISION.PC_CVE_DIV)
AND (PC_DIVISION.PC_CVE_DIV = {0}) )
ORDER BY PC_DESC_SUBDIV;
-- Query para obtener Puntos de Venta por Subdivision
-- Query para obtener Puntos de Venta por Subdivision restringido Admin
177
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_CANAL , PC_TIPO_CANAL , PC_REGION, PC_SUBDIVISION
WHERE  (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_REGION.PC_CVE_REGION(+) = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {0})
AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {1});
-- Query para desasignar Superior Comprobación
178
SELECT PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD
FROM PC_VENDEDORES
WHERE PC_VENDEDORES.PC_CVE_SUPERIOR= {0}
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'');
-- Query especial para verificar que no existan relaciones en Pc_Inter_Vendedores_Ptoventas
179
SELECT DISTINCT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD
FROM PC_INTER_VENDEDORES_PTOVENTAS , PC_VENDEDORES , PC_PUNTO_VENTAS , PC_CANAL
WHERE ( (PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR)
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND ((NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA''))
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = ''{0}'')
AND (PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {1}));
--QUERY PARA DIVISIONES
180
SELECT DISTINCT PC_ROLES_DIV.PC_CVE_DIV,
	   PC_SUBDIVISION.PC_CVE_SUBDIV,
   	   PC_SUBDIVISION.PC_DESC_SUBDIV
FROM CATVEN.PC_LOGIN, CATVEN.PC_ROLES_DIV, PC_SUBDIVISION
WHERE ( (PC_LOGIN.PC_USERID = PC_ROLES_DIV.PC_USERID)
AND (PC_ROLES_DIV.PC_CVE_DIV= PC_SUBDIVISION.PC_CVE_DIV)
AND (PC_ROLES_DIV.PC_STATUS = 1)
AND PC_SUBDIVISION.PC_CVE_SUBDIV <>0
AND (PC_LOGIN.PC_USERID = ''{0}''));
---------------------------
-- Query para reporte sin division
300
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   PC_VENDEDORES.PC_CVE_EMP_REF,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
   	   PC_VENDEDORES.PC_CVE_SUPERIOR,
       (SELECT superior.PC_APE_PATERNO || '' '' ||
	           superior.PC_APE_MATERNO  || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
		(SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	    (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = {0}) PC_DESC_DIV
FROM PC_VENDEDORES
WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
order by nivel,  PC_VENDEDORES.PC_CVE_PUESTO, pc_vendedores.PC_APE_PATERNO;

-- Query para añadir tiendas en reporte organigrama
301
SELECT a.PC_CVE_VENDEDOR,
	   b.PC_CVE_PTOVENTAS,
	   b.PC_NOM_PTOVENTAS,
	   b.PC_CVE_CANAL,
	   b.PC_CVE_REGION,
	   b.PC_CVE_REFERENCIA,
	   b.PC_DESC_CANAL,
	   b.PC_CVE_TP_CANAL,
	   b.PC_DESC_TP_CANAL,
	   b.PC_DESC_REGION
FROM
(
SELECT LEVEL AS NIVEL, ROWNUM AS REGISTRO, PC_VENDEDORES.PC_CVE_VENDEDOR
FROM PC_VENDEDORES
WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) a,
(
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND (NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
) b
WHERE a.PC_CVE_VENDEDOR = b.PC_CVE_VENDEDOR(+)
ORDER BY PC_CVE_VENDEDOR;
------------------------
-- Query para obtener el organigrama hacia abajo
302
SELECT a.NIVEL,
       a.PC_CVE_VENDEDOR,
       a.PC_NOMBRE_VENDEDOR,
	   a.PC_FCH_ALTA,
	   a.PC_FCH_BAJA,
	   a.PC_DIG_VERIF,
	   a.PC_CIUDAD,
	   a.PC_ESTADO,
	   a.PC_DIRECCION,
	   a.PC_COLONIA,
	   a.PC_CP,
	   a.PC_TEL,
	   a.PC_FAX,
	   a.PC_CVE_SUBDIV,
	   a.PC_CVE_PUESTO,
	   a.PC_DESC_PUESTO,
	   a.PC_CVE_SUPERIOR,
	   a.PC_NOMBRE_SUPERIOR,
	   a.PC_DESC_PUESTO_SUP,
	   a.PC_DESC_DIV
FROM
(SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,
	   PC_VENDEDORES.PC_DIRECCION,
	   PC_VENDEDORES.PC_COLONIA,
	   PC_VENDEDORES.PC_CP,
	   PC_VENDEDORES.PC_TEL,
	   PC_VENDEDORES.PC_FAX,
	   PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
	   PC_VENDEDORES.PC_CVE_SUPERIOR,
	   (SELECT superior.PC_APE_PATERNO  || '' '' ||
	           superior.PC_APE_MATERNO  || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	   (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = {2}) PC_DESC_DIV
FROM PC_VENDEDORES
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)a,
(SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
FROM PC_VENDEDORES
WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) b
WHERE  a.PC_CVE_VENDEDOR=b.PC_CVE_VENDEDOR
order by a.nivel;
-- Query para añadir tiendas en reporte organigrama
303
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR,
	   PC_VENDEDORES.PC_CVE_SUPERIOR,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_VENDEDORES, PC_PUESTOS, PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
AND PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR(+)
AND PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
ORDER BY PC_VENDEDORES.PC_CVE_VENDEDOR;
--query para una division con 2 subdivisiones
304
SELECT a.NIVEL,
       a.PC_CVE_VENDEDOR,
       a.PC_NOMBRE_VENDEDOR,
	   a.PC_FCH_ALTA,
	   a.PC_FCH_BAJA,
	   a.PC_DIG_VERIF,
	   a.PC_CIUDAD,
	   a.PC_ESTADO,
	   a.PC_DIRECCION,
	   a.PC_COLONIA,
	   a.PC_CP,
	   a.PC_TEL,
	   a.PC_FAX,
	   a.PC_CVE_SUBDIV,
	   a.PC_CVE_PUESTO,
	   a.PC_DESC_PUESTO,
	   a.PC_CVE_SUPERIOR,
	   a.PC_NOMBRE_SUPERIOR,
	   a.PC_DESC_PUESTO_SUP,
	   a.PC_DESC_DIV
FROM
(SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,
	   PC_VENDEDORES.PC_DIRECCION,
	   PC_VENDEDORES.PC_COLONIA,
	   PC_VENDEDORES.PC_CP,
	   PC_VENDEDORES.PC_TEL,
	   PC_VENDEDORES.PC_FAX,
	   PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
	   PC_VENDEDORES.PC_CVE_SUPERIOR,
	   (SELECT superior.PC_APE_PATERNO || '' '' ||
	           superior.PC_APE_MATERNO || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	   (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = {2}) PC_DESC_DIV
FROM PC_VENDEDORES
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
)a,
(SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
FROM PC_VENDEDORES
WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0)
OR ((PC_VENDEDORES.PC_CVE_SUBDIV = {3})))
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) b
WHERE  a.PC_CVE_VENDEDOR=b.PC_CVE_VENDEDOR
order by a.nivel;
-- Query para añadir tiendas en reporte organigrama
305
SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR,
	   PC_VENDEDORES.PC_CVE_SUPERIOR,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_VENDEDORES, PC_PUESTOS, PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
AND PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR(+)
AND PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0)
	OR (PC_VENDEDORES.PC_CVE_SUBDIV = {3}))
	AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
))
ORDER BY PC_VENDEDORES.PC_CVE_VENDEDOR;
---query para obtener las subdivisiones
306
SELECT PC_CVE_SUBDIV, PC_DESC_SUBDIV
FROM PC_SUBDIVISION
WHERE PC_CVE_SUBDIV <> 0
AND PC_CVE_DIV = {0};
---query para traerme todas las empresas
307
select pc_cve_empresa, pc_desc_empresa, pc_tipo_empresa, pc_nro_compania
from pc_empresas;
---QUERY PARA INSERTAR EMPRESA
308
insert into pc_empresas(pc_cve_empresa, pc_desc_empresa, pc_tipo_empresa, pc_nro_compania)
values((SELECT NVL((MAX(PC_CVE_EMPRESA)+1),0) FROM PC_EMPRESAS), ''{0}'', ''{1}'', 1);
--QUERY PARA BORRAR EMPRESA
309
DELETE FROM PC_EMPRESAS WHERE PC_CVE_EMPRESA={0};
--QUERY PARA ACTUALIZAR EMPRESA
340
UPDATE PC_EMPRESAS SET PC_DESC_EMPRESA=''{1}'',
PC_TIPO_EMPRESA=''{2}''
WHERE PC_CVE_EMPRESA = {0};
-- Query que obtiene todos los datos del personal dada la cve DIVISIONES
312
SELECT PC_VENDEDORES.PC_NOM_VENDEDOR || '' ''||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_COMPLETO,
	   PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO || '' ''||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
       PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD, PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR , PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND ((PC_VENDEDORES.PC_CVE_VENDEDOR = (select pc_cve_vendedor from pc_vendedores where pc_cve_emp_ref=''{0}'')))
AND (PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM PC_VENDEDORES
	WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {2}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR))
    );
-- Query para busqueda de vendedores
313
SELECT PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
	   PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_COMPLETO,
	   PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA PC_COLONIA,
       PC_VENDEDORES.PC_CP PC_CP,
       PC_VENDEDORES.PC_TEL PC_TEL,
       PC_VENDEDORES.PC_FAX PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUESTOS.PC_DESC_PUESTO PC_DESC_PUESTO,
       PC_SUPERIOR.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUPERIOR.PC_APE_PATERNO  || '' '' ||
	   PC_SUPERIOR.PC_APE_MATERNO PC_NOMBRE_SUPERIOR,
       PC_VENDEDORES.PC_CVE_SUP_CAD PC_CVE_SUP_CAD,
       PC_SUP_CAD.PC_NOM_VENDEDOR || '' '' ||
	   PC_SUP_CAD.PC_APE_PATERNO  || '' '' ||
	   PC_SUP_CAD.PC_APE_MATERNO PC_NOMBRE_SUP_CAD, PC_SUBDIVISION.PC_DESC_SUBDIV PC_SUBDIVISION
FROM PC_VENDEDORES , PC_PUESTOS , PC_VENDEDORES PC_SUPERIOR, PC_VENDEDORES PC_SUP_CAD, PC_SUBDIVISION
WHERE ( (PC_PUESTOS.PC_CVE_PUESTO = PC_VENDEDORES.PC_CVE_PUESTO)
AND (PC_SUPERIOR.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUPERIOR)
AND (PC_SUP_CAD.PC_CVE_VENDEDOR(+) = PC_VENDEDORES.PC_CVE_SUP_CAD)
AND (PC_VENDEDORES.PC_CVE_SUBDIV = PC_SUBDIVISION.PC_CVE_SUBDIV)
AND ((PC_VENDEDORES.PC_CVE_VENDEDOR = (select pc_cve_vendedor from pc_vendedores where pc_cve_emp_ref= ''{0}''))));

--Query RECUPERA LOS DATOS PARA LA PARTE DE REPORTE DE MOVIMIENTOS
--HACE UN JOIN CON LA TABLA DE BIT_MOVIMIENTOS
314
	SELECT DISTINCT PC_VENDEDORES.PC_CVE_VENDEDOR,
		   PC_VENDEDORES.PC_CVE_PUESTO,
		   PC_VENDEDORES.PC_CVE_SUPERIOR,
		   PC_VENDEDORES.PC_NOM_VENDEDOR,
	       PC_VENDEDORES.PC_APE_PATERNO,
	       PC_VENDEDORES.PC_APE_MATERNO,
	       PC_VENDEDORES.PC_FCH_ALTA,
	       PC_VENDEDORES.PC_FCH_BAJA,
	       PC_VENDEDORES.PC_DIG_VERIF,
		   PC_VENDEDORES.PC_CNTR_TDA,
		   PC_VENDEDORES.PC_STATUS,
		   PC_VENDEDORES.PC_CVE_EMP_REF,
		   PC_VENDEDORES.PC_CIUDAD,
		   PC_VENDEDORES.PC_ESTADO,
		   PC_VENDEDORES.PC_DIRECCION,
		   PC_VENDEDORES.PC_COLONIA,PC_VENDEDORES.PC_CP,
		   PC_VENDEDORES.PC_TEL,
		   PC_VENDEDORES.PC_FAX,
		   PC_VENDEDORES.PC_CVE_SUP_CAD,
		   PC_VENDEDORES.PC_NOM_VENDEDOR || '' '' ||
		   PC_VENDEDORES.PC_APE_PATERNO  || '' '' ||
		   PC_VENDEDORES.PC_APE_MATERNO PC_NOMBRE_COMPLETO,	
		   PC_PUESTOS.PC_DESC_PUESTO
	FROM   PC_VENDEDORES, PC_BIT_MOVIMIENTOS,PC_PUESTOS
	WHERE  PC_VENDEDORES.PC_CVE_VENDEDOR = PC_BIT_MOVIMIENTOS.PC_CVE_VENDEDOR
	AND    PC_VENDEDORES.PC_CVE_EMP_REF = ''{0}''
	AND    PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO;
-- QUERY PARA DAR DE ALTA AL VENDEDOR EN LA TABLA DE PC_VENDEDORES_HIS
315	
INSERT INTO PC_VENDEDORES_HIS (PC_CVE_ID,
			PC_CVE_VENDEDOR, PC_CVE_PUESTO,
		    PC_CVE_SUPERIOR, PC_FCH_INICIO,
			PC_FCH_FIN, PC_TP_MOV,
			PC_FCH_TRANSACCION, PC_CVE_USUARIO)
VALUES (SEQ_PC_VENDEDORES_HIS.nextval, {0},{1},{2},TO_DATE(''{3}'',''DD/MM/YYYY HH24:MI:SS''),'''',{4},SYSDATE, {5});	
-- QUERY PARA SABER SI EL USUARIO TIENE MOVIMIENTOS
316
SELECT PC_CVE_ID CLAVE, PC_TP_MOV FROM PC_VENDEDORES_HIS
WHERE  PC_FCH_FIN IS NULL
AND PC_CVE_VENDEDOR = {0}
ORDER BY PC_CVE_ID DESC;
-- QUERY PARA ACTUALIZAR LA FECHA DE BAJA PC_VENDEDORES_HIS
317
UPDATE PC_VENDEDORES_HIS SET PC_FCH_FIN = TO_DATE(''{2}'',''DD/MM/YYYY HH24:MI:SS''),
PC_FCH_TRANSACCION = SYSDATE, PC_CVE_USUARIO = {3}
<%4!=null  ,PC_TP_MOV={4} 4!=null%>
WHERE PC_CVE_ID = {0}
AND PC_CVE_VENDEDOR = {1};
-- QUERY PARA REACTIVAR EL STATUS DEL VENDEDOR
318
UPDATE PC_VENDEDORES_HIS SET PC_FCH_INICIO = TO_DATE(''{1}'',''DD/MM/YYYY HH24:MI:SS''),
PC_FCH_FIN = '''',
PC_TP_MOV=1, PC_FCH_TRANSACCION = SYSDATE, PC_CVE_USUARIO = {2}
WHERE PC_CVE_VENDEDOR = {0};
-- QUERY PARA TRAERME EL ULTIMO MOVIMIENTO DEL VENDEDOR
319
SELECT PC_CVE_ID CLAVE FROM PC_VENDEDORES_HIS
WHERE PC_FCH_FIN IS NULL
AND PC_CVE_VENDEDOR = {0}
AND ((PC_TP_MOV = {1}) OR (PC_TP_MOV=6));
-- QUERY PARA LOS MOVIMIENTOS CUANDO SEA AMBAS(SUPERIOR Y PUESTO)
320
SELECT PC_CVE_ID CLAVE FROM PC_VENDEDORES_HIS
WHERE PC_FCH_FIN IS NULL
AND PC_CVE_VENDEDOR = {0}
AND ((PC_TP_MOV = 3) OR  (PC_TP_MOV = 4)
OR (PC_TP_MOV = 6));
-- QUERY PARA ACTUALIZAR LA FECHA FIN DE VENEDORES HIS
321
UPDATE PC_VENDEDORES_HIS SET PC_FCH_FIN = TO_DATE(''{2}'',''DD/MM/YYYY HH24:MI:SS''),
PC_FCH_TRANSACCION = SYSDATE, PC_CVE_USUARIO = {3}
WHERE PC_CVE_ID = {0}
AND PC_CVE_VENDEDOR = {1};
--QUERY PARA TRAERSE LOS PUNTOS DE VENTA
322
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CP PC_CP,
       PC_PUNTO_VENTAS.PC_TEL PC_TEL,
       PC_PUNTO_VENTAS.PC_FAX PC_FAX,
       PC_PUNTO_VENTAS.PC_DIRECCION PC_DIRECCION,
       PC_PUNTO_VENTAS.PC_COLONIA PC_COLONIA,
       PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
       PC_PUNTO_VENTAS.PC_CIUDAD PC_CIUDAD,
	   PC_PUNTO_VENTAS.PC_ESTADO PC_ESTADO,
	   PC_PUNTO_VENTAS.PC_STATUS PC_STATUS,
	   PC_PUNTO_VENTAS.PC_DIG_VERIF PC_DIG_VERIF,	
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_TIPO_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
 FROM PC_PUNTO_VENTAS , PC_CANAL , PC_TIPO_CANAL , PC_SUBDIVISION
 WHERE( (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
 AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
 AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
 <%0!=null AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {0}) 0!=null%>
 <%4!=0 AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {4}) 4!=0%>
 <%1!=null AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = ''{1}'') 1!=null%>
 <%2!=null AND (PC_PUNTO_VENTAS.PC_CVE_CANAL = ''{2}'') 2!=null%>
 <%3!=null AND (UPPER(PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS) like UPPER(''%{3}%'')) 3!=null%>
 )ORDER BY PC_NOM_PTOVENTAS;
 --RECUPERA LOS DATOS DEL PERSONAL DE UNA DIVISION DADOS UNA CLAVE DEL VENDEDOR O SUBDIVISION
330
SELECT a.NIVEL,
       a.PC_CVE_VENDEDOR,
       a.PC_NOMBRE_VENDEDOR,
	   a.PC_FCH_ALTA,
	   a.PC_FCH_BAJA,
	   a.PC_DIG_VERIF,
	   a.PC_CIUDAD,
	   a.PC_ESTADO,
	   a.PC_DIRECCION,
	   a.PC_COLONIA,
	   a.PC_CP,
	   a.PC_TEL,
	   a.PC_FAX,
	   a.PC_CVE_SUBDIV,
	   a.PC_CVE_PUESTO,
	   a.PC_DESC_PUESTO,
	   a.PC_CVE_SUPERIOR,
	   a.PC_NOMBRE_SUPERIOR,
	   a.PC_DESC_PUESTO_SUP,
	   a.PC_DESC_DIV
FROM
(SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,
	   PC_VENDEDORES.PC_DIRECCION,
	   PC_VENDEDORES.PC_COLONIA,
	   PC_VENDEDORES.PC_CP,
	   PC_VENDEDORES.PC_TEL,
	   PC_VENDEDORES.PC_FAX,
	   PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
	    PC_VENDEDORES.PC_CVE_SUPERIOR,
	   (SELECT superior.PC_APE_PATERNO || '' '' ||
	           superior.PC_APE_MATERNO || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	   (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = 0) PC_DESC_DIV
FROM PC_VENDEDORES,PC_VENDEDORES_HIS
WHERE  PC_VENDEDORES_HIS.PC_FCH_FIN IS NULL
AND    PC_VENDEDORES_HIS.PC_FCH_INICIO <= TO_DATE({2})
AND    PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES_HIS.PC_CVE_VENDEDOR
START WITH PC_VENDEDORES_HIS.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR )a,
(SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
FROM PC_VENDEDORES
WHERE ((PC_VENDEDORES.PC_CVE_SUBDIV = {1}) OR (PC_VENDEDORES.PC_CVE_SUBDIV = 0))
--AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) b
WHERE  a.PC_CVE_VENDEDOR=b.PC_CVE_VENDEDOR
order by a.nivel;
--RECUPERA EL NOMBRE DEL PUNTO DE VENTA Y LA INFORMACION DEL PERSONAL DADA UNA FECHA ASIGNADA
331
SELECT a.NIVEL,
       a.PC_CVE_VENDEDOR,	
	   a.PC_CVE_SUPERIOR,
	   a.PC_NOM_VENDEDOR,
	   a.PC_FCH_ALTA,	
	   a.PC_DESC_PUESTO,   		   	
       b.PC_CVE_PTOVENTAS,
	   b.PC_NOM_PTOVENTAS,
	   b.PC_CVE_CANAL,
	   b.PC_CVE_REGION,
	   b.PC_CVE_REFERENCIA,
	   b.PC_DESC_CANAL,
	   b.PC_CVE_TP_CANAL,
	   b.PC_DESC_TP_CANAL,
	   b.PC_DESC_REGION 	
FROM  (SELECT DISTINCT LEVEL NIVEL,
	   ROWNUM AS REGISTRO,
	   PC_VENDEDORES.PC_CVE_VENDEDOR PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_CVE_PUESTO   PC_CVE_PUESTO,
       PC_VENDEDORES.PC_CVE_SUPERIOR PC_CVE_SUPERIOR,
       PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOM_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO  PC_APE_PATERNO,
       PC_VENDEDORES.PC_APE_MATERNO  PC_APE_MATERNO,
       PC_VENDEDORES.PC_FCH_ALTA     PC_FCH_ALTA,
       PC_VENDEDORES.PC_FCH_BAJA     PC_FCH_BAJA,
       PC_VENDEDORES.PC_DIG_VERIF    PC_DIG_VERIF,
       PC_VENDEDORES.PC_CNTR_TDA     PC_CNTR_TDA,
       PC_VENDEDORES.PC_STATUS       PC_STATUS,
       PC_VENDEDORES.PC_CVE_EMP_REF  PC_CVE_EMP_REF,
       PC_VENDEDORES.PC_CIUDAD       PC_CIUDAD,
       PC_VENDEDORES.PC_ESTADO       PC_ESTADO,
       PC_VENDEDORES.PC_DIRECCION    PC_DIRECCION,
       PC_VENDEDORES.PC_COLONIA      PC_COLONIA,
       PC_VENDEDORES.PC_CP           PC_CP,
       PC_VENDEDORES.PC_TEL 		 PC_TEL,
       PC_VENDEDORES.PC_FAX 		 PC_FAX,
       PC_VENDEDORES.PC_CVE_SUBDIV   PC_CVE_SUBDIV,
       PC_VENDEDORES.PC_CVE_SUP_CAD  PC_CVE_SUP_CAD,
	   PC_PUESTOS.PC_DESC_PUESTO
FROM   PC_VENDEDORES_HIS,PC_VENDEDORES,PC_PUESTOS	
WHERE  PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES_HIS.PC_CVE_VENDEDOR
AND    PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
AND    PC_VENDEDORES_HIS.PC_FCH_FIN IS NULL
AND    PC_VENDEDORES_HIS.PC_FCH_INICIO <= TO_DATE({2})
AND    PC_VENDEDORES.PC_CVE_VENDEDOR IN (
	   								  	  SELECT PC_VENDEDORES.PC_CVE_VENDEDOR
										  FROM PC_VENDEDORES
										  WHERE (PC_VENDEDORES.PC_CVE_SUBDIV = {1}))										
START  WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PC_VENDEDORES_HIS.PC_CVE_SUPERIOR = PRIOR PC_VENDEDORES_HIS.PC_CVE_VENDEDOR ) a,
	  	( SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR,
				          PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
						  PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
						  PC_PUNTO_VENTAS.PC_CVE_CANAL,
						  PC_PUNTO_VENTAS.PC_CVE_REGION,
						  PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
						  PC_CANAL.PC_DESC_CANAL,
						  PC_CANAL.PC_CVE_TP_CANAL,
						  PC_TIPO_CANAL.PC_DESC_TP_CANAL,
						  PC_REGION.PC_DESC_REGION						
				    FROM  PC_INTER_VENDEDORES_PTOVENTAS,
				          PC_PUNTO_VENTAS,
						  PC_CANAL,
						  PC_REGION,
						  PC_TIPO_CANAL,
						  pc_vendedores_his				
				    WHERE PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
				    AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
				    AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
				    AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)					
				    and pc_vendedores_his.PC_CVE_VENDEDOR = pc_inter_vendedores_ptoventas.PC_CVE_VENDEDOR(+) ) b
WHERE a.PC_CVE_VENDEDOR = b.PC_CVE_VENDEDOR(+) 	
order by a.nivel;
--RECUPERA LA JERARQUIA DE UN VENDEDOR
332
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
   	   PC_VENDEDORES.PC_CVE_SUPERIOR,
       (SELECT superior.PC_APE_PATERNO || '' '' ||
	           superior.PC_APE_MATERNO || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
		(SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	    (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = 0) PC_DESC_DIV
FROM PC_VENDEDORES,PC_VENDEDORES_HIS
WHERE  PC_VENDEDORES_HIS.PC_FCH_FIN IS NULL
AND    PC_VENDEDORES_HIS.PC_FCH_INICIO <= TO_DATE({1})
<%2!=null AND (PC_VENDEDORES.PC_CVE_SUBDIV = {2}) 2!=null%>
AND    PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES_HIS.PC_CVE_VENDEDOR
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
order by nivel;
--RECUPERA LA JERARQUIA EN UN PUNTO DE VENTA DADO  UN VENDEDOR
333
SELECT a.PC_CVE_VENDEDOR,
	   b.PC_CVE_PTOVENTAS,
	   b.PC_NOM_PTOVENTAS,
	   b.PC_CVE_CANAL,
	   b.PC_CVE_REGION,
	   b.PC_CVE_REFERENCIA,
	   b.PC_DESC_CANAL,
	   b.PC_CVE_TP_CANAL,
	   b.PC_DESC_TP_CANAL,
	   b.PC_DESC_REGION
FROM
(	SELECT LEVEL AS NIVEL, ROWNUM AS REGISTRO, PC_VENDEDORES.PC_CVE_VENDEDOR
	FROM   PC_VENDEDORES,PC_VENDEDORES_HIS 	
	WHERE  PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES_HIS.PC_CVE_VENDEDOR
	AND    PC_VENDEDORES_HIS.PC_FCH_FIN IS NULL
    AND    PC_VENDEDORES_HIS.PC_FCH_INICIO <= TO_DATE({1})
	START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {0}
	CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) a,
(
 	SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR,
		   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
		   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
		   PC_PUNTO_VENTAS.PC_CVE_CANAL,
		   PC_PUNTO_VENTAS.PC_CVE_REGION,
		   PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
		   PC_CANAL.PC_DESC_CANAL,
		   PC_CANAL.PC_CVE_TP_CANAL,
		   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
		   PC_REGION.PC_DESC_REGION
	FROM   PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL,pc_vendedores_his
	WHERE  PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
	AND    PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
	AND    PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
	AND    PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
	and    pc_vendedores_his.PC_CVE_VENDEDOR = pc_inter_vendedores_ptoventas.PC_CVE_VENDEDOR(+) ) b
	WHERE  a.PC_CVE_VENDEDOR = b.PC_CVE_VENDEDOR(+)
ORDER BY  PC_CVE_VENDEDOR;
---QUERY PARA SABER SI EL PUNTO DE VENTA EXISTE EN PVS
334
SELECT CDG_CSI PC_CVE_PTOVENTAS FROM CAT_CSI
WHERE CDG_CSI = ''{0}'';
---QUERY PARA CAMBIAR DE DIVISION A UN VENDEDOR
335
UPDATE PC_VENDEDORES SET
PC_CVE_SUPERIOR = ''{1}'',
PC_CVE_SUBDIV = ''{1}''
WHERE PC_CVE_VENDEDOR = ''{0}'';
--Query para TRAER PUNTOS DE VENTA POR NUMERO ECONOMICO ADMINISTRADOR
336
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUNTO_VENTAS.PC_DIRECCION PC_DIRECCION,
	   PC_PUNTO_VENTAS.PC_COLONIA PC_COLONIA,
	   PC_PUNTO_VENTAS.PC_CP PC_CP,
	   PC_PUNTO_VENTAS.PC_TEL PC_TEL,
	   PC_PUNTO_VENTAS.PC_FAX PC_FAX,
       PC_PUNTO_VENTAS.PC_CIUDAD PC_CIUDAD,
	   PC_PUNTO_VENTAS.PC_ESTADO PC_ESTADO,
	   PC_PUNTO_VENTAS.PC_STATUS PC_STATUS,
	   PC_PUNTO_VENTAS.PC_DIG_VERIF PC_DIG_VERIF,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_DIVISION.PC_DESC_DIV PC_DESC_DIV,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_REGION , PC_TIPO_CANAL , PC_CANAL, PC_DIVISION, PC_SUBDIVISION
WHERE ( (PC_REGION.PC_CVE_REGION(+) = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_DIVISION.PC_CVE_DIV = PC_PUNTO_VENTAS.PC_CVE_DIV)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_PUNTO_VENTAS.PC_CVE_REFERENCIA = ''{0}''));
--Query para TRAER PUNTOS DE VENTA POR NUMERO ECONOMICO DIVISIONAL
337
SELECT PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS PC_CVE_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CVE_REFERENCIA PC_CVE_REFERENCIA,
       PC_PUNTO_VENTAS.PC_CVE_CANAL PC_CVE_CANAL,
       PC_PUNTO_VENTAS.PC_CVE_REGION PC_CVE_REGION,
       PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS PC_NOM_PTOVENTAS,
       PC_PUNTO_VENTAS.PC_CNTL_INT PC_CNTL_INT,
       PC_PUNTO_VENTAS.PC_CVE_SUBDIV PC_CVE_SUBDIV,
       PC_PUNTO_VENTAS.PC_CVE_DIV PC_CVE_DIV,
       PC_PUNTO_VENTAS.PC_CIUDAD PC_CIUDAD,
	   PC_PUNTO_VENTAS.PC_ESTADO PC_ESTADO,
	   PC_PUNTO_VENTAS.PC_STATUS PC_STATUS,
	   PC_PUNTO_VENTAS.PC_DIG_VERIF PC_DIG_VERIF,
       PC_REGION.PC_DESC_REGION PC_DESC_REGION,
       PC_CANAL.PC_DESC_CANAL PC_DESC_CANAL,
       PC_CANAL.PC_CVE_TP_CANAL PC_CVE_TP_CANAL,
       PC_TIPO_CANAL.PC_DESC_TP_CANAL PC_DESC_TP_CANAL,
       PC_SUBDIVISION.PC_DESC_SUBDIV PC_DESC_SUBDIV
FROM PC_PUNTO_VENTAS , PC_REGION , PC_TIPO_CANAL , PC_CANAL, PC_SUBDIVISION
WHERE ( (PC_REGION.PC_CVE_REGION(+) = PC_PUNTO_VENTAS.PC_CVE_REGION)
AND (PC_SUBDIVISION.PC_CVE_SUBDIV = PC_PUNTO_VENTAS.PC_CVE_SUBDIV)
AND (PC_TIPO_CANAL.PC_CVE_TP_CANAL = PC_CANAL.PC_CVE_TP_CANAL)
AND (PC_CANAL.PC_CVE_CANAL = PC_PUNTO_VENTAS.PC_CVE_CANAL)
AND (PC_PUNTO_VENTAS.PC_CVE_REFERENCIA = ''{0}'')
AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {1})
AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {2}));-- OR PC_PUNTO_VENTAS.PC_CVE_REFERENCIA = ''{0}''
--QUERY PARA TRAERME LOS SUBORDINADOS DE UN JEFE DE TIENDA
338
SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO,PC_PUESTOS.PC_DESC_PUESTO
FROM PC_PUESTOS_NIVEL, PC_PUESTOS
WHERE PC_PUESTOS_NIVEL.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
AND PC_PUESTOS.PC_CVE_PUESTO <> 2
START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = 2
CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO = PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP
ORDER BY 1;
--QUERY PARA TRAERME EL JEFE DE TIENDA EN CASO DE EXISTIR
339
SELECT a.PC_CVE_PTOVENTAS, a.PC_NOM_PTOVENTAS, c.PC_NOM_VENDEDOR || '' '' || c.PC_APE_PATERNO
	   || '' '' || c.PC_APE_MATERNO PC_NOMBRE_VENDEDOR, d.PC_DESC_PUESTO,
	   c.PC_CVE_VENDEDOR
FROM PC_PUNTO_VENTAS a, PC_INTER_VENDEDORES_PTOVENTAS b, PC_VENDEDORES c, PC_PUESTOS d
WHERE a.PC_CVE_PTOVENTAS = b.PC_CVE_PTOVENTAS
and b.PC_CVE_VENDEDOR = c.PC_CVE_VENDEDOR
and c.PC_CVE_PUESTO = d.PC_CVE_PUESTO
and d.PC_CVE_PUESTO = 2
AND (NVL(b.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (NVL(c.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (NVL(a.PC_STATUS,''ALTA'') <> ''BAJA'')
and a.pc_cve_ptoventas = ''{0}'';
--QUERY PARA TRAERME TODAS LAS TIENDAS QUE TIENEN VENDEDORES
341
select DISTINCT pc_punto_ventas.PC_CVE_PTOVENTAS, PC_CVE_REFERENCIA, pc_punto_ventas.PC_CVE_CANAL, PC_CVE_REGION,
			    PC_NOM_PTOVENTAS, PC_CNTL_INT, PC_CIUDAD, PC_ESTADO, PC_CP, PC_TEL, PC_FAX,
			    PC_DIRECCION, PC_COLONIA, PC_CVE_DIV, PC_CVE_SUBDIV, PC_DIG_VERIF, PC_PUNTO_VENTAS.PC_STATUS
			    ,PC_CANAL.PC_DESC_CANAL, PC_TIPO_CANAL.PC_DESC_TP_CANAL
FROM PC_PUNTO_VENTAS, PC_INTER_VENDEDORES_PTOVENTAS, PC_CANAL, PC_TIPO_CANAL
where (NVL(PC_PUNTO_VENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
AND (PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS)
and (PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL)
and (PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL)
AND (NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
<%0!=null AND (PC_PUNTO_VENTAS.PC_CVE_DIV = {0}) 0!=null%>
<%1!=null AND (PC_PUNTO_VENTAS.PC_CVE_SUBDIV = {1}) 1!=null%>
<%2!=null AND ( PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR = {2}) 2!=null%>
ORDER BY PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS;
-- Query para generar reporte Punto de Venta
342
SELECT a.PC_CVE_VENDEDOR,
	   b.PC_CVE_PTOVENTAS,
	   b.PC_NOM_PTOVENTAS,
	   b.PC_CVE_CANAL,
	   b.PC_CVE_REGION,
	   b.PC_CVE_REFERENCIA,
	   b.PC_DESC_CANAL,
	   b.PC_CVE_TP_CANAL,
	   b.PC_DESC_TP_CANAL,
	   b.PC_DESC_REGION
FROM
(
SELECT LEVEL AS NIVEL, ROWNUM AS REGISTRO, PC_VENDEDORES.PC_CVE_VENDEDOR
FROM PC_VENDEDORES
WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR) a,
(
SELECT PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR,
	   PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_NOM_PTOVENTAS,
	   PC_PUNTO_VENTAS.PC_CVE_CANAL,
	   PC_PUNTO_VENTAS.PC_CVE_REGION,
	   PC_PUNTO_VENTAS.PC_CVE_REFERENCIA,
	   PC_CANAL.PC_DESC_CANAL,
	   PC_CANAL.PC_CVE_TP_CANAL,
	   PC_TIPO_CANAL.PC_DESC_TP_CANAL,
	   PC_REGION.PC_DESC_REGION
FROM PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS, PC_CANAL, PC_REGION, PC_TIPO_CANAL
WHERE PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS(+)
AND PC_PUNTO_VENTAS.PC_CVE_CANAL = PC_CANAL.PC_CVE_CANAL(+)
AND PC_PUNTO_VENTAS.PC_CVE_REGION = PC_REGION.PC_CVE_REGION(+)
AND (NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA'')
AND PC_CANAL.PC_CVE_TP_CANAL = PC_TIPO_CANAL.PC_CVE_TP_CANAL(+)
) b
WHERE a.PC_CVE_VENDEDOR = b.PC_CVE_VENDEDOR(+)
ORDER BY b.PC_CVE_VENDEDOR;
--Query para traerme los datos del Punto de Venta que existe en PVS
343
SELECT CDG_CSI	PC_CVE_PTOVENTAS, CDG_REGION PC_CVE_REGION, DESC_CSI PC_NOM_PTOVENTAS,
				CIUDAD_CSI PC_CIUDAD, ESTADO_CSI PC_ESTADO, CP_CSI PC_CP, TELEFONO_CSI PC_TEL,
				FAX_CSI	PC_FAX, CALLE_CSI PC_DIRECCION, COLONIA_CSI	PC_COLONIA
FROM CAT_CSI
WHERE CDG_CSI = ''{0}'';
--QUERY PARA TRAERME UN PUESTO QUE PUEDE SER REPETIDO EN UNA TIENDA
344
SELECT PC_CVE_PUESTO
FROM PC_VENDEDORES, PC_INTER_VENDEDORES_PTOVENTAS, PC_PUNTO_VENTAS
WHERE PC_VENDEDORES.PC_CVE_VENDEDOR = PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_VENDEDOR
AND PC_INTER_VENDEDORES_PTOVENTAS.PC_CVE_PTOVENTAS = PC_PUNTO_VENTAS.PC_CVE_PTOVENTAS
AND ((NVL(PC_INTER_VENDEDORES_PTOVENTAS.PC_STATUS,''ALTA'') <> ''BAJA''))
AND (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
AND PC_VENDEDORES.PC_CVE_VENDEDOR =  {0}
AND PC_CVE_PUESTO IN (
	SELECT DISTINCT PC_PUESTOS_NIVEL.PC_CVE_PUESTO
	FROM PC_PUESTOS_NIVEL, PC_PUESTOS
	WHERE PC_PUESTOS_NIVEL.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	AND PC_PUESTOS.PC_CVE_PUESTO <> 28
	and PC_PUESTOS.PC_CVE_PUESTO <> 52
	START WITH PC_PUESTOS_NIVEL.PC_CVE_PUESTO = 2
	CONNECT BY PRIOR PC_PUESTOS_NIVEL.PC_CVE_PUESTO = PC_PUESTOS_NIVEL.PC_CVE_PUESTO_SUP);
---------Query para traerme vendedores ordenados por nivel, pc_cve_superior, pc_cve_puesto
345
SELECT LEVEL NIVEL, PC_VENDEDORES.PC_CVE_VENDEDOR,
       PC_VENDEDORES.PC_APE_PATERNO || '' '' ||
	   PC_VENDEDORES.PC_APE_MATERNO || '' '' ||
	   PC_VENDEDORES.PC_NOM_VENDEDOR PC_NOMBRE_VENDEDOR,
	   PC_VENDEDORES.PC_FCH_ALTA,
	   PC_VENDEDORES.PC_FCH_BAJA,
	   PC_VENDEDORES.PC_DIG_VERIF,
	   PC_VENDEDORES.PC_CIUDAD,
	   PC_VENDEDORES.PC_ESTADO,		
	   PC_VENDEDORES.PC_DIRECCION,	
	   PC_VENDEDORES.PC_COLONIA,		
	   PC_VENDEDORES.PC_CP,		
	   PC_VENDEDORES.PC_TEL,		
	   PC_VENDEDORES.PC_FAX,	
       PC_VENDEDORES.PC_CVE_SUBDIV,
	   PC_VENDEDORES.PC_CVE_PUESTO,
	   PC_VENDEDORES.PC_CVE_EMP_REF,
	   (SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS
	    WHERE PC_VENDEDORES.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO) PC_DESC_PUESTO,
   	   PC_VENDEDORES.PC_CVE_SUPERIOR,
       (SELECT superior.PC_APE_PATERNO || '' '' ||
	           superior.PC_APE_MATERNO  || '' '' ||
	           superior.PC_NOM_VENDEDOR
	    FROM PC_VENDEDORES superior
	    WHERE superior.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_NOMBRE_SUPERIOR,
		(SELECT PC_PUESTOS.PC_DESC_PUESTO
	    FROM PC_PUESTOS,PC_VENDEDORES sup_puesto
	    WHERE sup_puesto.PC_CVE_PUESTO = PC_PUESTOS.PC_CVE_PUESTO
	    AND sup_puesto.PC_CVE_VENDEDOR= PC_VENDEDORES.PC_CVE_SUPERIOR) PC_DESC_PUESTO_SUP,
	    (SELECT PC_DESC_DIV FROM PC_DIVISION WHERE PC_CVE_DIV = {0}) PC_DESC_DIV
FROM PC_VENDEDORES
WHERE (NVL(PC_VENDEDORES.PC_STATUS,''ALTA'') <> ''BAJA'')
START WITH PC_VENDEDORES.PC_CVE_VENDEDOR = {1}
CONNECT BY PRIOR PC_VENDEDORES.PC_CVE_VENDEDOR = PC_VENDEDORES.PC_CVE_SUPERIOR
order by nivel, pc_vendedores.pc_cve_superior, pc_vendedores.pc_cve_puesto;
---query para modificar el rol de un usuario
346
UPDATE CATVEN.PC_ROLES_DIV SET PC_CVE_ROL={2}, PC_CVE_DIV={3}, PC_CVE_SUBDIV={3}  WHERE PC_ROLES_DIV.PC_CVE_ROL_DIV = {0};
---QUERY PARA TRAERME LOS ROLES DEL USUARIO SIN IMPORTAR SI ESTAN BLOQUEDOS O NO
347
SELECT DISTINCT PC_LOGIN.PC_USERID,
       PC_LOGIN.PC_NOMBRE_CUENTA,
 	   PC_ROLES_DIV.PC_CVE_ROL,
 	   PC_LOGIN.PC_CVE_USUARIO
FROM CATVEN.PC_LOGIN , CATVEN.PC_ROLES_DIV
WHERE ( (CATVEN.PC_LOGIN.PC_USERID = PC_ROLES_DIV.PC_USERID)
AND (PC_LOGIN.PC_USERID = ''{0}''));
---QUERY PARA TRAERME LOS ROLES DEL USUARIO SIN IMPORTAR SI ESTAN BLOQUEDOS O NO
349
INSERT INTO PC_BIT_USUARIO(PC_USERID, PC_FCH_TRANSACCION, PC_TRANSACCION)
VALUES(''{0}'',SYSDATE,''{1}'');

351
select max(PC_FCH_acceso)as fecha from CATVEN.PC_LOG_ACCESO
where PC_USERID = ''{0}'';


352
Update CATVEN.PC_LOGIN set PC_ISBLOCKED = '1'  where PC_USERID = ''{0}'';



353
select count(*)as clave from CATVEN.PC_LOGIN where pc_cambia_password = '1' and PC_USERID = ''{0}'';


354
UPDATE CATVEN.PC_LOGIN set PC_PASSWORD = ''{1}'' where PC_USERID = ''{0}'';


355
UPDATE CATVEN.PC_LOGIN set PC_CAMBIA_PASSWORD = '0' where PC_USERID = ''{0}'';

356
select count(*)as clave from CATVEN.PC_LOGIN where PC_ISBLOCKED = '1' and PC_USERID = ''{0}'';

357
SELECT count(*) as clave FROM CATVEN.PC_LOGIN WHERE (TRUNC(PC_EXPIRATIONDATE)) <=TRUNC(SYSDATE) and  PC_USERID = ''{0}'';
